<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Project 4 of Statistics.md"><meta name="keywords" content="r,statistic"><meta name="author" content="Monad Kai,undefined"><meta name="copyright" content="Monad Kai"><title>Project 4 of Statistics.md | Code@浮生记</title><link rel="shortcut icon" href="https://avatars1.githubusercontent.com/u/168751?v=3&s=140"><link rel="stylesheet" href="../../../../css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.3"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  localSearch: undefined
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Homework-6"><span class="toc-number">1.</span> <span class="toc-text">Homework 6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-number">1.1.</span> <span class="toc-text">1.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2"><span class="toc-number">1.2.</span> <span class="toc-text">2.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3"><span class="toc-number">1.3.</span> <span class="toc-text">3.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Project"><span class="toc-number">1.4.</span> <span class="toc-text">4. Project</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#One-way-ANCOVA"><span class="toc-number">1.4.1.</span> <span class="toc-text">One-way ANCOVA</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Assessing-test-assumptions"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">Assessing test assumptions</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Visualizing-the-results"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">Visualizing the results</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Two-way-factorial-ANOVA"><span class="toc-number">1.4.2.</span> <span class="toc-text">Two-way factorial ANOVA</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="http://oxyywddt8.bkt.clouddn.com/portrait/portrait.jpg"></div><div class="author-info__name text-center">Monad Kai</div><div class="author-info__description text-center">Life is beautiful!</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="../../../../archives"><span class="pull-left">文章</span><span class="pull-right">86</span></a><a class="author-info-articles__tags article-meta" href="../../../../tags"><span class="pull-left">标签</span><span class="pull-right">21</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" href="https://Lstyle1.github.io" target="_blank">Lyn</a><a class="author-info-links__name text-center" href="http://onlookerliu.leanote.com" target="_blank">另外一个关于数学的博客</a><a class="author-info-links__name text-center" href="http://jamesmwh.cn/" target="_blank">James MWH的博客</a><a class="author-info-links__name text-center" href="https://www.liaoxuefeng.com" target="_blank">廖雪峰的网站</a><a class="author-info-links__name text-center" href="http://www.ruanyifeng.com" target="_blank">阮一峰的网络日志</a><a class="author-info-links__name text-center" href="https://www.open-open.com" target="_blank">深度开源</a><a class="author-info-links__name text-center" href="https://www.nowcoder.com" target="_blank">牛客网</a><a class="author-info-links__name text-center" href="https://leetcode.com" target="_blank">LeetCode</a><a class="author-info-links__name text-center" href="http://www.learnyouahaskell.com" target="_blank">Haskell</a><a class="author-info-links__name text-center" href="https://www.kaggle.com/learn/overview" target="_blank">Kaggle</a><a class="author-info-links__name text-center" href="https://developers.google.cn/machine-learning/crash-course/framing/video-lecture" target="_blank">Google的AI课程</a><a class="author-info-links__name text-center" href="https://projecteuler.net/" target="_blank">Project Euler</a><a class="author-info-links__name text-center" href="https://beta.observablehq.com/" target="_blank">Observable Notebook</a><a class="author-info-links__name text-center" href="https://www.juliabox.com" target="_blank">JuliaBox</a><a class="author-info-links__name text-center" href="http://community.schemewiki.org/?scip-solutions" target="_blank">SICP Solutions</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://user-images.githubusercontent.com/12621342/37325500-23e8f77c-26c9-11e8-8e24-eb4346f1fff5.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Code@浮生记</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/gallery">Gallery</a></span></div><div id="post-info"><div id="post-title">Project 4 of Statistics.md</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2017-12-15</time><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">2,544</span><span class="post-meta__separator">|</span><span>阅读时长: 16 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div id="post-content"><h2 id="Homework-6"><a href="#Homework-6" class="headerlink" title="Homework 6"></a>Homework 6</h2><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><blockquote>
<p>Prove that $\hat \sigma^2 = \dfrac{SS_E}{(a-1)(b-1)}$ is the unbiased estimation of $\sigma^2$</p>
</blockquote>
<a id="more"></a>
<p>What we learned is that</p>
<p>$$<br>\begin{align<em>}<br>SS<em>T &amp;= \sum</em>{i=1}^a \sum<em>{j=1}^b (y</em>{ij} - \bar y)^2 \<br>&amp;= \sum<em>{i=1}^a \sum</em>{j=1}^b (y<em>{ij} - \bar y</em>{i\cdot} - \bar y<em>{\cdot j} + \bar y + \bar y</em>{i\cdot} - \bar y + \bar y<em>{j\cdot} - \bar y)^2 \<br>&amp;= \underbrace{\sum</em>{i=1}^a \sum<em>{j=1}^b (y</em>{ij} - \bar y<em>{i\cdot} - \bar y</em>{\cdot j} + \bar y)^2}_{SS<em>E} + \underbrace{\sum</em>{i=1}^a b(\bar y<em>{i\cdot} - \bar y)^2}</em>{SS<em>A} + \underbrace{\sum</em>{j=1}^b a(\bar y<em>{\cdot j} - \bar y)^2}</em>{SS_B} \<br>\end{align</em>}<br>$$</p>
<p>For clarity, we give the corresponding matrix form:</p>
<p>$$<br>\begin{align<em>}<br>SS<em>T &amp;= y’(I</em>{ab} - \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)y \<br>&amp;= y’\Big( (I<em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) + (A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) + (B-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) \Big)y \<br>&amp;= \underbrace{y’(I</em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)y}_{SS<em>E} + \underbrace{ y’(A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’)y }</em>{SS<em>A} + \underbrace{ (B-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) }</em>{SS_B}<br>\end{align</em>}<br>$$</p>
<p>where</p>
<p>$$<br>\begin{align<em>}<br>&amp;A = \underbrace{\frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’ \oplus \cdots \oplus \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}<em>b’}</em>{a \text{ items}} = (I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’) \<br>&amp;B = \underbrace{\frac{1}{b}\boldsymbol{1}_a\boldsymbol{1}_a’ \oplus \cdots \oplus \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}<em>a’}</em>{b \text{ items}} = (I_b \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’)<br>\end{align</em>}<br>$$</p>
<p>By property of tensor product, we declare that<br>$A$ and $B$ are symmetric and idempotent.</p>
<p>$$<br>\begin{align<em>}<br>A^2 &amp;= (I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’) \cdot (I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’) = (I_a\cdot I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’ \cdot \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’) \<br>&amp;= I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’ = A \<br>B^2 &amp;= (I_b \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’) \cdot (I_a \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’) = (I_b\cdot I_b \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’ \cdot \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’) \<br>&amp;= I_b \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’ = B \<br>\end{align</em>}<br>$$</p>
<p>Hence, we claim that $I<em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’$, $A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’$ and $B-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}_{ab}’$ are symmetric and idempotent, with their rank equal to trace:</p>
<p>$$<br>\begin{align<em>}<br>&amp;\mathrm{rank}(I<em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) = (a-1)(b-1) \<br>&amp;\mathrm{rank}(A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) = a-1 \<br>&amp;\mathrm{rank}(B-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}_{ab}’) = b-1<br>\end{align</em>}<br>$$</p>
<p>Thus, under the normal hypothesis $Y \sim N(0, \sigma^2 I)$, we have</p>
<p>$$<br>\begin{align<em>}<br>&amp;\frac{Y’(I<em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’)Y}{\sigma^2} \sim \chi^2\Big((a-1)(b-1)\Big) \<br>&amp;\frac{Y’(A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’)Y}{\sigma^2} \sim \chi^2(a-1) \quad \frac{Y’(B-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}_{ab}’)Y}{\sigma^2} \sim \chi^2(b-1)<br>\end{align</em>}<br>$$</p>
<p>Now, it is sufficient to say $\dfrac{SS_E}{(a-1)(b-1)}$ is the unbiased estimation of $\sigma^2$.</p>
<h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><blockquote>
<p>Prove that both of $SS_A$ and $SS_B$ are independent with $SS_E$</p>
</blockquote>
<p>Note that $\boldsymbol{1}_{ab} = I_a \otimes \boldsymbol{1}_b\boldsymbol{1}_b’ = I_b \otimes \boldsymbol{1}_a\boldsymbol{1}_a’$, it is easy to find that</p>
<p>$$<br>\begin{align<em>}<br>&amp;A\cdot \boldsymbol{1}_{ab} = (I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’) \cdot I_a \otimes \boldsymbol{1}_b\boldsymbol{1}_b’ = I_a \otimes \boldsymbol{1}_b\boldsymbol{1}<em>b’ = \boldsymbol{1}</em>{ab} \<br>&amp;B\cdot \boldsymbol{1}_{ab} = (I_b \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’) \cdot I_b \otimes \boldsymbol{1}_a\boldsymbol{1}_a’ = I_b \otimes \boldsymbol{1}_a\boldsymbol{1}<em>a’ = \boldsymbol{1}</em>{ab}<br>\end{align</em>}<br>$$</p>
<p>Now, based on the derivation of question <a href="###1.">1</a>, it suffices to show that</p>
<p>$$<br>\begin{align<em>}<br>&amp; (I<em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) (A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) = 0 \<br>&amp; (I</em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’) (B-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’) = 0<br>\end{align</em>}<br>$$</p>
<p>By symmetry, we only give the derivation of the first equation, the second is similar to this work.</p>
<p>$$<br>\begin{align<em>}<br>&amp; (I<em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) (A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) \<br>&amp;= [I</em>{ab}-B-(A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)] (A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’) \<br>&amp;= (I-B)(A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’) - (A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)^2 \<br>&amp;= A - BA - \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ + \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ - (A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)^2 \<br>&amp;= A - BA - (A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’) \<br>&amp;= \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ - BA \<br>&amp;= \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ - (I_b \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’)(I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}<em>b’)\<br>&amp;= \frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}_{ab}’ - \frac{1}{ab} (I_b\boldsymbol{1}_b\boldsymbol{1}_b’ \otimes I_a\boldsymbol{1}_a\boldsymbol{1}<em>a’ ) \<br>&amp;= \frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}_{ab}’ - \frac{1}{ab} (\boldsymbol{1}_b\boldsymbol{1}_b’ \otimes \boldsymbol{1}_a\boldsymbol{1}<em>a’ ) \<br>&amp;= \frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’ - \frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}_{ab}’ \<br>&amp;= 0<br>\end{align</em>}<br>$$</p>
<p>The detailed matrix $A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’$ is idempotent since</p>
<p>$$<br>\begin{align<em>}<br>(A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)^2 &amp;= (A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)(A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’) \<br>&amp;= A^2 - \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’A - \frac{1}{ab}A\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ + \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ \<br>&amp;= A^2 - \frac{2}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ + \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ \<br>&amp;= A - \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’<br>\end{align</em>}<br>$$</p>
<p>Hence the independency is proved, which furthermore indicates the fact that under the hypothesis $H_1$</p>
<p>$$<br>F_A = \frac{SS_A/(a-1)}{SS<em>E/(a-1)(b-1)} \sim F</em>{a-1, (a-1)(b-1)}<br>$$</p>
<p>Similarly, under the hypothesis $H_2$</p>
<p>$$<br>F_B = \frac{SS_B/(b-1)}{SS<em>E/(a-1)(b-1)} \sim F</em>{b-1, (a-1)(b-1)}<br>$$</p>
<h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><blockquote>
<p>Prove that $c’\beta$ is an estimable function $ \iff\, c \in \mathcal{M}(X’)$</p>
</blockquote>
<p>$c’\beta$ is said to be <em>estimable</em> if and only if there is a linear function of $y$, such that $a’y$ is an unbiased estimator of $c’\beta$ (for arbitrary $\beta$ ), i.e.</p>
<p>$$<br>\begin{align<em>}<br>E(a’y) = c’\beta \quad \forall \beta\in\mathbb{R}^p &amp;\iff a’X\beta = c’\beta \quad \forall \beta\in\mathbb{R}^p \<br>&amp;\iff a’X = c \<br>&amp;\iff c = X’a \in \mathcal{M}(X’)<br>\end{align</em>}<br>$$</p>
<h3 id="4-Project"><a href="#4-Project" class="headerlink" title="4. Project"></a>4. Project</h3><h4 id="One-way-ANCOVA"><a href="#One-way-ANCOVA" class="headerlink" title="One-way ANCOVA"></a>One-way ANCOVA</h4><p>This example comes from the <em>litter</em> dataset in the multcomp package. Pregnant mice were divided into four treatment groups; each group received a different dose of a drug (0, 5, 50, or 500). The mean post-birth weight for each litter was the dependent variable and gestation time was included as a <strong>covariate</strong>.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data(litter, package=<span class="string">"multcomp"</span>)</span><br><span class="line"><span class="keyword">attach</span>(litter)</span><br><span class="line">table(dose)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dose</span><br><span class="line">  <span class="number">0</span>   <span class="number">5</span>  <span class="number">50</span> <span class="number">500</span></span><br><span class="line"> <span class="number">20</span>  <span class="number">19</span>  <span class="number">18</span>  <span class="number">17</span></span><br></pre></td></tr></table></figure>
<p>From the <code>table()</code> function we can see that there are an unequal number of litters at each dosage level.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aggregate(weight, by=list(dose), FUN=mean)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  Group.1        x</span><br><span class="line"><span class="number">1</span>       <span class="number">0</span> <span class="number">32.30850</span></span><br><span class="line"><span class="number">2</span>       <span class="number">5</span> <span class="number">29.30842</span></span><br><span class="line"><span class="number">3</span>      <span class="number">50</span> <span class="number">29.86611</span></span><br><span class="line"><span class="number">4</span>     <span class="number">500</span> <span class="number">29.64647</span></span><br></pre></td></tr></table></figure>
<p>Based on the group means provided by the <code>aggregate()</code> function, the <em>no-drug</em> group had the highest mean litter weight.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit &lt;- aov(weight ~ gesttime + dose)</span><br><span class="line">summary(fit)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Df Sum Sq Mean Sq <span class="literal">F</span> value  Pr(&gt;<span class="literal">F</span>)</span><br><span class="line">gesttime     <span class="number">1</span>  <span class="number">134.3</span>  <span class="number">134.30</span>   <span class="number">8.049</span> <span class="number">0.00597</span> **</span><br><span class="line">dose         <span class="number">3</span>  <span class="number">137.1</span>   <span class="number">45.71</span>   <span class="number">2.739</span> <span class="number">0.04988</span> *</span><br><span class="line">Residuals   <span class="number">69</span> <span class="number">1151.3</span>   <span class="number">16.69</span></span><br><span class="line">---</span><br><span class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>The ANCOVA F tests indicate that</p>
<ol>
<li>gestation time was related to birth weight</li>
<li>drug dosage was related to birth weight after controlling for gestation time.</li>
</ol>
<p>Furthermore, the <code>effects</code> package provides a powerful method of obtaining the adjusted means.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(effects)</span><br><span class="line">effect(<span class="string">"dose"</span>, fit)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> dose effect</span><br><span class="line">dose</span><br><span class="line">       <span class="number">0</span>        <span class="number">5</span>       <span class="number">50</span>      <span class="number">500</span></span><br><span class="line"><span class="number">32.35367</span> <span class="number">28.87672</span> <span class="number">30.56614</span> <span class="number">29.33460</span></span><br></pre></td></tr></table></figure>
<p>But in this case, the adjusted means are similar to unadjusted one produced by the <code>aggregate()</code> function.</p>
<p>Now, suppose we are interested in whether the no-drug condition differs from the three-drug condition. We can use the multcomp package to test specific defined hypothesis about the means.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(multcomp)</span><br><span class="line">contrast &lt;- rbind(<span class="string">"no drug vs. drug"</span> = c(<span class="number">3</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>))</span><br><span class="line">summary(glht(fit, linfct=mcp(dose=contrast)))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">	 Simultaneous Tests <span class="keyword">for</span> General Linear hypothesis</span><br><span class="line"></span><br><span class="line">Multiple Comparisons of Means: User-defined Contrasts</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Fit: aov(formula = weight ~ gesttime + dose)</span><br><span class="line"></span><br><span class="line">Linear hypothesis:</span><br><span class="line">                      Estimate Std. Error t value Pr(&gt;|t|)</span><br><span class="line">no drug vs. drug == <span class="number">0</span>    <span class="number">8.284</span>      <span class="number">3.209</span>   <span class="number">2.581</span>    <span class="number">0.012</span> *</span><br><span class="line">---</span><br><span class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line">(Adjusted p values reported -- single-step method)</span><br></pre></td></tr></table></figure>
<p>The contrast <code>c(3, -1, -1, -1)</code> specifies a comparison of the first group with the average of the other three. The hypothesis is tested with a t-statistics, which is significant at the $p&lt;0.05$ level.</p>
<p>Therefore, we can conclude that the no-drug group has a higher birth weight than drug conditions.</p>
<h5 id="Assessing-test-assumptions"><a href="#Assessing-test-assumptions" class="headerlink" title="Assessing test assumptions"></a>Assessing test assumptions</h5><p>In this case, it is assumed that the regression slope for predicting birth weight from gestation time is the same in each of four treatment groups. A test for the homogeneity of regression slopes can be obtained by including a <code>gestation*dose</code> interaction term in ANCOVA model.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit2 &lt;- aov(weight ~ gesttime*dose, data=litter)</span><br><span class="line">summary(fit2)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">              Df Sum Sq Mean Sq <span class="literal">F</span> value  Pr(&gt;<span class="literal">F</span>)</span><br><span class="line">gesttime       <span class="number">1</span>  <span class="number">134.3</span>  <span class="number">134.30</span>   <span class="number">8.289</span> <span class="number">0.00537</span> **</span><br><span class="line">dose           <span class="number">3</span>  <span class="number">137.1</span>   <span class="number">45.71</span>   <span class="number">2.821</span> <span class="number">0.04556</span> *</span><br><span class="line">gesttime:dose  <span class="number">3</span>   <span class="number">81.9</span>   <span class="number">27.29</span>   <span class="number">1.684</span> <span class="number">0.17889</span></span><br><span class="line">Residuals     <span class="number">66</span> <span class="number">1069.4</span>   <span class="number">16.20</span></span><br><span class="line">---</span><br><span class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>The interaction is nonsignificant, supporting the assumption of equality of slopes. That’s to say, the relationship between gestation and birth weight does not depend on the level of dose variable.</p>
<h5 id="Visualizing-the-results"><a href="#Visualizing-the-results" class="headerlink" title="Visualizing the results"></a>Visualizing the results</h5><p>The <code>ancova()</code> function in the <code>HH</code> package provides a plot of the relationship between the dependent variable, the covariate, and the factor.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(HH)</span><br><span class="line">ancova(weight ~ gesttime + dose, data=litter)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistics/project4/one-way.svg" width="400" height="300"><br></div>

<p>Here we can see that the regression lines for predicting birth weight from gestation time are parallel in each group but have differetn intercepts. As gestation time increases, birth weight increases. Additionally, we can see that 0-dose group has the largest intercept and the 5-dose group has the lowest intercept.</p>
<p>Now we use the statement <code>ancova(weight ~ gesttime*dose)</code> instead to generate a plot that allows both the slopes and intercepts to vary by group.</p>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistics/project4/one-way2.svg" width="400" height="300"><br></div>

<h4 id="Two-way-factorial-ANOVA"><a href="#Two-way-factorial-ANOVA" class="headerlink" title="Two-way factorial ANOVA"></a>Two-way factorial ANOVA</h4><p>This example uses the <code>ToothGrowth</code> dataset in the base installation to demonstrate a two-way between-groups ANOVA. 60 guinea pigs are randomly assigned to receive one of three levels of ascorbic acid ($0.5$, $1$, or $2$ mg) and one of two delivery methods (orange juice or Vitamin C), under the restriction that each treatment combination has 10 guinea pigs. The dependent variable is tooth length.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">attach</span>(ToothGrowth)</span><br><span class="line">table(supp, dose)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    dose</span><br><span class="line">supp <span class="number">0.5</span>  <span class="number">1</span>  <span class="number">2</span></span><br><span class="line">  OJ  <span class="number">10</span> <span class="number">10</span> <span class="number">10</span></span><br><span class="line">  VC  <span class="number">10</span> <span class="number">10</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>The <code>table</code> statement indicates that we have a balanced design (equal sample sizes in each cell of the design), and the next two <code>aggregate</code> statements provide the cell means and standard deviations.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aggregate(len, by=list(supp, dose), FUN=mean)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  Group.1 Group.2     x</span><br><span class="line"><span class="number">1</span>      OJ     <span class="number">0.5</span> <span class="number">13.23</span></span><br><span class="line"><span class="number">2</span>      VC     <span class="number">0.5</span>  <span class="number">7.98</span></span><br><span class="line"><span class="number">3</span>      OJ     <span class="number">1.0</span> <span class="number">22.70</span></span><br><span class="line"><span class="number">4</span>      VC     <span class="number">1.0</span> <span class="number">16.77</span></span><br><span class="line"><span class="number">5</span>      OJ     <span class="number">2.0</span> <span class="number">26.06</span></span><br><span class="line"><span class="number">6</span>      VC     <span class="number">2.0</span> <span class="number">26.14</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aggregate(len, by=list(supp, dose), FUN=sd)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  Group.1 Group.2        x</span><br><span class="line"><span class="number">1</span>      OJ     <span class="number">0.5</span> <span class="number">4.459709</span></span><br><span class="line"><span class="number">2</span>      VC     <span class="number">0.5</span> <span class="number">2.746634</span></span><br><span class="line"><span class="number">3</span>      OJ       <span class="number">1</span> <span class="number">3.910953</span></span><br><span class="line"><span class="number">4</span>      VC       <span class="number">1</span> <span class="number">2.515309</span></span><br><span class="line"><span class="number">5</span>      OJ       <span class="number">2</span> <span class="number">2.655058</span></span><br><span class="line"><span class="number">6</span>      VC       <span class="number">2</span> <span class="number">4.797731</span></span><br></pre></td></tr></table></figure>
<p>The below ANOVA table provided by the <code>summary()</code> function indicates that both main effects (<code>supp</code> and <code>dose</code>) and the interaction between these factors are significant.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dose &lt;- factor(dose)</span><br><span class="line">fit &lt;- aov(len ~ supp*dose)</span><br><span class="line">summary(fit)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">            Df Sum Sq Mean Sq <span class="literal">F</span> value   Pr(&gt;<span class="literal">F</span>)</span><br><span class="line">supp         <span class="number">1</span>  <span class="number">205.4</span>   <span class="number">205.4</span>  <span class="number">15.572</span> <span class="number">0.000231</span> ***</span><br><span class="line">dose         <span class="number">2</span> <span class="number">2426.4</span>  <span class="number">1213.2</span>  <span class="number">92.000</span>  &lt; <span class="number">2e-16</span> ***</span><br><span class="line">supp:dose    <span class="number">2</span>  <span class="number">108.3</span>    <span class="number">54.2</span>   <span class="number">4.107</span> <span class="number">0.021860</span> *</span><br><span class="line">Residuals   <span class="number">54</span>  <span class="number">712.1</span>    <span class="number">13.2</span></span><br><span class="line">---</span><br><span class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>Furthermore, we can use the <code>interaction2wt()</code> function in the <code>HH</code> package to produce a plot of both main effects and two-way interactions for any factorial design of any order.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(HH)</span><br><span class="line">interaction2wt(len ~ supp*dose)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistics/project4/two-way.svg" width="400" height="300"><br></div>

<p>The above graph indicates that tooth growth increases with the dose of ascorbic acid for both orange juice and Vitamin C. For the $0.5$ and $1$ mg doses, orange juice produced more tooth growth than Vitamin C. For $2$ mg of ascorbic acid, both delivery methods produced identical growth.</p>
<hr>
<p><em>Kai Liu, wrote on 2017/12/14</em></p>
<p><em>Student ID: 116071910015</em></p>
<p><em>Mail: liu1995@sjtu.edu.cn</em></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Monad Kai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="../../../../onlookerliu.github.io/2017/12/15/Project-4-of-Statistics/">onlookerliu.github.io/2017/12/15/Project-4-of-Statistics/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="onlookerliu.github.io" target="_blank">Code@浮生记</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="../../../../tags/r/">r</a><a class="post-meta__tags" href="../../../../tags/statistic/">statistic</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="http://oxyywddt8.bkt.clouddn.com/qrcode/ali-qrcode.jpg"><div class="post-qr-code__desc">支付宝打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="http://oxyywddt8.bkt.clouddn.com/qrcode/Wechat.jpeg"><div class="post-qr-code__desc">微信打赏</div></div></div><div class="addthis_inline_share_toolbox pull-right"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=undefined" async></script><nav id="pagination"><div class="prev-post pull-left"><a href="../../25/30-seconds-of-code/"><i class="fa fa-chevron-left">  </i><span>30 seconds of code</span></a></div><div class="next-post pull-right"><a href="../../01/Project-3-of-Statistics/"><span>Project 3 of Statistics.md</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2018 By Monad Kai</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="../../../../js/third-party/anime.min.js"></script><script src="../../../../js/third-party/jquery.min.js"></script><script src="../../../../js/third-party/jquery.fancybox.min.js"></script><script src="../../../../js/third-party/velocity.min.js"></script><script src="../../../../js/third-party/velocity.ui.min.js"></script><script src="../../../../js/utils.js?version=1.5.3"></script><script src="../../../../js/fancybox.js?version=1.5.3"></script><script src="../../../../js/sidebar.js?version=1.5.3"></script><script src="../../../../js/copy.js?version=1.5.3"></script><script src="../../../../js/fireworks.js?version=1.5.3"></script><script src="../../../../js/transition.js?version=1.5.3"></script><script src="../../../../js/scroll.js?version=1.5.3"></script><script src="../../../../js/head.js?version=1.5.3"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>