<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Project 3 of Statistics.md"><meta name="keywords" content="r,statistic"><meta name="author" content="Monad Kai,undefined"><meta name="copyright" content="Monad Kai"><title>Project 3 of Statistics.md | Code@浮生记</title><link rel="shortcut icon" href="https://avatars1.githubusercontent.com/u/168751?v=3&s=140"><link rel="stylesheet" href="../../../../css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.3"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  localSearch: undefined
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Homework-5"><span class="toc-number">1.</span> <span class="toc-text">Homework 5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-13"><span class="toc-number">1.1.</span> <span class="toc-text">13.13</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-14"><span class="toc-number">1.2.</span> <span class="toc-text">13.14</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-15"><span class="toc-number">1.3.</span> <span class="toc-text">13.15</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-16"><span class="toc-number">1.4.</span> <span class="toc-text">13.16</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bonus-Problems"><span class="toc-number">1.5.</span> <span class="toc-text">Bonus Problems</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1"><span class="toc-number">1.5.1.</span> <span class="toc-text">1.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2"><span class="toc-number">1.5.2.</span> <span class="toc-text">2.</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="http://oxyywddt8.bkt.clouddn.com/portrait/portrait.jpg"></div><div class="author-info__name text-center">Monad Kai</div><div class="author-info__description text-center">Life is beautiful!</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="../../../../archives"><span class="pull-left">文章</span><span class="pull-right">85</span></a><a class="author-info-articles__tags article-meta" href="../../../../tags"><span class="pull-left">标签</span><span class="pull-right">21</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" href="https://Lstyle1.github.io" target="_blank">Lyn</a><a class="author-info-links__name text-center" href="http://onlookerliu.leanote.com" target="_blank">另外一个关于数学的博客</a><a class="author-info-links__name text-center" href="http://jamesmwh.cn/" target="_blank">James MWH的博客</a><a class="author-info-links__name text-center" href="https://www.liaoxuefeng.com" target="_blank">廖雪峰的网站</a><a class="author-info-links__name text-center" href="http://www.ruanyifeng.com" target="_blank">阮一峰的网络日志</a><a class="author-info-links__name text-center" href="https://www.open-open.com" target="_blank">深度开源</a><a class="author-info-links__name text-center" href="https://www.nowcoder.com" target="_blank">牛客网</a><a class="author-info-links__name text-center" href="https://leetcode.com" target="_blank">LeetCode</a><a class="author-info-links__name text-center" href="http://www.learnyouahaskell.com" target="_blank">Haskell</a><a class="author-info-links__name text-center" href="https://www.kaggle.com/learn/overview" target="_blank">Kaggle</a><a class="author-info-links__name text-center" href="https://developers.google.cn/machine-learning/crash-course/framing/video-lecture" target="_blank">Google的AI课程</a><a class="author-info-links__name text-center" href="https://projecteuler.net/" target="_blank">Project Euler</a><a class="author-info-links__name text-center" href="https://beta.observablehq.com/" target="_blank">Observable Notebook</a><a class="author-info-links__name text-center" href="https://www.juliabox.com" target="_blank">JuliaBox</a><a class="author-info-links__name text-center" href="http://community.schemewiki.org/?scip-solutions" target="_blank">SICP Solutions</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://user-images.githubusercontent.com/12621342/37325500-23e8f77c-26c9-11e8-8e24-eb4346f1fff5.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Code@浮生记</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/gallery">Gallery</a></span></div><div id="post-info"><div id="post-title">Project 3 of Statistics.md</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2017-12-01</time><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">2,196</span><span class="post-meta__separator">|</span><span>阅读时长: 14 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div id="post-content"><h2 id="Homework-5"><a href="#Homework-5" class="headerlink" title="Homework 5"></a>Homework 5</h2><h3 id="13-13"><a href="#13-13" class="headerlink" title="13.13"></a>13.13</h3><p>The gamma probability density function is</p>
<p>$$<br>f(y,r,\lambda) = \frac{\lambda^r}{\Gamma(r)} e^{-\lambda y} y^{r-1}, \quad\text{for } y,\lambda\geq 0<br>$$</p>
<p>Show that the gamma is a member of the exponential family.</p>
<a id="more"></a>
<p><em>Proof:</em></p>
<p>Since</p>
<p>$$<br>\begin{align<em>}<br>f(y,r,\lambda) &amp;= \exp\lbrace r\log\lambda - \log\Gamma(\lambda) - \lambda y + (r-1)\log y \rbrace \<br>&amp;= \exp\lbrace \underbrace{(\frac{\lambda}{r} y - \log\frac{\lambda}{r})/(-\frac1r)}<em>{[\theta y - b(\theta)]/a(\phi)} + \underbrace{(r-1)\log y - \log\Gamma(r) + r\log r}</em>{h(y,\phi)} \rbrace<br>\end{align</em>}<br>$$</p>
<p>Set $\theta = \dfrac{\lambda}{r}$, $\phi = r$, we can derive that $b(\theta) = \log(\theta)$, $a(\phi) = -\dfrac1r$</p>
<p>$$<br>h(y,\phi) = (\phi-1)\log y - \log\Gamma(\phi) + \phi\log\phi<br>$$</p>
<p>Thus<br>$$<br>\begin{align<em>}<br>&amp;E(y) = \frac{\mathrm{d} b(\theta)}{\mathrm{d} b(\theta)} = \frac{1}{\theta} = \frac{r}{\lambda} \<br>&amp;\mathrm{Var}(y) = \frac{\mathrm{d}^2 b(\theta)}{\mathrm{d}\theta^2} \cdot a(\phi) = \frac{r}{\lambda^2}<br>\end{align</em>}<br>$$</p>
<h3 id="13-14"><a href="#13-14" class="headerlink" title="13.14"></a>13.14</h3><p>The exponential porbabilty density function is</p>
<p>$$<br>f(y,\lambda) = \lambda e^{-\lambda y}, \quad\text{for } y,\lambda\geq 0<br>$$</p>
<p>Show that the exponential distribution is a member of the exponential family.</p>
<p><em>Proof:</em></p>
<p>Notice the exponential distribution is a special case of gamma distribution.</p>
<p>$$<br>f(y, \lambda) = \exp(-\lambda y + \log\lambda)<br>$$</p>
<p>Set $\theta = -\lambda$, $b(\theta) = -\log\lambda = -\log(-\theta)$, with respect to $\phi = 1$, $a(\phi) = 1$ and $h(y,\phi)=0$</p>
<p>Thus, similar result can be derived</p>
<p>$$<br>\begin{align<em>}<br>&amp;E(y) = \frac{\mathrm{d}b(\theta)}{\mathrm{d}\theta} = \frac{1}{\lambda} \<br>&amp;\mathrm{Var}(y) = \frac{\mathrm{d}^2 b(\theta)}{\mathrm{d}\theta^2}\cdot1 = \frac{1}{\lambda^2}<br>\end{align</em>}<br>$$</p>
<p>which indicates the distribution to be a member of NEF.</p>
<h3 id="13-15"><a href="#13-15" class="headerlink" title="13.15"></a>13.15</h3><p>The negative binomial probabilty mass function is</p>
<p>$$<br>f(y,\pi,\alpha) = \binom{y+\alpha-1}{\alpha-1} \pi^{\alpha}(1-\pi)^y \quad\text{for } y=0,1,\ldots,\alpha&gt;0 \text{ and } 0\leq\pi\leq 1<br>$$</p>
<p>Show that the negative binomial is a memeber of the exponential family.</p>
<p><em>Proof:</em></p>
<p>$$<br>\begin{align<em>}<br>f(y,\pi,\alpha) &amp;= \binom{y+\alpha-1}{\alpha-1} \pi^{\alpha}(1-\pi)^y \<br>&amp;= \frac{\alpha}{y+\alpha} \binom{y+\alpha}{y}\pi^{\alpha}(1-\pi)^y \<br>\text{Set }n=y+\alpha\quad &amp;= (1-\frac{y}{n})\binom{n}{y}\pi^{n-y}(1-\pi)^y \<br>&amp;= \exp\Big{ (n-y)\log\pi+y\log(1-\pi)+\log (1-\frac{y}{n})\binom{n}{y} \Big} \<br>&amp;= \exp\Big{ \underbrace{\Big( \frac{y}{n}\log\frac{1-\pi}{\pi} + \log\pi \Big)}<em>{y\theta + b(\theta)}/\frac1n + \underbrace{\log (1-\frac{y}{n})\binom{n}{y}}</em>{h(y,\phi)} \Big}<br>\end{align</em>}<br>$$</p>
<p>Set<br>$$<br>\begin{align<em>}<br>&amp;\theta=\log\frac{1-\pi}{\pi} \<br>&amp;b(\theta)=-\log\pi = \log(1+e^{\theta})<br>\end{align</em>}<br>$$</p>
<p>with respect to $\phi=1$, $a(\phi)=\dfrac1n$, $h(y,\phi)=\log (1-\dfrac{y}{n})\binom{n}{y}$</p>
<p>Thus</p>
<p>$$<br>\begin{align<em>}<br>&amp;E(y) = \frac{\mathrm{d}b(\theta)}{\mathrm{d}\theta} = \frac{e^\theta}{1+e^\theta} = 1-\pi \<br>&amp;\mathrm{Var}(y) = \frac{\mathrm{d}^2 b(\theta)}{\mathrm{d}\theta^2}\cdot a(\phi) = \frac1n\cdot\frac{e^\theta}{(1+e^\theta)^2} = \frac1n\pi(1-\pi)<br>\end{align</em>}<br>$$</p>
<h3 id="13-16"><a href="#13-16" class="headerlink" title="13.16"></a>13.16</h3><p>The data in the table below are from an experiment designed to study the advance rate $y$ of a drill. The four design factors are $x_1$=load, $x_2$=flow, $x_3$=drilling speed, and $x_4$=type of drilling mud (the original experiment is described by Cuthbert Daniel in his 1976 book on industrial experimentation).</p>
<table width="400"><br>| Observation | $x_1$ | $x_2$ | $x_3$ | $x_4$ | Advance Rate, $y$ |<br>| ———– | —– | —– | —– | —– | —————– |<br>| 1           | -     | -     | -     | -     | 1.68              |<br>| 2           | +     | -     | -     | -     | 1.98              |<br>| 3           | -     | +     | -     | -     | 3.28              |<br>| 4           | +     | +     | -     | -     | 3.44              |<br>| 5           | -     | -     | +     | -     | 4.98              |<br>| 6           | +     | -     | +     | -     | 5.70              |<br>| 7           | -     | +     | +     | -     | 9.97              |<br>| 8           | +     | +     | +     | -     | 9.07              |<br>| 9           | -     | -     | -     | +     | 2.07              |<br>| 10          | +     | -     | -     | +     | 2.44              |<br>| 11          | -     | +     | -     | +     | 4.09              |<br>| 12          | +     | +     | -     | +     | 4.53              |<br>| 13          | -     | -     | +     | +     | 7.77              |<br>| 14          | +     | -     | +     | +     | 9.43              |<br>| 15          | -     | +     | +     | +     | 11.75             |<br>| 16          | +     | +     | +     | +     | 16.30             |<br></table>

<blockquote>
<p>Fit a generalized linear model to the advance rate response. Use a gamma response distribution and a log link, and include all four regressors in the linear predictor.</p>
</blockquote>
<p>First, we write all these data into a csv file named <code>drill</code> and import it into R dataframe.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.table(<span class="string">"/path/to/drill.csv"</span>, header = <span class="literal">TRUE</span>, sep = <span class="string">","</span>)</span><br></pre></td></tr></table></figure>
<p>To study the advance rate of a drill, we need to transform the columns into dichotomous factor called <code>load</code>, <code>flow</code>, <code>speed</code>, <code>type</code> with the following code.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">data$load[data$x1==<span class="string">"+"</span>] &lt;- <span class="number">1</span></span><br><span class="line">data$load[data$x1==<span class="string">"-"</span>] &lt;- <span class="number">0</span></span><br><span class="line"></span><br><span class="line">data$flow[data$x2==<span class="string">"+"</span>] &lt;- <span class="number">1</span></span><br><span class="line">data$flow[data$x2==<span class="string">"-"</span>] &lt;- <span class="number">0</span></span><br><span class="line"></span><br><span class="line">data$speed[data$x3==<span class="string">"+"</span>] &lt;- <span class="number">1</span></span><br><span class="line">data$speed[data$x3==<span class="string">"-"</span>] &lt;- <span class="number">0</span></span><br><span class="line"></span><br><span class="line">data$type[data$x4==<span class="string">"+"</span>] &lt;- <span class="number">1</span></span><br><span class="line">data$type[data$x4==<span class="string">"-"</span>] &lt;- <span class="number">0</span></span><br><span class="line"></span><br><span class="line">table(data$load)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> <span class="number">1</span></span><br><span class="line"><span class="number">8</span> <span class="number">8</span></span><br></pre></td></tr></table></figure>
<p>The dichotomous factor can now be used as the outcome variable in a regression model using gamma response distribution and a log link.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit.full &lt;- glm(y ~ load + flow + speed + type, data, family=Gamma(link = <span class="string">"log"</span>))</span><br><span class="line">summary(fit.full)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Call:</span><br><span class="line">glm(formula = y ~ load + flow + speed + type, family = Gamma(link = <span class="string">"log"</span>),</span><br><span class="line">    data = data)</span><br><span class="line"></span><br><span class="line">Deviance Residuals:</span><br><span class="line">      Min         1Q     Median         3Q        Max</span><br><span class="line">-<span class="number">0.162931</span>  -<span class="number">0.057552</span>   <span class="number">0.006942</span>   <span class="number">0.060239</span>   <span class="number">0.128465</span></span><br><span class="line"></span><br><span class="line">Coefficients:</span><br><span class="line">            Estimate Std. Error t value Pr(&gt;|t|)</span><br><span class="line">(Intercept)  <span class="number">0.50269</span>    <span class="number">0.05435</span>   <span class="number">9.250</span> <span class="number">1.60e-06</span> ***</span><br><span class="line">load         <span class="number">0.13126</span>    <span class="number">0.04861</span>   <span class="number">2.700</span>   <span class="number">0.0206</span> *</span><br><span class="line">flow         <span class="number">0.58123</span>    <span class="number">0.04861</span>  <span class="number">11.957</span> <span class="number">1.21e-07</span> ***</span><br><span class="line">speed        <span class="number">1.15728</span>    <span class="number">0.04861</span>  <span class="number">23.808</span> <span class="number">8.18e-11</span> ***</span><br><span class="line">type         <span class="number">0.32690</span>    <span class="number">0.04861</span>   <span class="number">6.725</span> <span class="number">3.26e-05</span> ***</span><br><span class="line">---</span><br><span class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">(Dispersion parameter <span class="keyword">for</span> Gamma family taken to be <span class="number">0.009451408</span>)</span><br><span class="line"></span><br><span class="line">    Null deviance: <span class="number">7.02517</span>  on <span class="number">15</span>  degrees of freedom</span><br><span class="line">Residual deviance: <span class="number">0.10527</span>  on <span class="number">11</span>  degrees of freedom</span><br><span class="line">AIC: <span class="number">28.17</span></span><br><span class="line"></span><br><span class="line">Number of Fisher Scoring iterations: <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>From the p-values for the regression coefficients (last column), we can see that <code>load</code>, <code>flow</code>, <code>speed</code> and <code>type</code> may make a significant contribution to the equation. Thus, we can reject the hypothesis that the parameters are $0$. That is to say, each regression coefficient in the model is statistically significant $(p&lt;0.5)$.</p>
<!-- b. Find the model deviance for the GLM from part a. Does this indicate that the model is satisfactory? -->
<p>Let’s take a look at the regression coefficients:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">coef(fit.full)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(Intercept)        load        flow       speed        type</span><br><span class="line">  <span class="number">0.5026869</span>   <span class="number">0.1312552</span>   <span class="number">0.5812258</span>   <span class="number">1.1572823</span>   <span class="number">0.3268990</span></span><br></pre></td></tr></table></figure>
<p>Since log(odds) are difficult to interpret, we can exponentiate them to put the result on an odds scale:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp(coef(fit.full))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(Intercept)        load        flow       speed        type</span><br><span class="line">   <span class="number">1.653157</span>    <span class="number">1.140259</span>    <span class="number">1.788229</span>    <span class="number">3.181276</span>    <span class="number">1.386661</span></span><br></pre></td></tr></table></figure>
<p>Now, we can see that the advance rate of a drill is increased by a factor of <code>1.140259</code> for one-unit increase in drill load (holding flow, speed and type constant). Similar increasing trend can be detected in other factors. Because the predictor variables can’t equal 0, the intercept isn’t meaningfull in this case.</p>
<p>Also, we can use the <code>confint()</code> function to obtain confident intervals for the coefficients.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp(confint(fit.full))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">               <span class="number">2.5</span> %   <span class="number">97.5</span> %</span><br><span class="line">(Intercept) <span class="number">1.488639</span> <span class="number">1.839411</span></span><br><span class="line">load        <span class="number">1.036550</span> <span class="number">1.254344</span></span><br><span class="line">flow        <span class="number">1.625624</span> <span class="number">1.967101</span></span><br><span class="line">speed       <span class="number">2.891712</span> <span class="number">3.499836</span></span><br><span class="line">type        <span class="number">1.260412</span> <span class="number">1.525555</span></span><br></pre></td></tr></table></figure>
<p>97.5 percent confidence intervals fro each of the coefficients on an odds scale are printed above.</p>
<p>Finally, we use compare the residual deviance with the residual degrees of freedom to detect the overdispersion.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deviance(fit.full)/df.residual(fit.full)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">0.009570289</span></span><br></pre></td></tr></table></figure>
<p>which is far away from 1, suggesting the overdispersion.</p>
<p>Deviance can be draw by the command</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fit.full$deviance</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">0.1052732</span></span><br></pre></td></tr></table></figure>
<h3 id="Bonus-Problems"><a href="#Bonus-Problems" class="headerlink" title="Bonus Problems"></a>Bonus Problems</h3><h4 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h4><blockquote>
<p>Prove that the deduction matrix of variance $\mathrm{Var}(\hat\beta^*<em>{q+1}) - \mathrm{Var}(\hat\beta</em>{q+1})$ is positive semidefinite.</p>
</blockquote>
<p>What we knew is that</p>
<p>$$<br>\begin{align<em>}<br>&amp;\mathrm{Var}(\hat\beta^</em>) = \sigma^2(X’X)^{-1} \<br>&amp;\mathrm{Var}(\hat\beta^<em><em>{q+1}) = \sigma^2(X</em>{q+1}’X_{q+1})^{-1}<br>\end{align</em>}<br>$$</p>
<p>where $X = \left( \begin{array}{c:c} X_{q+1} &amp; X_r \end{array}\right)$.</p>
<p>Consider the normal matrix</p>
<p>$$<br>X’X = \begin{pmatrix}<br>X<em>{q+1}’X</em>{q+1} &amp; X_{q+1}’X_r \<br>X<em>r’X</em>{q+1} &amp; X_r’X<em>r<br>\end{pmatrix} = \begin{pmatrix}<br>\Sigma</em>{11} &amp; \Sigma<em>{12} \<br>\Sigma</em>{21} &amp; \Sigma_{22}<br>\end{pmatrix}<br>$$</p>
<p>Inverse of this bolck matrix is already given as</p>
<blockquote>
<p>$$<br>\begin{pmatrix}<br>\Sigma<em>{11} &amp; \Sigma</em>{12} \<br>\Sigma<em>{21} &amp; \Sigma</em>{22} \<br>\end{pmatrix}^{-1} =\, \begin{pmatrix}<br>\Sigma<em>{11}^{-1}+\Sigma</em>{11}^{-1}\Sigma<em>{12}\Sigma</em>{22.1}^{-1}\Sigma<em>{21}\Sigma</em>{11}^{-1} &amp; -\Sigma<em>{11}^{-1}\Sigma</em>{12}\Sigma<em>{22.1}^{-1} \<br>-\Sigma</em>{22.1}^{-1}\Sigma<em>{21}\Sigma</em>{11}^{-1} &amp; \Sigma_{22.1}^{-1} \<br>\end{pmatrix}<br>$$</p>
<p>where<br>$$<br>\Sigma<em>{22.1}=\Sigma</em>{22}-\Sigma<em>{21}\Sigma</em>{11}^{-1}\Sigma_{12}<br>$$</p>
</blockquote>
<p>Thus, we say the first entry of the inverse matrix should be</p>
<p>$$<br>\Sigma<em>{11}^{-1}+\Sigma</em>{11}^{-1}\Sigma<em>{12}\Sigma</em>{22.1}^{-1}\Sigma<em>{21}\Sigma</em>{11}^{-1}<br>$$</p>
<p>Set $A = \Sigma<em>{11}^{-1}\Sigma</em>{12} = (X<em>{q+1}’X</em>{q+1})^{-1}\cdot(X_{q+1}’X_r)$ to be the alias matrix. Hence we have</p>
<p>$$<br>\mathrm{Var}(\hat\beta^*<em>{q+1}) - \mathrm{Var}(\hat\beta</em>{q+1}) = \sigma^2 A\big(X_r’X_r - X<em>r’X</em>{q+1}A\big)^{-1}\,A’<br>$$</p>
<p>which is obviously positive semidefinite.</p>
<h4 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h4><blockquote>
<p>Prove that</p>
<p>$$<br>F = \dfrac{SS_A/(a-1)}{SS<em>E/(n-a)} \sim F</em>{a-1, n-a}<br>$$</p>
<p>under the hypothesis $H_0$.</p>
</blockquote>
<p>What we learned is that</p>
<p>$$<br>\begin{align<em>}<br>SS<em>T &amp;= \sum</em>{i=1}^a \sum_{j=1}^{n<em>i} (y</em>{ij} - \bar y)^2 \<br>&amp;= \sum<em>{i=1}^a \sum</em>{j=1}^{n<em>i} (y</em>{ij} - \bar y<em>{i\cdot} + \bar y</em>{i\cdot} - \bar y)^2 \<br>&amp;= \underbrace{\sum<em>{i=1}^a \sum</em>{j=1}^{n<em>i} (y</em>{ij} - \bar y<em>{i\cdot})^2}</em>{SS<em>E} + \underbrace{\sum</em>{i=1}^a \sum_{j=1}^{n<em>i} (\bar y</em>{i\cdot} - \bar y)^2}_{SS_A}<br>\end{align</em>}<br>$$</p>
<p>For clarity, we give the coresponding matrix form:</p>
<p>$$<br>\begin{align<em>}<br>SS<em>T &amp;= y’(I-\frac1n \boldsymbol{1}\boldsymbol{1}’)y \<br>&amp;= y’(I - A + A - \frac1n \boldsymbol{1}\boldsymbol{1}’)y \<br>&amp;= \underbrace{y’(I - A)y}</em>{SS<em>E} + \underbrace{y’(A - \frac1n \boldsymbol{1}\boldsymbol{1}’)y}</em>{SS_A}<br>\end{align</em>}<br>$$</p>
<p>where $A = \dfrac{1}{n<em>1}\boldsymbol{1}</em>{n<em>1}\boldsymbol{1}</em>{n_1}’ \oplus \cdots \oplus \dfrac{1}{n<em>a}\boldsymbol{1}</em>{n<em>a}\boldsymbol{1}</em>{n_a}’$</p>
<p>Since $\boldsymbol{1}_{n<em>i}’\boldsymbol{1}</em>{n_i} = n<em>i$, we know that $I</em>{n_i} - \dfrac{1}{n<em>i}\boldsymbol{1}</em>{n<em>i}\boldsymbol{1}</em>{n_i}’$ is a Household matrix, which is definitely symetric and idempotent. i.e.</p>
<p>$$<br>A’=A \qquad A^2 = A<br>$$</p>
<p>Next, we assume that $B=I-A$, $C=A-\dfrac1n\boldsymbol{1}\boldsymbol{1}’$</p>
<p>We claim that</p>
<p>$$<br>\begin{align<em>}<br>&amp;B’=B \qquad B^2 = B \<br>&amp;C’=C \qquad C^2 = C<br>\end{align</em>}<br>$$</p>
<p>with its rank</p>
<p>$$<br>\mathrm{rank}(B)=n-a \quad \mathrm{rank}(C)=a-1<br>$$</p>
<p>Thus, under the normal hyperthesis $Y\sim N(0,\sigma^2I)$, we have</p>
<p>$$<br>\begin{align<em>}<br>&amp;\frac{Y’BY}{\sigma^2} \sim \chi^2(n-a) \<br>&amp;\frac{Y’CY}{\sigma^2} \sim \chi^2(a-1)<br>\end{align</em>}<br>$$</p>
<p>together with</p>
<p>$$<br>\begin{align<em>}<br>BC &amp;= (I-A)(A-\frac1n\boldsymbol{1}\boldsymbol{1}’) \<br>&amp;= A-\frac1n\boldsymbol{1}\boldsymbol{1}’-A^2+\frac1n A\boldsymbol{1}\boldsymbol{1}’ \<br>&amp;= A-\frac1n\boldsymbol{1}\boldsymbol{1}’-A+\frac1n\boldsymbol{1}\boldsymbol{1}’ \<br>&amp;= 0<br>\end{align</em>}<br>$$</p>
<p>The last two equation follows from the fact that</p>
<p>$$<br>\begin{align<em>}<br>A \cdot \boldsymbol{1} &amp;= \big( \frac{1}{n<em>1}\boldsymbol{1}</em>{n<em>1}\boldsymbol{1}</em>{n_1}’ \oplus \cdots \oplus \frac{1}{n<em>a}\boldsymbol{1}</em>{n<em>a}\boldsymbol{1}</em>{n<em>a}’ \big) \cdot \big(\boldsymbol{1}</em>{n<em>1} \oplus \cdots \oplus \boldsymbol{1}</em>{n_a}\big) \<br>&amp;= \frac{1}{n<em>1}\boldsymbol{1}</em>{n<em>1}\boldsymbol{1}</em>{n<em>1}’\boldsymbol{1}</em>{n_1} \oplus \cdots \oplus \frac{1}{n<em>a}\boldsymbol{1}</em>{n<em>a}\boldsymbol{1}</em>{n<em>a}’\boldsymbol{1}</em>{n<em>a} \<br>&amp;= \boldsymbol{1}</em>{n<em>1} \oplus \cdots \oplus \boldsymbol{1}</em>{n_a} = \boldsymbol{1}<br>\end{align</em>}<br>$$</p>
<p>Hence, we know that $Y’(I-A)Y$ and $Y’(A-\dfrac1n\boldsymbol{1}\boldsymbol{1}’)Y$ are mutually independent, which indicates</p>
<p>$$<br>F=\frac{Y’CY/(a-1)}{Y’BY/(n-a)} = \frac{SS_A/(a-1)}{SS<em>E/(n-a)} \sim F</em>{a-1, n-a}<br>$$</p>
<p>Furthermore, we can derive two unbiased estimates.</p>
<p>$$<br>\begin{align<em>}<br>E(SS_E) &amp;= E\big(Y’(I-A)Y\big) \<br>&amp;= \mu’(I-A)\mu + \mathrm{tr}\big((I-A)\sigma^2I\big) \<br>&amp;= \mu’\mu - \mu’A\mu + \sigma^2(n-a) \<br>&amp;= \sigma^2(n-a)<br>\end{align</em>}<br>$$</p>
<p>The last equation is derived from the hypothesis.</p>
<p>Similarly,</p>
<p>$$<br>\begin{align<em>}<br>E(SS_A) &amp;= E\big(Y’(A-\frac1n\boldsymbol{1}\boldsymbol{1}’)Y\big) \<br>&amp;= \mu’(A-\frac1n\boldsymbol{1}\boldsymbol{1}’)\mu + \mathrm{tr}\big((A-\frac1n\boldsymbol{1}\boldsymbol{1}’)\sigma^2I\big) \<br>&amp;= \mu’\mu - \mu’A\mu + \sigma^2(a-1) \<br>&amp;= \sigma^2(a-1)<br>\end{align</em>}<br>$$</p>
<p>That’s to say</p>
<p>$$<br>E\big(SS_E/(n-a)\big) = E\big(SS_A/(a-1)\big) = \sigma^2<br>$$</p>
<hr>
<p><em>Kai Liu, wrote on 2017/11/28</em></p>
<p><em>Student ID: 116071910015</em></p>
<p><em>Mail: liu1995@sjtu.edu.cn</em></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Monad Kai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="../../../../onlookerliu.github.io/2017/12/01/Project-3-of-Statistics/">onlookerliu.github.io/2017/12/01/Project-3-of-Statistics/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="onlookerliu.github.io" target="_blank">Code@浮生记</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="../../../../tags/r/">r</a><a class="post-meta__tags" href="../../../../tags/statistic/">statistic</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="http://oxyywddt8.bkt.clouddn.com/qrcode/ali-qrcode.jpg"><div class="post-qr-code__desc">支付宝打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="http://oxyywddt8.bkt.clouddn.com/qrcode/Wechat.jpeg"><div class="post-qr-code__desc">微信打赏</div></div></div><div class="addthis_inline_share_toolbox pull-right"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=undefined" async></script><nav id="pagination"><div class="prev-post pull-left"><a href="../../15/Project-4-of-Statistics/"><i class="fa fa-chevron-left">  </i><span>Project 4 of Statistics.md</span></a></div><div class="next-post pull-right"><a href="../../../11/29/julia基于GLM包的线性回归/"><span>julia基于GLM包的线性回归</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2018 By Monad Kai</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="../../../../js/third-party/anime.min.js"></script><script src="../../../../js/third-party/jquery.min.js"></script><script src="../../../../js/third-party/jquery.fancybox.min.js"></script><script src="../../../../js/third-party/velocity.min.js"></script><script src="../../../../js/third-party/velocity.ui.min.js"></script><script src="../../../../js/utils.js?version=1.5.3"></script><script src="../../../../js/fancybox.js?version=1.5.3"></script><script src="../../../../js/sidebar.js?version=1.5.3"></script><script src="../../../../js/copy.js?version=1.5.3"></script><script src="../../../../js/fireworks.js?version=1.5.3"></script><script src="../../../../js/transition.js?version=1.5.3"></script><script src="../../../../js/scroll.js?version=1.5.3"></script><script src="../../../../js/head.js?version=1.5.3"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>