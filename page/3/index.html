<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="onlookerliu.github.io">
  <title>Code@浮生记</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Life is beautiful!">
<meta property="og:type" content="website">
<meta property="og:title" content="Code@浮生记">
<meta property="og:url" content="onlookerliu.github.io/page/3/index.html">
<meta property="og:site_name" content="Code@浮生记">
<meta property="og:description" content="Life is beautiful!">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Code@浮生记">
<meta name="twitter:description" content="Life is beautiful!">
  
    <link rel="alternative" href="/atom.xml" title="Code@浮生记" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.0cf68a.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="http://oxyywddt8.bkt.clouddn.com/portrait/liukai.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">Kai Liu</a></h1>
		</hgroup>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="../../index.html">主页</a></li>
	        
				<li><a href="../../tags/随笔/">随笔</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友链</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/onlookerliu" title="github"><i class="icon-github"></i></a>
		        
					<a class="rss" target="_blank" href="#" title="rss"><i class="icon-rss"></i></a>
		        
					<a class="zhihu" target="_blank" href="#" title="zhihu"><i class="icon-zhihu"></i></a>
		        
					<a class="mail" target="_blank" href="mailto:liu1995@sjtu.edu.cn" title="mail"><i class="icon-mail"></i></a>
		        
					<a class="qq" target="_blank" href="../../2237595948" title="qq"><i class="icon-qq"></i></a>
		        
					<a class="weixin" target="_blank" href="../../onlookerliu" title="weixin"><i class="icon-weixin"></i></a>
		        
					<a class="jianshu" target="_blank" href="https://www.jianshu.com/u/43b0ad7b3696" title="jianshu"><i class="icon-jianshu"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="http://oxyywddt8.bkt.clouddn.com/portrait/liukai.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">Kai Liu</h1>
			</hgroup>
			
			
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/onlookerliu" title="github"><i class="icon-github"></i></a>
			        
						<a class="rss" target="_blank" href="#" title="rss"><i class="icon-rss"></i></a>
			        
						<a class="zhihu" target="_blank" href="#" title="zhihu"><i class="icon-zhihu"></i></a>
			        
						<a class="mail" target="_blank" href="mailto:liu1995@sjtu.edu.cn" title="mail"><i class="icon-mail"></i></a>
			        
						<a class="qq" target="_blank" href="../../2237595948" title="qq"><i class="icon-qq"></i></a>
			        
						<a class="weixin" target="_blank" href="../../onlookerliu" title="weixin"><i class="icon-weixin"></i></a>
			        
						<a class="jianshu" target="_blank" href="https://www.jianshu.com/u/43b0ad7b3696" title="jianshu"><i class="icon-jianshu"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 50%">
				
				
					<li style="width: 50%"><a href="../../index.html">主页</a></li>
		        
					<li style="width: 50%"><a href="../../tags/随笔/">随笔</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            
  
    <article id="post-剑指offer-JavaScript版II" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="../../2017/12/27/剑指offer-JavaScript版II/">剑指offer--JavaScript版II</a>
    </h1>
  

        
        <a href="../../2017/12/27/剑指offer-JavaScript版II/" class="archive-article-date">
  	<time datetime="2017-12-27T15:54:21.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-12-27</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>26.<br>输入一个字符串,按字典序打印出该字符串中字符的所有排列。例如输入字符串abc,则打印出由字符a,b,c所能排列出来的所有字符串abc,acb,bac,bca,cab和cba。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Convert</span>(<span class="params">pRootOfTree</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!pRootOfTree) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> lastNode = <span class="literal">null</span>;</span><br><span class="line">    lastNode = ConvertNode(pRootOfTree);</span><br><span class="line">    <span class="keyword">var</span> head = lastNode;</span><br><span class="line">    <span class="keyword">while</span> (head &amp;&amp; head.left) &#123;</span><br><span class="line">        head = head.left;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ConvertNode</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!node) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (node.left) &#123;</span><br><span class="line">            lastNode = ConvertNode(node.left);</span><br><span class="line">        &#125;</span><br><span class="line">        node.left = lastNode;</span><br><span class="line">        <span class="keyword">if</span> (lastNode) &#123;</span><br><span class="line">            lastNode.right = node;</span><br><span class="line">        &#125;</span><br><span class="line">        lastNode = node;</span><br><span class="line">        <span class="keyword">if</span> (node.right) &#123;</span><br><span class="line">            lastNode = ConvertNode(node.right);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lastNode;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>27.<br>数组中有一个数字出现的次数超过数组长度的一半，请找出这个数字。例如输入一个长度为9的数组{1,2,3,2,2,2,5,4,2}。由于数字2在数组中出现了5次，超过数组长度的一半，因此输出2。如果不存在则输出0。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MoreThanHalfNum_Solution</span>(<span class="params">numbers</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!numbers || numbers.length === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> arr = [];</span><br><span class="line">    <span class="keyword">var</span> len = numbers.length, index;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> index = numbers[i];</span><br><span class="line">        arr[index] !== <span class="literal">undefined</span> ? arr[index]++ : arr[index] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">var</span> arrLen = arr.length;</span><br><span class="line">    <span class="keyword">var</span> max = -<span class="literal">Infinity</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arrLen; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!arr[i]) <span class="keyword">continue</span>;</span><br><span class="line">        max = arr[i] &gt; max ? (index = i, arr[i]) : max;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> max &gt; len / <span class="number">2</span> ? index : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>28.<br>输入n个整数，找出其中最小的K个数。例如输入4,5,1,6,2,7,3,8这8个数字，则最小的4个数字是1,2,3,4。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetLeastNumbers_Solution</span>(<span class="params">input, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!input || input.length &lt; k) &#123;</span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> input.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a - b;</span><br><span class="line">    &#125;).slice(<span class="number">0</span>, k);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>29.<br>HZ偶尔会拿些专业问题来忽悠那些非计算机专业的同学。今天测试组开完会后,他又发话了:在古老的一维模式识别中,常常需要计算连续子向量的最大和,当向量全为正数的时候,问题很好解决。但是,如果向量中包含负数,是否应该包含某个负数,并期望旁边的正数会弥补它呢？例如:{6,-3,-2,7,-15,1,2,2},连续子向量的最大和为8(从第0个开始,到第3个为止)。你会不会被他忽悠住？(子向量的长度至少是1)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FindGreatestSumOfSubArray</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (array.length &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> sum = array[<span class="number">0</span>],</span><br><span class="line">        tempsum = array[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">        tempsum = tempsum &lt; <span class="number">0</span> ? array[i] : tempsum + array[i];</span><br><span class="line">        sum = tempsum &gt; sum ? tempsum : sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>30.<br>求出1~13的整数中1出现的次数,并算出100~1300的整数中1出现的次数？为此他特别数了一下1~13中包含1的数字有1、10、11、12、13因此共出现6次,但是对于后面问题他就没辙了。ACMer希望你们帮帮他,并把问题更加普遍化,可以很快的求出任意非负整数区间中1出现的次数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NumberOf1Between1AndN</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> ones = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> arr = [];</span><br><span class="line">    <span class="keyword">while</span> (n) &#123;</span><br><span class="line">        arr.push(n);</span><br><span class="line">        n--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr.join(<span class="string">''</span>).replace(<span class="regexp">/[^1]+/g</span>, <span class="string">''</span>).length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>31.<br>输入一个正整数数组，把数组里所有数字拼接起来排成一个数，打印能拼接出的所有数字中最小的一个。例如输入数组{3，32，321}，则打印出这三个数字能排成的最小数字为321323。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PrintMinNumber</span>(<span class="params">numbers</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!numbers || numbers.length === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">var</span> temp = <span class="string">''</span>;</span><br><span class="line">    ordering(numbers);</span><br><span class="line">    result = result.map(<span class="built_in">Number</span>).reduce(<span class="function"><span class="keyword">function</span>(<span class="params">min, a</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> min &lt; a ? min : a;</span><br><span class="line">    &#125;, <span class="literal">Infinity</span>);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ordering</span>(<span class="params">tempArr</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> innerLen = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (tempArr.length === <span class="number">0</span>) &#123;</span><br><span class="line">            result.push(temp);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; tempArr.length; i++) &#123;</span><br><span class="line">            innerLen = tempArr[i].toString().length;</span><br><span class="line">            temp += tempArr[i];</span><br><span class="line">            insideArr = tempArr.concat();</span><br><span class="line">            insideArr.splice(i, <span class="number">1</span>);</span><br><span class="line">            ordering(insideArr);</span><br><span class="line">            temp = temp.substring(<span class="number">0</span>, temp.length - innerLen);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>32.<br>把只包含因子2、3和5的数称作丑数（Ugly Number）。例如6、8都是丑数，但14不是，因为它包含因子7。 习惯上我们把1当做是第一个丑数。求按从小到大的顺序的第N个丑数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetUglyNumber</span>(<span class="params">index</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index === <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> uglyNum = [<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">var</span> factor2 = <span class="number">0</span>, factor3 = <span class="number">0</span>, factor5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; index; i++) &#123;</span><br><span class="line">        uglyNum[i] = <span class="built_in">Math</span>.min(uglyNum[factor2] * <span class="number">2</span>, uglyNum[factor3] * <span class="number">3</span>, uglyNum[factor5] * <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">if</span> (uglyNum[i] === uglyNum[factor2] * <span class="number">2</span>) factor2++;</span><br><span class="line">        <span class="keyword">if</span> (uglyNum[i] === uglyNum[factor3] * <span class="number">3</span>) factor3++;</span><br><span class="line">        <span class="keyword">if</span> (uglyNum[i] === uglyNum[factor5] * <span class="number">5</span>) factor5++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> uglyNum[index - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>33.<br>在一个字符串(1&lt;=字符串长度&lt;=10000，全部由字母组成)中找到第一个只出现一次的字符,并返回它的位置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FirstNotRepeatingChar</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!str || !str.length) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> hash = &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> tempArr = str.split(<span class="string">''</span>);</span><br><span class="line">    <span class="keyword">var</span> unique = [];</span><br><span class="line">    <span class="keyword">var</span> len = str.length, temp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        temp = tempArr[i];</span><br><span class="line">        <span class="keyword">if</span> (hash[temp]) &#123;</span><br><span class="line">            hash[temp].push(i);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            hash[temp] = [i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> hash) &#123;</span><br><span class="line">        <span class="keyword">if</span> (hash.hasOwnProperty(key)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (hash[key].length === <span class="number">1</span>) &#123;</span><br><span class="line">                unique.push(hash[key].pop());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.min.apply(<span class="literal">null</span>, unique);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>35.<br>输入两个链表，找出它们的第一个公共结点。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FindFirstCommonNode</span>(<span class="params">pHead1, pHead2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!pHead1 || !pHead2) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> len1 = getLength(pHead1);</span><br><span class="line">    <span class="keyword">var</span> len2 = getLength(pHead2);</span><br><span class="line">    <span class="keyword">var</span> lenDiff = len1 - len2;</span><br><span class="line">    <span class="keyword">var</span> curr1 = pHead1;</span><br><span class="line">    <span class="keyword">var</span> curr2 = pHead2;</span><br><span class="line">    <span class="keyword">if</span> (len2 &gt; len1) &#123;</span><br><span class="line">        curr1 = pHead2;</span><br><span class="line">        curr2 = pHead1;</span><br><span class="line">        lenDiff = len2 - len1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; lenDiff; ++i)</span><br><span class="line">        curr1 = curr1.next;</span><br><span class="line">    <span class="keyword">while</span> (curr1 &amp;&amp; curr2 &amp;&amp; curr1 != curr2) &#123;</span><br><span class="line">        curr1 = curr1.next;</span><br><span class="line">        curr2 = curr2.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> curr1;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getLength</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> len = <span class="number">0</span>;</span><br><span class="line">        curr = node;</span><br><span class="line">        <span class="keyword">while</span> (curr) &#123;</span><br><span class="line">            len++;</span><br><span class="line">            curr = curr.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> len;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>36.<br>统计一个数字在排序数组中出现的次数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetNumberofK</span>(<span class="params">data, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> data.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">count, a</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a === k ? count+<span class="number">1</span> : count;</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>37.<br>输入一棵二叉树，求该树的深度。从根结点到叶结点依次经过的结点（含根、叶结点）形成树的一条路径，最长路径的长度为树的深度。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">TreeDepth</span>(<span class="params">pRoot</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!pRoot) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> depth = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> currDepth = <span class="number">0</span>;</span><br><span class="line">    dfs(pRoot);</span><br><span class="line">    <span class="keyword">return</span> depth;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">dfs</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!node) &#123;</span><br><span class="line">            depth = depth &gt; currDepth ? depth : currDepth;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        currDepth++;</span><br><span class="line">        dfs(node.left);</span><br><span class="line">        dfs(node.right);</span><br><span class="line">        currDepth--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>38.<br>输入一棵二叉树，判断该二叉树是否是平衡二叉树。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">IsBalanced</span>(<span class="params">pRoot</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!pRoot) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> left = TreeDepth(pRoot.left);</span><br><span class="line">    <span class="keyword">var</span> right = TreeDepth(pRoot.right);</span><br><span class="line">    <span class="keyword">var</span> diff = left - right;</span><br><span class="line">    <span class="keyword">if</span> (diff &gt; <span class="number">1</span> || diff &lt; <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> IsBalanced(pRoot.left) &amp;&amp; IsBalanced(pRoot.right);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">TreeDepth</span>(<span class="params">pRoot</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!pRoot) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> depth = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">var</span> currDepth = <span class="number">0</span>;</span><br><span class="line">        dfs(pRoot);</span><br><span class="line">        <span class="keyword">return</span> depth;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">dfs</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!node) &#123;</span><br><span class="line">                depth = depth &gt; currDepth ? depth : currDepth;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            currDepth++;</span><br><span class="line">            dfs(node.left);</span><br><span class="line">            dfs(node.right);</span><br><span class="line">            currDepth--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>39.<br>一个整型数组里除了两个数字之外，其他的数字都出现了两次。请写程序找出这两个只出现一次的数字。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FindNumsAppearOnce</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!array || array.length &lt; <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    <span class="keyword">return</span> array.sort().join(<span class="string">','</span>).replace(<span class="regexp">/(\d+),\1/g</span>, <span class="string">""</span>).replace(<span class="regexp">/,+/g</span>, <span class="string">','</span>).replace(<span class="regexp">/^,|,$/</span>,<span class="string">''</span>).split(<span class="string">','</span>).map(<span class="built_in">Number</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>40.<br>小明很喜欢数学,有一天他在做数学作业时,要求计算出9~16的和,他马上就写出了正确答案是100。但是他并不满足于此,他在想究竟有多少种连续的正数序列的和为100(至少包括两个数)。没多久,他就得到另一组连续正数和为100的序列:18,19,20,21,22。现在把问题交给你,你能不能也很快的找出所有和为S的连续正数序列? Good Luck!</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FindContinuousSequence</span>(<span class="params">sum</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (sum &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> small = <span class="number">1</span>, big = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">var</span> mid = (<span class="number">1</span> + sum) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">var</span> curr = small + big;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">while</span> (small &lt; mid) &#123;</span><br><span class="line">        <span class="keyword">if</span> (curr === sum) &#123;</span><br><span class="line">            pushSeq(small, big);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (curr &gt; sum &amp;&amp; small &lt; mid) &#123;</span><br><span class="line">            curr -= small;</span><br><span class="line">            small++;</span><br><span class="line">            <span class="keyword">if</span> (curr === sum) &#123;</span><br><span class="line">                pushSeq(small, big);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        big++;</span><br><span class="line">        curr += big;</span><br><span class="line">    &#125;</span><br><span class="line">    result.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;<span class="keyword">return</span> a[<span class="number">0</span>] - b[<span class="number">0</span>];&#125;);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">pushSeq</span>(<span class="params">small, big</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> temp = [];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = small; i &lt;= big; i++) &#123;</span><br><span class="line">            temp.push(i);</span><br><span class="line">        &#125;</span><br><span class="line">        result.push(temp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>41.<br>输入一个递增排序的数组和一个数字S，在数组中查找两个数，是的他们的和正好是S，如果有多对数字的和等于S，输出两个数的乘积最小的。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FindNumbersWith</span>(<span class="params">array, sum</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!array || !array.length) &#123;</span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">var</span> product = [];</span><br><span class="line">    <span class="keyword">var</span> head = <span class="number">0</span>, tail = array.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (head &lt; tail) &#123;</span><br><span class="line">        <span class="keyword">var</span> curr = array[head] + array[tail];</span><br><span class="line">        <span class="keyword">if</span> (curr === sum) &#123;</span><br><span class="line">            result.push([array[head], array[tail]]);</span><br><span class="line">            product.push(array[head] * array[tail]);</span><br><span class="line">            tail--;</span><br><span class="line">            head++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (curr &gt; sum) &#123;</span><br><span class="line">            tail--;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            head++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (result.length === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> min = <span class="built_in">Math</span>.min.apply(<span class="literal">null</span>, product);</span><br><span class="line">    <span class="keyword">var</span> index = product.indexOf(min);</span><br><span class="line">    <span class="keyword">return</span> result[index];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>42.<br>汇编语言中有一种移位指令叫做循环左移（ROL），现在有个简单的任务，就是用字符串模拟这个指令的运算结果。对于一个给定的字符序列S，请你把其循环左移K位后的序列输出。例如，字符序列S=”abcXYZdef”,要求输出循环左移3位后的结果，即“XYZdefabc”。是不是很简单？OK，搞定它！</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">LeftRotateString</span>(<span class="params">str, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!str) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> len = str.length;</span><br><span class="line">    n = n % len;</span><br><span class="line">    <span class="keyword">var</span> left = str.slice(<span class="number">0</span>, n);</span><br><span class="line">    <span class="keyword">var</span> right = str.slice(n);</span><br><span class="line">    <span class="keyword">return</span> right + left;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>43.<br>牛客最近来了一个新员工Fish，每天早晨总是会拿着一本英文杂志，写些句子在本子上。同事Cat对Fish写的内容颇感兴趣，有一天他向Fish借来翻看，但却读不懂它的意思。例如，“student. a am I”。后来才意识到，这家伙原来把句子单词的顺序翻转了，正确的句子应该是“I am a student.”。Cat对一一的翻转这些单词顺序可不在行，你能帮助他么？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ReverseSentence</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str.split(<span class="string">' '</span>).reverse().join(<span class="string">' '</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>44.<br>LL今天心情特别好,因为他去买了一副扑克牌,发现里面居然有2个大王,2个小王(一副牌原本是54张^_^)…他随机从中抽出了5张牌,想测测自己的手气,看看能不能抽到顺子,如果抽到的话,他决定去买体育彩票,嘿嘿！！“红心A,黑桃3,小王,大王,方片5”,“Oh My God!”不是顺子…..LL不高兴了,他想了想,决定大\小 王可以看成任何数字,并且A看作1,J为11,Q为12,K为13。上面的5张牌就可以变成“1,2,3,4,5”(大小王分别看作2和4),“So Lucky!”。LL决定去买体育彩票啦。 现在,要求你使用这幅牌模拟上面的过程,然后告诉我们LL的运气如何。为了方便起见,你可以认为大小王是0。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">IsContinuous</span>(<span class="params">numbers</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!numbers || numbers.length &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> len = numbers.length;</span><br><span class="line">    numbers.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;<span class="keyword">return</span> a - b;&#125;);</span><br><span class="line">    <span class="keyword">var</span> zeros = <span class="number">0</span>, gaps = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len &amp;&amp; numbers[i] == <span class="number">0</span>; i++) &#123;</span><br><span class="line">        zeros++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> small = zeros, big = small + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (big &lt; len) &#123;</span><br><span class="line">        <span class="keyword">if</span> (numbers[small] == numbers[big]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        gaps += numbers[big] - numbers[small] - <span class="number">1</span>;</span><br><span class="line">        small = big++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> gaps &lt;= zeros;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>45.<br>每年六一儿童节,牛客都会准备一些小礼物去看望孤儿院的小朋友,今年亦是如此。HF作为牛客的资深元老,自然也准备了一些小游戏。其中,有个游戏是这样的:首先,让小朋友们围成一个大圈。然后,他随机指定一个数m,让编号为0的小朋友开始报数。每次喊到m-1的那个小朋友要出列唱首歌,然后可以在礼品箱中任意的挑选礼物,并且不再回到圈中,从他的下一个小朋友开始,继续0…m-1报数….这样下去….直到剩下最后一个小朋友,可以不用表演,并且拿到牛客名贵的“名侦探柯南”典藏版(名额有限哦!!^_^)。请你试着想下,哪个小朋友会得到这份礼品呢？(注：小朋友的编号是从0到n-1)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">LastRemaining</span>(<span class="params">n, m</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">1</span> || m &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> last = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        last = (last + m) % i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> last;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>46.<br>求1+2+3+…+n，要求不能使用乘除法、for、while、if、else、switch、case等关键字及条件判断语句（A?B:C）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Sum</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">    plus(n);</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">plus</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">        sum += num;</span><br><span class="line">        num &gt; <span class="number">0</span> &amp;&amp; plus(--num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>47.<br>写一个函数，求两个整数之和，要求在函数体内不得使用+、-、*、/四则运算符号。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Add</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sum, carry;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        sum = num1 ^ num2;</span><br><span class="line">        carry = (num1 &amp; num2) &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        num1 = sum;</span><br><span class="line">        num2 = carry;</span><br><span class="line">    &#125; <span class="keyword">while</span> (num2 != <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> num1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>48.<br>在一个长度为n的数组里的所有数字都在0到n-1的范围内。 数组中某些数字是重复的，但不知道有几个数字是重复的。也不知道每个数字重复几次。请找出数组中任意一个重复的数字。 例如，如果输入长度为7的数组{2,3,1,0,2,5,3}，那么对应的输出是第一个重复的数字2。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">duplicate</span>(<span class="params">numbers, duplication</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!numbers || !numbers.length) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> len = numbers.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> curr = numbers[i];</span><br><span class="line">        <span class="keyword">if</span> (numbers.indexOf(curr) !== i) &#123;</span><br><span class="line">            duplication[<span class="number">0</span>] = curr;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>49.<br>给定一个数组A[0,1,…,n-1],请构建一个数组B[0,1,…,n-1],其中B中的元素B[i]=A[0]A[1]…A[i-1]A[i+1]…A[n-1]。不能使用除法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">multiply</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!array || !array.length) &#123;</span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">var</span> len1 = array.length;</span><br><span class="line">    result[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; len1; i++) &#123;</span><br><span class="line">        result[i] = array[i - <span class="number">1</span>] * result[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> temp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = len1 - <span class="number">2</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        temp *= array[i + <span class="number">1</span>];</span><br><span class="line">        result[i] *= temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>50.<br>请实现一个函数用来匹配包括’.’和’’的正则表达式。模式中的字符’.’表示任意一个字符，而’’表示它前面的字符可以出现任意次（包含0次）。 在本题中，匹配是指字符串的所有字符匹配整个模式。例如，字符串”aaa”与模式”a.a”和”abaca”匹配，但是与”aa.a”和”ab*a”均不匹配</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">match</span>(<span class="params">s, pattern</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (s === <span class="string">""</span> &amp;&amp; pattern === <span class="string">""</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!pattern || pattern.length === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'^'</span> + pattern + <span class="string">'$'</span>);</span><br><span class="line">    <span class="keyword">return</span> reg.test(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">javascript</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="../../2017/12/27/剑指offer-JavaScript版II/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-剑指offer-JavaScript版I" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="../../2017/12/27/剑指offer-JavaScript版I/">剑指offer--JavaScript版I</a>
    </h1>
  

        
        <a href="../../2017/12/27/剑指offer-JavaScript版I/" class="archive-article-date">
  	<time datetime="2017-12-27T15:47:53.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-12-27</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>1.<br>在一个二维数组中，每一行都按照从左到右递增的顺序排序，每一列都按照从上到下递增的顺序排序。请完成一个函数，输入这样的一个二维数组和一个整数，判断数组中是否含有该整数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Find</span>(<span class="params">target, array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> rowCount = array.length - <span class="number">1</span>, i, j;</span><br><span class="line">    <span class="keyword">for</span> (i=rowCount, j=<span class="number">0</span>; i&gt;=<span class="number">0</span> &amp;&amp; j&lt;array[i].length;) &#123;</span><br><span class="line">        <span class="keyword">if</span> (target == array[i][j]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (target &gt; array[i][j]) &#123;</span><br><span class="line">            j++;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (target &lt; array[i][j]) &#123;</span><br><span class="line">            i--;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.<br>请实现一个函数，将一个字符串中的空格替换成“%20”。例如，当字符串为We Are Happy.则经过替换之后的字符串为We%20Are%20Happy。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">replaceSpace</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str.replace(<span class="regexp">/ /g</span>, <span class="string">'%20'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.<br>输入一个链表，从尾到头打印链表每个节点的值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">replaceSpace</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str.replace(<span class="regexp">/ /g</span>, <span class="string">'%20'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ListNode</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.val = x;</span><br><span class="line">    <span class="keyword">this</span>.next = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printListFromTailToHead</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!head) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">        <span class="keyword">var</span> curr = head;</span><br><span class="line">        <span class="keyword">while</span>(curr) &#123;</span><br><span class="line">            arr.push(curr.val);</span><br><span class="line">            curr = curr.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> arr.reverse();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4.<br>输入某二叉树的前序遍历和中序遍历的结果，请重建出该二叉树。假设输入的前序遍历和中序遍历的结果中都不含重复的数字。例如输入前序遍历序列 {1,2,4,7,3,5,6,8} 和中序遍历序列 {4,7,2,1,5,3,8,6}，则重建二叉树并返回。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">TreeNode</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.val = x;</span><br><span class="line">    <span class="keyword">this</span>.left = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">this</span>.right = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reConstructBinaryTree</span>(<span class="params">pre, vin</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pre.length == <span class="number">0</span> || vin.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> index = vin.indexOf(pre[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">var</span> left = vin.slice(<span class="number">0</span>, index);</span><br><span class="line">    <span class="keyword">var</span> right = vin.slice(index+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">var</span> node = <span class="keyword">new</span> TreeNode(vin[index]);</span><br><span class="line"></span><br><span class="line">    node.left = reConstructBinaryTree(pre.slice(<span class="number">1</span>, index+<span class="number">1</span>), left);</span><br><span class="line">    node.right = reConstructBinaryTree(pre.slice(index+<span class="number">1</span>), right);</span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5.<br>用两个栈来实现一个队列，完成队列的Push和Pop操作。 队列中的元素为int类型。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> stack1 = [];</span><br><span class="line"><span class="keyword">var</span> stack2 = [];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">    stack1.push(node);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pop</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> temp = stack1.pop();</span><br><span class="line">    <span class="keyword">while</span> (temp) &#123;</span><br><span class="line">        stack2.push(temp);</span><br><span class="line">        temp = stack1.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> result = stack2.pop();</span><br><span class="line">        temp = stack2.pop();</span><br><span class="line">    <span class="keyword">while</span> (temp) &#123;</span><br><span class="line">        stack1.push(temp);</span><br><span class="line">        temp = stack2.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>6.<br>把一个数组最开始的若干个元素搬到数组的末尾，我们称之为数组的旋转。 输入一个非递减排序的数组的一个旋转，输出旋转数组的最小元素。 例如数组{3,4,5,1,2}为{1,2,3,4,5}的一个旋转，该数组的最小值为1。 NOTE：给出的所有元素都大于0，若数组大小为0，请返回0。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">minNumberInRotateArray</span>(<span class="params">rotateArray</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len = rotateArray.length;</span><br><span class="line">    <span class="keyword">if</span> (len === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.min.apply(<span class="literal">null</span>, rotateArray);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>7.<br>大家都知道斐波那契数列，现在要求输入一个整数n，请你输出斐波那契数列的第n项。n&lt;=39</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fibonacci</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">1</span>, b = <span class="number">1</span>, temp;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        temp = b;</span><br><span class="line">        b = a + b;</span><br><span class="line">        a = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>8.<br>一只青蛙一次可以跳上1级台阶，也可以跳上2级。求该青蛙跳上一个n级的台阶总共有多少种跳法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jumpFloor</span>(<span class="params">number</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (number &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (number === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (number === <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> temp = <span class="number">0</span>, a = <span class="number">1</span>, b = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">3</span>; i &lt;= number; i++) &#123;</span><br><span class="line">        temp = a + b;</span><br><span class="line">        a = b;</span><br><span class="line">        b = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>9.<br>一只青蛙一次可以跳上1级台阶，也可以跳上2级……它也可以跳上n级。求该青蛙跳上一个n级的台阶总共有多少种跳法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jumpFloorII</span>(<span class="params">number</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.pow(<span class="number">2</span>, number - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>10.<br>我们可以用21的小矩形横着或者竖着去覆盖更大的矩形。请问用n个21的小矩形无重叠地覆盖一个2*n的大矩形，总共有多少种方法？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rectCover</span>(<span class="params">number</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">1</span>, b = <span class="number">2</span>,, temp;</span><br><span class="line">    <span class="keyword">if</span> (number &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (number === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (number === <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">3</span>; i &lt;= number; i++) &#123;</span><br><span class="line">        temp = a + b;</span><br><span class="line">        a = b;</span><br><span class="line">        b = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>11.<br>输入一个整数，输出该数二进制表示中1的个数。其中负数用补码表示。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NumberOf1</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        n = n &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> arr = n.toString(<span class="number">2</span>).split(<span class="string">''</span>);</span><br><span class="line">    <span class="keyword">return</span> arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> b === <span class="string">"1"</span> ? a+<span class="number">1</span> : a;</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>12.<br>给定一个double类型的浮点数base和int类型的整数exponent。求base的exponent次方。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Power</span>(<span class="params">base, exponent</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.pow(base, exponent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>13.<br>输入一个整数数组，实现一个函数来调整该数组中数字的顺序，使得所有的奇数位于数组的前半部分，所有的偶数位于位于数组的后半部分，并保证奇数和奇数，偶数和偶数之间的相对位置不变。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reOrderArray</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">var</span> even = [];</span><br><span class="line">    array.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ((item &amp; <span class="number">1</span>) === <span class="number">1</span>) &#123;</span><br><span class="line">            result.push(item);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            even.push(item);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> result.concat(even);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>14.<br>输入一个链表，输出该链表中倒数第k个结点。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ListNode</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.val = x;</span><br><span class="line">    <span class="keyword">this</span>.next = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FindKthToTail</span>(<span class="params">head, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!head || k&lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> i = head, j = head;</span><br><span class="line">    <span class="keyword">while</span> (--k) &#123;</span><br><span class="line">        j = j.next;</span><br><span class="line">        <span class="keyword">if</span> (!j) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (j.next) &#123;</span><br><span class="line">        i = i.next;</span><br><span class="line">        j = j.next;</span><br><span class="line">    &#125;</span><br><span class="line">    j = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>15.<br>输入一个链表，反转链表后，输出链表的所有元素。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ReverseList</span>(<span class="params">pHead</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> newHead, temp;</span><br><span class="line">    <span class="keyword">if</span> (!pHead) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (pHead.next === <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> pHead;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        newHead = ReverseList(pHead.next);</span><br><span class="line">    &#125;</span><br><span class="line">    temp = pHead.next;</span><br><span class="line">    temp.next = pHead;</span><br><span class="line">    pHead.next = <span class="literal">null</span>;</span><br><span class="line">    temp = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> newHead;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>16.<br>输入两个单调递增的链表，输出两个链表合成后的链表，当然我们需要合成后的链表满足单调不减规则。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Merge</span>(<span class="params">pHead1, pHead2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!pHead1) &#123;</span><br><span class="line">        <span class="keyword">return</span> pHead2 ? pHead2 : <span class="literal">null</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!pHead2) &#123;</span><br><span class="line">        <span class="keyword">return</span> pHead1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// debugger;</span></span><br><span class="line">    <span class="keyword">var</span> curr1 = pHead1;</span><br><span class="line">    <span class="keyword">var</span> curr2 = pHead2;</span><br><span class="line">    <span class="keyword">var</span> result = <span class="keyword">new</span> ListNode(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">var</span> curr = result;</span><br><span class="line">    <span class="keyword">while</span> (curr1 &amp;&amp; curr2) &#123;</span><br><span class="line">        <span class="keyword">if</span> (curr1.val &lt; curr2.val) &#123;</span><br><span class="line">            curr.next = curr1;</span><br><span class="line">            curr1 = curr1.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            curr.next = curr2;</span><br><span class="line">            curr2 = curr2.next;</span><br><span class="line">        &#125;</span><br><span class="line">        curr = curr.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (curr1) &#123;</span><br><span class="line">        curr.next = curr1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (curr2) &#123;</span><br><span class="line">        curr.next = curr2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 防止内存泄漏</span></span><br><span class="line">    curr = result.next;</span><br><span class="line">    result.next = <span class="literal">null</span>;</span><br><span class="line">    result = curr;</span><br><span class="line">    curr = curr1 = curr2 = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>17.<br>v输入两棵二叉树A，B，判断B是不是A的子结构。（ps：我们约定空树不是任意一个树的子结构）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HasSubtree</span>(<span class="params">pRoot1, pRoot2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pRoot1 == <span class="literal">null</span> || pRoot2 == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (isSubTree(pRoot1, pRoot2)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> HasSubtree(pRoot1.left, pRoot2) || HasSubtree(pRoot1.right, pRoot2)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isSubTree</span>(<span class="params">pRoot1, pRoot2</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (pRoot2 == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (pRoot1 == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (pRoot1.val === pRoot2.val) &#123;</span><br><span class="line">            <span class="keyword">return</span> isSubTree(pRoot1.left, pRoot2.left) &amp;&amp; isSubTree(pRoot1.right, pRoot2.right)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>18.<br>操作给定的二叉树，将其变换为源二叉树的镜像。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Mirror</span>(<span class="params">root</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> temp = root.left;</span><br><span class="line">    root.left = root.right;</span><br><span class="line">    root.right = temp;</span><br><span class="line">    <span class="keyword">if</span> (root.left) &#123;</span><br><span class="line">        Mirror(root.left);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (root.right) &#123;</span><br><span class="line">        Mirror(root.right);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>19.<br>输入一个矩阵，按照从外向里以顺时针的顺序依次打印出每一个数字，例如，如果输入如下矩阵： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 则依次打印出数字1,2,3,4,8,12,16,15,14,13,9,5,6,7,11,10.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printMatrix</span>(<span class="params">matrix</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!matrix || !matrix.length) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">var</span> rows = matrix.length, col = matrix[<span class="number">0</span>].length;</span><br><span class="line">    <span class="keyword">var</span> len = rows * cols;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> circle = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (j &lt; cols - cirle) &#123;</span><br><span class="line">            result.push(matrix[i][j]);</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (result.length === len) <span class="keyword">break</span>;</span><br><span class="line">        j--, i++;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; rows - circle) &#123;</span><br><span class="line">            result.push(matrix[i][j]);</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (result.length === len) <span class="keyword">break</span>;</span><br><span class="line">        i--, j--;</span><br><span class="line">        <span class="keyword">while</span> (j &gt;= circle) &#123;</span><br><span class="line">            result.push(matrix[i][j]);</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (result.length === len) <span class="keyword">break</span>;</span><br><span class="line">        j++, i--;</span><br><span class="line">        circle++;</span><br><span class="line">        <span class="keyword">while</span> (i &gt;= circle) &#123;</span><br><span class="line">            result.push(matrix[i][j]);</span><br><span class="line">            i--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (result.length === len) <span class="keyword">break</span>;</span><br><span class="line">        j++, i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>20.<br>定义栈的数据结构，请在该类型中实现一个能够得到栈最小元素的min函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> stack = [];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">    stack.push(node);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pop</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> stack.pop();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">top</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> stack[stack.length - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">min</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.min.apply(<span class="literal">null</span>, stack);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>21.<br>输入两个整数序列，第一个序列表示栈的压入顺序，请判断第二个序列是否为该栈的弹出顺序。假设压入栈的所有数字均不相等。例如序列1,2,3,4,5是某栈的压入顺序，序列4，5,3,2,1是该压栈序列对应的一个弹出序列，但4,3,5,1,2就不可能是该压栈序列的弹出序列。（注意：这两个序列的长度是相等的）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">IsPopOrder</span>(<span class="params">pushV, popV</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!pushV.length || !popV.length) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> temp = [];</span><br><span class="line">    <span class="keyword">var</span> popIndex = <span class="number">0</span>;;</span><br><span class="line">    <span class="keyword">var</span> len = pushV.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        temp.push(pushV[i]);</span><br><span class="line">        <span class="keyword">while</span> (temp.length &amp;&amp; temp[temp.length - <span class="number">1</span>] === popV[popIndex]) &#123;</span><br><span class="line">            temp.pop();</span><br><span class="line">            popIndex++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> temp.length === <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>22.<br>从上往下打印出二叉树的每个节点，同层节点从左至右打印。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">IsPopOrder</span>(<span class="params">pushV, popV</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!pushV.length || !popV.length) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> temp = [];</span><br><span class="line">    <span class="keyword">var</span> popIndex = <span class="number">0</span>;;</span><br><span class="line">    <span class="keyword">var</span> len = pushV.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        temp.push(pushV[i]);</span><br><span class="line">        <span class="keyword">while</span> (temp.length &amp;&amp; temp[temp.length - <span class="number">1</span>] === popV[popIndex]) &#123;</span><br><span class="line">            temp.pop();</span><br><span class="line">            popIndex++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> temp.length === <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>23.<br>输入一颗二叉树和一个整数，打印出二叉树中结点值的和为输入整数的所有路径。路径定义为从树的根结点开始往下一直到叶结点所经过的结点形成一条路径。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">IsPopOrder</span>(<span class="params">pushV, popV</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!pushV.length || !popV.length) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> temp = [];</span><br><span class="line">    <span class="keyword">var</span> popIndex = <span class="number">0</span>;;</span><br><span class="line">    <span class="keyword">var</span> len = pushV.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        temp.push(pushV[i]);</span><br><span class="line">        <span class="keyword">while</span> (temp.length &amp;&amp; temp[temp.length - <span class="number">1</span>] === popV[popIndex]) &#123;</span><br><span class="line">            temp.pop();</span><br><span class="line">            popIndex++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> temp.length === <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>24.<br>输入一个复杂链表（每个节点中有节点值，以及两个指针，一个指向下一个节点，另一个特殊指针指向任意一个节点），返回结果为复制后复杂链表的head。（注意，输出结果中请不要返回参数中的节点引用，否则判题程序会直接返回空）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">IsPopOrder</span>(<span class="params">pushV, popV</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!pushV.length || !popV.length) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> temp = [];</span><br><span class="line">    <span class="keyword">var</span> popIndex = <span class="number">0</span>;;</span><br><span class="line">    <span class="keyword">var</span> len = pushV.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        temp.push(pushV[i]);</span><br><span class="line">        <span class="keyword">while</span> (temp.length &amp;&amp; temp[temp.length - <span class="number">1</span>] === popV[popIndex]) &#123;</span><br><span class="line">            temp.pop();</span><br><span class="line">            popIndex++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> temp.length === <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>25.<br>输入一棵二叉搜索树，将该二叉搜索树转换成一个排序的双向链表。要求不能创建任何新的结点，只能调整树中结点指针的指向。</p>
<blockquote>
<p>将左子树构成双向链表，返回的是左子树的尾结点，将其连接到root的左边；<br>将右子树构成双向链表，将其追加到root结点之后，并返回尾结点；<br>向左遍历返回的链表至头结点处，即为所求双向链表的首结点。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Convert</span>(<span class="params">pRootOfTree</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!pRootOfTree) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> lastNode = <span class="literal">null</span>;</span><br><span class="line">    lastNode = ConvertNode(pRootOfTree);</span><br><span class="line">    <span class="keyword">var</span> head = lastNode;</span><br><span class="line">    <span class="keyword">while</span> (head &amp;&amp; head.left) &#123;</span><br><span class="line">        head = head.left;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ConvertNode</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!node) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (node.left) &#123;</span><br><span class="line">            lastNode = ConvertNode(node.left);</span><br><span class="line">        &#125;</span><br><span class="line">        node.left = lastNode;</span><br><span class="line">        <span class="keyword">if</span> (lastNode) &#123;</span><br><span class="line">            lastNode.right = node;</span><br><span class="line">        &#125;</span><br><span class="line">        lastNode = node;</span><br><span class="line">        <span class="keyword">if</span> (node.right) &#123;</span><br><span class="line">            lastNode = ConvertNode(node.right);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lastNode;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">javascript</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="../../2017/12/27/剑指offer-JavaScript版I/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-30-seconds-of-code" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="../../2017/12/25/30-seconds-of-code/">30 seconds of code</a>
    </h1>
  

        
        <a href="../../2017/12/25/30-seconds-of-code/" class="archive-article-date">
  	<time datetime="2017-12-25T15:24:11.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-12-25</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Curated collection of useful Javascript snippets that you can understand in 30 seconds or less.</p>
</blockquote>
<h2 id="table-of-contents"><a href="#table-of-contents" class="headerlink" title="table-of-contents"></a>table-of-contents</h2><h3 id="Adapter"><a href="#Adapter" class="headerlink" title="Adapter"></a>Adapter</h3><ul>
<li><a href="#call"><code>call</code></a></li>
<li><a href="#collectinto"><code>collectInto</code></a></li>
<li><a href="#flip"><code>flip</code></a></li>
<li><a href="#pipefunctions"><code>pipeFunctions</code></a></li>
<li><a href="#promisify"><code>promisify</code></a></li>
<li><a href="#spreadover"><code>spreadOver</code></a></li>
</ul>
<h3 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h3><ul>
<li><a href="#arraygcd"><code>arrayGcd</code></a></li>
<li><a href="#arraylcm"><code>arrayLcm</code></a></li>
<li><a href="#arraymax"><code>arrayMax</code></a></li>
<li><a href="#arraymin"><code>arrayMin</code></a></li>
<li><a href="#chunk"><code>chunk</code></a></li>
<li><a href="#compact"><code>compact</code></a></li>
<li><a href="#countoccurrences"><code>countOccurrences</code></a></li>
<li><a href="#deepflatten"><code>deepFlatten</code></a></li>
<li><a href="#difference"><code>difference</code></a></li>
<li><a href="#differencewith"><code>differenceWith</code></a></li>
<li><a href="#distinctvaluesofarray"><code>distinctValuesOfArray</code></a></li>
<li><a href="#dropelements"><code>dropElements</code></a></li>
<li><a href="#dropright"><code>dropRight</code></a></li>
<li><a href="#everynth"><code>everyNth</code></a></li>
<li><a href="#filternonunique"><code>filterNonUnique</code></a></li>
<li><a href="#flatten"><code>flatten</code></a></li>
<li><a href="#flattendepth"><code>flattenDepth</code></a></li>
<li><a href="#groupby"><code>groupBy</code></a></li>
<li><a href="#head"><code>head</code></a></li>
<li><a href="#initial"><code>initial</code></a></li>
<li><a href="#initialize2darray"><code>initialize2DArray</code></a></li>
<li><a href="#initializearraywithrange"><code>initializeArrayWithRange</code></a></li>
<li><a href="#initializearraywithvalues"><code>initializeArrayWithValues</code></a></li>
<li><a href="#intersection"><code>intersection</code></a></li>
<li><a href="#last"><code>last</code></a></li>
<li><a href="#mapobject"><code>mapObject</code></a></li>
<li><a href="#nthelement"><code>nthElement</code></a></li>
<li><a href="#pick"><code>pick</code></a></li>
<li><a href="#pull"><code>pull</code></a></li>
<li><a href="#pullatindex"><code>pullAtIndex</code></a></li>
<li><a href="#pullatvalue"><code>pullAtValue</code></a></li>
<li><a href="#remove"><code>remove</code></a></li>
<li><a href="#sample"><code>sample</code></a></li>
<li><a href="#shuffle"><code>shuffle</code></a></li>
<li><a href="#similarity"><code>similarity</code></a></li>
<li><a href="#symmetricdifference"><code>symmetricDifference</code></a></li>
<li><a href="#tail"><code>tail</code></a></li>
<li><a href="#take"><code>take</code></a></li>
<li><a href="#takeright"><code>takeRight</code></a></li>
<li><a href="#union"><code>union</code></a></li>
<li><a href="#without"><code>without</code></a></li>
<li><a href="#zip"><code>zip</code></a></li>
<li><a href="#zipobject"><code>zipObject</code></a></li>
</ul>
<h3 id="Browser"><a href="#Browser" class="headerlink" title="Browser"></a>Browser</h3><ul>
<li><a href="#arraytohtmllist"><code>arrayToHtmlList</code></a></li>
<li><a href="#bottomvisible"><code>bottomVisible</code></a></li>
<li><a href="#currenturl"><code>currentURL</code></a></li>
<li><a href="#detectdevicetype"><code>detectDeviceType</code></a></li>
<li><a href="#elementisvisibleinviewport"><code>elementIsVisibleInViewport</code></a></li>
<li><a href="#getscrollposition"><code>getScrollPosition</code></a></li>
<li><a href="#geturlparameters"><code>getURLParameters</code></a></li>
<li><a href="#httpsredirect"><code>httpsRedirect</code></a></li>
<li><a href="#redirect"><code>redirect</code></a></li>
<li><a href="#scrolltotop"><code>scrollToTop</code></a></li>
</ul>
<h3 id="Date"><a href="#Date" class="headerlink" title="Date"></a>Date</h3><ul>
<li><a href="#getdaysdiffbetweendates"><code>getDaysDiffBetweenDates</code></a></li>
<li><a href="#jsontodate"><code>JSONToDate</code></a></li>
<li><a href="#toenglishdate"><code>toEnglishDate</code></a></li>
<li><a href="#tomorrow"><code>tomorrow</code></a></li>
</ul>
<h3 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h3><ul>
<li><a href="#chainasync"><code>chainAsync</code></a></li>
<li><a href="#compose"><code>compose</code></a></li>
<li><a href="#curry"><code>curry</code></a></li>
<li><a href="#functionname"><code>functionName</code></a></li>
<li><a href="#runpromisesinseries"><code>runPromisesInSeries</code></a></li>
<li><a href="#sleep"><code>sleep</code></a></li>
</ul>
<h3 id="Logic"><a href="#Logic" class="headerlink" title="Logic"></a>Logic</h3><ul>
<li><a href="#negate"><code>negate</code></a></li>
</ul>
<h3 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h3><ul>
<li><a href="#arrayaverage"><code>arrayAverage</code></a></li>
<li><a href="#arraysum"><code>arraySum</code></a></li>
<li><a href="#clampnumber"><code>clampNumber</code></a></li>
<li><a href="#collatz"><code>collatz</code></a></li>
<li><a href="#digitize"><code>digitize</code></a></li>
<li><a href="#distance"><code>distance</code></a></li>
<li><a href="#factorial"><code>factorial</code></a></li>
<li><a href="#fibonacci"><code>fibonacci</code></a></li>
<li><a href="#fibonaccicountuntilnum"><code>fibonacciCountUntilNum</code></a></li>
<li><a href="#fibonacciuntilnum"><code>fibonacciUntilNum</code></a></li>
<li><a href="#gcd"><code>gcd</code></a></li>
<li><a href="#hammingdistance"><code>hammingDistance</code></a></li>
<li><a href="#inrange"><code>inRange</code></a></li>
<li><a href="#isarmstrongnumber"><code>isArmstrongNumber</code></a></li>
<li><a href="#isdivisible"><code>isDivisible</code></a></li>
<li><a href="#iseven"><code>isEven</code></a></li>
<li><a href="#isprime"><code>isPrime</code></a></li>
<li><a href="#lcm"><code>lcm</code></a></li>
<li><a href="#median"><code>median</code></a></li>
<li><a href="#palindrome"><code>palindrome</code></a></li>
<li><a href="#percentile"><code>percentile</code></a></li>
<li><a href="#powerset"><code>powerset</code></a></li>
<li><a href="#primes"><code>primes</code></a></li>
<li><a href="#randomintegerinrange"><code>randomIntegerInRange</code></a></li>
<li><a href="#randomnumberinrange"><code>randomNumberInRange</code></a></li>
<li><a href="#round"><code>round</code></a></li>
<li><a href="#sdbmhashalgorithm"><code>sdbmHashAlgorithm</code></a></li>
<li><a href="#standarddeviation"><code>standardDeviation</code></a></li>
</ul>
<h3 id="Media"><a href="#Media" class="headerlink" title="Media"></a>Media</h3><ul>
<li><a href="#speechsynthesis"><code>speechSynthesis</code></a></li>
</ul>
<h3 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h3><ul>
<li><a href="#jsontofile"><code>JSONToFile</code></a></li>
<li><a href="#readfilelines"><code>readFileLines</code></a></li>
</ul>
<h3 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h3><ul>
<li><a href="#cleanobj"><code>cleanObj</code></a></li>
<li><a href="#objectfrompairs"><code>objectFromPairs</code></a></li>
<li><a href="#objecttopairs"><code>objectToPairs</code></a></li>
<li><a href="#orderby"><code>orderBy</code></a></li>
<li><a href="#select"><code>select</code></a></li>
<li><a href="#shallowclone"><code>shallowClone</code></a></li>
<li><a href="#truthcheckcollection"><code>truthCheckCollection</code></a></li>
</ul>
<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><ul>
<li><a href="#anagrams"><code>anagrams</code></a></li>
<li><a href="#capitalize"><code>capitalize</code></a></li>
<li><a href="#capitalizeeveryword"><code>capitalizeEveryWord</code></a></li>
<li><a href="#countvowels"><code>countVowels</code></a></li>
<li><a href="#escaperegexp"><code>escapeRegExp</code></a></li>
<li><a href="#fromcamelcase"><code>fromCamelCase</code></a></li>
<li><a href="#repeatstring"><code>repeatString</code></a></li>
<li><a href="#reversestring"><code>reverseString</code></a></li>
<li><a href="#sortcharactersinstring"><code>sortCharactersInString</code></a></li>
<li><a href="#tocamelcase"><code>toCamelCase</code></a></li>
<li><a href="#tokebabcase"><code>toKebabCase</code></a></li>
<li><a href="#tosnakecase"><code>toSnakeCase</code></a></li>
<li><a href="#truncatestring"><code>truncateString</code></a></li>
<li><a href="#words"><code>words</code></a></li>
</ul>
<h3 id="Utility"><a href="#Utility" class="headerlink" title="Utility"></a>Utility</h3><ul>
<li><a href="#coalesce"><code>coalesce</code></a></li>
<li><a href="#coalescefactory"><code>coalesceFactory</code></a></li>
<li><a href="#extendhex"><code>extendHex</code></a></li>
<li><a href="#gettype"><code>getType</code></a></li>
<li><a href="#hextorgb"><code>hexToRGB</code></a></li>
<li><a href="#isarray"><code>isArray</code></a></li>
<li><a href="#isboolean"><code>isBoolean</code></a></li>
<li><a href="#isfunction"><code>isFunction</code></a></li>
<li><a href="#isnumber"><code>isNumber</code></a></li>
<li><a href="#isstring"><code>isString</code></a></li>
<li><a href="#issymbol"><code>isSymbol</code></a></li>
<li><a href="#randomhexcolor"><code>randomHexColor</code></a></li>
<li><a href="#rgbtohex"><code>RGBToHex</code></a></li>
<li><a href="#timetaken"><code>timeTaken</code></a></li>
<li><a href="#todecimalmark"><code>toDecimalMark</code></a></li>
<li><a href="#toordinalsuffix"><code>toOrdinalSuffix</code></a></li>
<li><a href="#uuidgenerator"><code>UUIDGenerator</code></a></li>
<li><a href="#validatenumber"><code>validateNumber</code></a></li>
</ul>
<h2 id="Adapter-1"><a href="#Adapter-1" class="headerlink" title="Adapter"></a>Adapter</h2><h3 id="call"><a href="#call" class="headerlink" title="call"></a>call</h3><p>Given a key and a set of arguments, call them when given a context. Primarily useful in composition.</p>
<p>Use a closure to call a stored key with stored arguments.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> call = <span class="function">(<span class="params">key, ...args</span>) =&gt;</span> context =&gt; context[ key ](...args);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Promise.resolve( [ 1, 2, 3 ] ).then( call('map', x =&gt; 2 * x ) ).then( console.log ) //[ 2, 4, 6 ]</span></span><br><span class="line"><span class="comment">const map = call.bind(null, 'map')</span></span><br><span class="line"><span class="comment">Promise.resolve( [ 1, 2, 3 ] ).then( map( x =&gt; 2 * x ) ).then( console.log ) //[ 2, 4, 6 ]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="collectInto"><a href="#collectInto" class="headerlink" title="collectInto"></a>collectInto</h3><p>Changes a function that accepts an array into a variadic function.</p>
<p>Given a function, return a closure that collects all inputs into an array-accepting function.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> collectInto = <span class="function"><span class="params">fn</span> =&gt;</span> (...args) =&gt; fn(args);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">const Pall = collectInto( Promise.all.bind(Promise) )</span></span><br><span class="line"><span class="comment">let p1 = Promise.resolve(1)</span></span><br><span class="line"><span class="comment">let p2 = Promise.resolve(2)</span></span><br><span class="line"><span class="comment">let p3 = new Promise((resolve) =&gt; setTimeout(resolve,2000,3))</span></span><br><span class="line"><span class="comment">Pall(p1, p2, p3).then(console.log)</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="flip"><a href="#flip" class="headerlink" title="flip"></a>flip</h3><p>Flip takes a function as an argument, then makes the first argument the last</p>
<p>Return a closure that takes variadic inputs, and splices the last argument to make it the first argument before applying the rest.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flip = <span class="function"><span class="params">fn</span> =&gt;</span> (...args) =&gt; fn(args.pop(), ...args);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">let a = &#123;name: 'John Smith'&#125;</span></span><br><span class="line"><span class="comment">let b = &#123;&#125;</span></span><br><span class="line"><span class="comment">const mergeFrom = flip(Object.assign)</span></span><br><span class="line"><span class="comment">let mergePerson = mergeFrom.bind(null, a)</span></span><br><span class="line"><span class="comment">mergePerson(b) // == b</span></span><br><span class="line"><span class="comment">b = &#123;&#125;</span></span><br><span class="line"><span class="comment">Object.assign(b, a) // == b</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="pipeFunctions"><a href="#pipeFunctions" class="headerlink" title="pipeFunctions"></a>pipeFunctions</h3><p>Performs left-to-right function composition.</p>
<p>Use <code>Array.reduce()</code> with the spread operator (<code>...</code>) to perform left-to-right function composition.<br>The first (leftmost) function can accept one or more arguments; the remaining functions must be unary.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pipeFunctions = <span class="function">(<span class="params">...fns</span>) =&gt;</span> fns.reduce(<span class="function">(<span class="params">f, g</span>) =&gt;</span> (...args) =&gt; g(f(...args)));</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">const add5 = x =&gt; x + 5</span></span><br><span class="line"><span class="comment">const multiply = (x, y) =&gt; x * y</span></span><br><span class="line"><span class="comment">const multiplyAndAdd5 = pipeFunctions(multiply, add5)</span></span><br><span class="line"><span class="comment">multiplyAndAdd5(5, 2) -&gt; 15</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="promisify"><a href="#promisify" class="headerlink" title="promisify"></a>promisify</h3><p>Converts an asynchronous function to return a promise.</p>
<p>Use currying to return a function returning a <code>Promise</code> that calls the original function.<br>Use the <code>...rest</code> operator to pass in all the parameters.</p>
<p><em>In Node 8+, you can use <a href="https://nodejs.org/api/util.html#util_util_promisify_original" target="_blank" rel="noopener"><code>util.promisify</code></a></em></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promisify = <span class="function"><span class="params">func</span> =&gt;</span></span><br><span class="line">  (...args) =&gt;</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span></span><br><span class="line">      func(...args, (err, result) =&gt;</span><br><span class="line">        err ? reject(err) : resolve(result))</span><br><span class="line">    );</span><br><span class="line"><span class="comment">// const delay = promisify((d, cb) =&gt; setTimeout(cb, d))</span></span><br><span class="line"><span class="comment">// delay(2000).then(() =&gt; console.log('Hi!')) -&gt; Promise resolves after 2s</span></span><br></pre></td></tr></table></figure>
<p><a href="#Table of Contents">⬆ back to top</a></p>
<h3 id="spreadOver"><a href="#spreadOver" class="headerlink" title="spreadOver"></a>spreadOver</h3><p>Takes a variadic function and returns a closure that accepts an array of arguments to map to the inputs of the function.</p>
<p>Use closures and the spread operator (<code>...</code>) to map the array of arguments to the inputs of the function.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> spreadOver = <span class="function"><span class="params">fn</span> =&gt;</span> argsArr =&gt; fn(...argsArr);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">const arrayMax = spreadOver(Math.max)</span></span><br><span class="line"><span class="comment">arrayMax([1,2,3]) // -&gt; 3</span></span><br><span class="line"><span class="comment">arrayMax([1,2,4]) // -&gt; 4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h2 id="Array-1"><a href="#Array-1" class="headerlink" title="Array"></a>Array</h2><h3 id="arrayGcd"><a href="#arrayGcd" class="headerlink" title="arrayGcd"></a>arrayGcd</h3><p>Calculates the greatest common denominator (gcd) of an array of numbers.</p>
<p>Use <code>Array.reduce()</code> and the <code>gcd</code> formula (uses recursion) to calculate the greatest common denominator of an array of numbers.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayGcd = <span class="function"><span class="params">arr</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> gcd = <span class="function">(<span class="params">x, y</span>) =&gt;</span> !y ? x : gcd(y, x % y);</span><br><span class="line">  <span class="keyword">return</span> arr.reduce(<span class="function">(<span class="params">a, b</span>) =&gt;</span> gcd(a, b));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// arrayGcd([1,2,3,4,5]) -&gt; 1</span></span><br><span class="line"><span class="comment">// arrayGcd([4,8,12]) -&gt; 4</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="arrayLcm"><a href="#arrayLcm" class="headerlink" title="arrayLcm"></a>arrayLcm</h3><p>Calculates the lowest common multiple (lcm) of an array of numbers.</p>
<p>Use <code>Array.reduce()</code> and the <code>lcm</code> formula (uses recursion) to calculate the lowest common multiple of an array of numbers.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayLcm = <span class="function"><span class="params">arr</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> gcd = <span class="function">(<span class="params">x, y</span>) =&gt;</span> !y ? x : gcd(y, x % y);</span><br><span class="line">  <span class="keyword">const</span> lcm = <span class="function">(<span class="params">x, y</span>) =&gt;</span> (x * y) / gcd(x, y);</span><br><span class="line">  <span class="keyword">return</span> arr.reduce(<span class="function">(<span class="params">a, b</span>) =&gt;</span> lcm(a, b));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// arrayLcm([1,2,3,4,5]) -&gt; 60</span></span><br><span class="line"><span class="comment">// arrayLcm([4,8,12]) -&gt; 24</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="arrayMax"><a href="#arrayMax" class="headerlink" title="arrayMax"></a>arrayMax</h3><p>Returns the maximum value in an array.</p>
<p>Use <code>Math.max()</code> combined with the spread operator (<code>...</code>) to get the maximum value in the array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayMax = <span class="function"><span class="params">arr</span> =&gt;</span> <span class="built_in">Math</span>.max(...arr);</span><br><span class="line"><span class="comment">// arrayMax([10, 1, 5]) -&gt; 10</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="arrayMin"><a href="#arrayMin" class="headerlink" title="arrayMin"></a>arrayMin</h3><p>Returns the minimum value in an array.</p>
<p>Use <code>Math.min()</code> combined with the spread operator (<code>...</code>) to get the minimum value in the array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayMin = <span class="function"><span class="params">arr</span> =&gt;</span> <span class="built_in">Math</span>.min(...arr);</span><br><span class="line"><span class="comment">// arrayMin([10, 1, 5]) -&gt; 1</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="chunk"><a href="#chunk" class="headerlink" title="chunk"></a>chunk</h3><p>Chunks an array into smaller arrays of a specified size.</p>
<p>Use <code>Array.from()</code> to create a new array, that fits the number of chunks that will be produced.<br>Use <code>Array.slice()</code> to map each element of the new array to a chunk the length of <code>size</code>.<br>If the original array can’t be split evenly, the final chunk will contain the remaining elements.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> chunk = <span class="function">(<span class="params">arr, size</span>) =&gt;</span></span><br><span class="line">  <span class="built_in">Array</span>.from(&#123;<span class="attr">length</span>: <span class="built_in">Math</span>.ceil(arr.length / size)&#125;, (v, i) =&gt; arr.slice(i * size, i * size + size));</span><br><span class="line"><span class="comment">// chunk([1,2,3,4,5], 2) -&gt; [[1,2],[3,4],[5]]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="compact"><a href="#compact" class="headerlink" title="compact"></a>compact</h3><p>Removes falsey values from an array.</p>
<p>Use <code>Array.filter()</code> to filter out falsey values (<code>false</code>, <code>null</code>, <code>0</code>, <code>&quot;&quot;</code>, <code>undefined</code>, and <code>NaN</code>).</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> compact = <span class="function"><span class="params">arr</span> =&gt;</span> arr.filter(<span class="built_in">Boolean</span>);</span><br><span class="line"><span class="comment">// compact([0, 1, false, 2, '', 3, 'a', 'e'*23, NaN, 's', 34]) -&gt; [ 1, 2, 3, 'a', 's', 34 ]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="countOccurrences"><a href="#countOccurrences" class="headerlink" title="countOccurrences"></a>countOccurrences</h3><p>Counts the occurrences of a value in an array.</p>
<p>Use <code>Array.reduce()</code> to increment a counter each time you encounter the specific value inside the array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> countOccurrences = <span class="function">(<span class="params">arr, value</span>) =&gt;</span> arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> v === value ? a + <span class="number">1</span> : a + <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// countOccurrences([1,1,2,1,2,3], 1) -&gt; 3</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="deepFlatten"><a href="#deepFlatten" class="headerlink" title="deepFlatten"></a>deepFlatten</h3><p>Deep flattens an array.</p>
<p>Use recursion.<br>Use <code>Array.concat()</code> with an empty array (<code>[]</code>) and the spread operator (<code>...</code>) to flatten an array.<br>Recursively flatten each element that is an array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> deepFlatten = <span class="function"><span class="params">arr</span> =&gt;</span> [].concat(...arr.map(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">Array</span>.isArray(v) ? deepFlatten(v) : v));</span><br><span class="line"><span class="comment">// deepFlatten([1,[2],[[3],4],5]) -&gt; [1,2,3,4,5]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="difference"><a href="#difference" class="headerlink" title="difference"></a>difference</h3><p>Returns the difference between two arrays.</p>
<p>Create a <code>Set</code> from <code>b</code>, then use <code>Array.filter()</code> on <code>a</code> to only keep values not contained in <code>b</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> difference = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123; <span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>(b); <span class="keyword">return</span> a.filter(<span class="function"><span class="params">x</span> =&gt;</span> !s.has(x)); &#125;;</span><br><span class="line"><span class="comment">// difference([1,2,3], [1,2,4]) -&gt; [3]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="differenceWith"><a href="#differenceWith" class="headerlink" title="differenceWith"></a>differenceWith</h3><p>Filters out all values from an array for which the comparator function does not return <code>true</code>.</p>
<p>Use <code>Array.filter()</code> and <code>Array.find()</code> to find the appropriate values.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> differenceWith = <span class="function">(<span class="params">arr, val, comp</span>) =&gt;</span> arr.filter(<span class="function"><span class="params">a</span> =&gt;</span> !val.find(<span class="function"><span class="params">b</span> =&gt;</span> comp(a, b)));</span><br><span class="line"><span class="comment">// differenceWith([1, 1.2, 1.5, 3], [1.9, 3], (a,b) =&gt; Math.round(a) == Math.round(b)) -&gt; [1, 1.2]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="distinctValuesOfArray"><a href="#distinctValuesOfArray" class="headerlink" title="distinctValuesOfArray"></a>distinctValuesOfArray</h3><p>Returns all the distinct values of an array.</p>
<p>Use ES6 <code>Set</code> and the <code>...rest</code> operator to discard all duplicated values.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> distinctValuesOfArray = <span class="function"><span class="params">arr</span> =&gt;</span> [...new <span class="built_in">Set</span>(arr)];</span><br><span class="line"><span class="comment">// distinctValuesOfArray([1,2,2,3,4,4,5]) -&gt; [1,2,3,4,5]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="dropElements"><a href="#dropElements" class="headerlink" title="dropElements"></a>dropElements</h3><p>Removes elements in an array until the passed function returns <code>true</code>. Returns the remaining elements in the array.</p>
<p>Loop through the array, using <code>Array.slice()</code> to drop the first element of the array until the returned value from the function is <code>true</code>.<br>Returns the remaining elements.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dropElements = <span class="function">(<span class="params">arr, func</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">while</span> (arr.length &gt; <span class="number">0</span> &amp;&amp; !func(arr[<span class="number">0</span>])) arr = arr.slice(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// dropElements([1, 2, 3, 4], n =&gt; n &gt;= 3) -&gt; [3,4]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="dropRight"><a href="#dropRight" class="headerlink" title="dropRight"></a>dropRight</h3><p>Returns a new array with <code>n</code> elements removed from the right.</p>
<p>Use <code>Array.slice()</code> to slice the remove the specified number of elements from the right.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dropRight = <span class="function">(<span class="params">arr, n = <span class="number">1</span></span>) =&gt;</span> arr.slice(<span class="number">0</span>, -n);</span><br><span class="line"><span class="comment">// dropRight([1,2,3]) -&gt; [1,2]</span></span><br><span class="line"><span class="comment">// dropRight([1,2,3], 2) -&gt; [1]</span></span><br><span class="line"><span class="comment">// dropRight([1,2,3], 42) -&gt; []</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="everyNth"><a href="#everyNth" class="headerlink" title="everyNth"></a>everyNth</h3><p>Returns every nth element in an array.</p>
<p>Use <code>Array.filter()</code> to create a new array that contains every nth element of a given array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> everyNth = <span class="function">(<span class="params">arr, nth</span>) =&gt;</span> arr.filter(<span class="function">(<span class="params">e, i</span>) =&gt;</span> i % nth === nth - <span class="number">1</span>);</span><br><span class="line"><span class="comment">// everyNth([1,2,3,4,5,6], 2) -&gt; [ 2, 4, 6 ]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="filterNonUnique"><a href="#filterNonUnique" class="headerlink" title="filterNonUnique"></a>filterNonUnique</h3><p>Filters out the non-unique values in an array.</p>
<p>Use <code>Array.filter()</code> for an array containing only the unique values.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> filterNonUnique = <span class="function"><span class="params">arr</span> =&gt;</span> arr.filter(<span class="function"><span class="params">i</span> =&gt;</span> arr.indexOf(i) === arr.lastIndexOf(i));</span><br><span class="line"><span class="comment">// filterNonUnique([1,2,2,3,4,4,5]) -&gt; [1,3,5]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="flatten"><a href="#flatten" class="headerlink" title="flatten"></a>flatten</h3><p>Flattens an array.</p>
<p>Use a new array and concatenate it with the spread input array causing a shallow denesting of any contained arrays.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flatten = <span class="function"><span class="params">arr</span> =&gt;</span> [ ].concat(...arr);</span><br><span class="line"><span class="comment">// flatten([1,[2],3,4]) -&gt; [1,2,3,4]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="flattenDepth"><a href="#flattenDepth" class="headerlink" title="flattenDepth"></a>flattenDepth</h3><p>Flattens an array up to the specified depth.</p>
<p>Use recursion, decrementing <code>depth</code> by 1 for each level of depth.<br>Use <code>Array.reduce()</code> and <code>Array.concat()</code> to merge elements or arrays.<br>Base case, for <code>depth</code> equal to <code>1</code> stops recursion.<br>Omit the second element, <code>depth</code> to flatten only to a depth of <code>1</code> (single flatten).</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flattenDepth = <span class="function">(<span class="params">arr, depth = <span class="number">1</span></span>) =&gt;</span></span><br><span class="line">  depth != <span class="number">1</span> ? arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(<span class="built_in">Array</span>.isArray(v) ? flattenDepth(v, depth - <span class="number">1</span>) : v), [])</span><br><span class="line">  : arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(v), []);</span><br><span class="line"><span class="comment">// flattenDepth([1,[2],[[[3],4],5]], 2) -&gt; [1,2,[3],4,5]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="groupBy"><a href="#groupBy" class="headerlink" title="groupBy"></a>groupBy</h3><p>Groups the elements of an array based on the given function.</p>
<p>Use <code>Array.map()</code> to map the values of an array to a function or property name.<br>Use <code>Array.reduce()</code> to create an object, where the keys are produced from the mapped results.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> groupBy = <span class="function">(<span class="params">arr, func</span>) =&gt;</span></span><br><span class="line">  arr.map(<span class="keyword">typeof</span> func === <span class="string">'function'</span> ? func : <span class="function"><span class="params">val</span> =&gt;</span> val[func])</span><br><span class="line">    .reduce(<span class="function">(<span class="params">acc, val, i</span>) =&gt;</span> &#123; acc[val] = (acc[val] || []).concat(arr[i]); <span class="keyword">return</span> acc; &#125;, &#123;&#125;);</span><br><span class="line"><span class="comment">// groupBy([6.1, 4.2, 6.3], Math.floor) -&gt; &#123;4: [4.2], 6: [6.1, 6.3]&#125;</span></span><br><span class="line"><span class="comment">// groupBy(['one', 'two', 'three'], 'length') -&gt; &#123;3: ['one', 'two'], 5: ['three']&#125;</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="head"><a href="#head" class="headerlink" title="head"></a>head</h3><p>Returns the head of a list.</p>
<p>Use <code>arr[0]</code> to return the first element of the passed array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> head = <span class="function"><span class="params">arr</span> =&gt;</span> arr[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// head([1,2,3]) -&gt; 1</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="initial"><a href="#initial" class="headerlink" title="initial"></a>initial</h3><p>Returns all the elements of an array except the last one.</p>
<p>Use <code>arr.slice(0,-1)</code> to return all but the last element of the array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initial = <span class="function"><span class="params">arr</span> =&gt;</span> arr.slice(<span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line"><span class="comment">// initial([1,2,3]) -&gt; [1,2]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="initialize2DArray"><a href="#initialize2DArray" class="headerlink" title="initialize2DArray"></a>initialize2DArray</h3><p>Initializes a 2D array of given width and height and value.</p>
<p>Use <code>Array.map()</code> to generate h rows where each is a new array of size w initialize with value. If the value is not provided, default to <code>null</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initialize2DArray = <span class="function">(<span class="params">w, h, val = <span class="literal">null</span></span>) =&gt;</span> <span class="built_in">Array</span>(h).fill().map(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">Array</span>(w).fill(val));</span><br><span class="line"><span class="comment">// initializeArrayWithRange(2, 2, 0) -&gt; [[0,0], [0,0]]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="initializeArrayWithRange"><a href="#initializeArrayWithRange" class="headerlink" title="initializeArrayWithRange"></a>initializeArrayWithRange</h3><p>Initializes an array containing the numbers in the specified range where <code>start</code> and <code>end</code> are inclusive.</p>
<p>Use <code>Array((end + 1) - start)</code> to create an array of the desired length, <code>Array.map()</code> to fill with the desired values in a range.<br>You can omit <code>start</code> to use a default value of <code>0</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initializeArrayWithRange = <span class="function">(<span class="params">end, start = <span class="number">0</span></span>) =&gt;</span></span><br><span class="line">  <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: <span class="function">(<span class="params">end + <span class="number">1</span></span>) - <span class="params">start</span> &#125;).<span class="params">map</span>(<span class="params">(v, i</span>) =&gt;</span> i + start);</span><br><span class="line"><span class="comment">// initializeArrayWithRange(5) -&gt; [0,1,2,3,4,5]</span></span><br><span class="line"><span class="comment">// initializeArrayWithRange(7, 3) -&gt; [3,4,5,6,7]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="initializeArrayWithValues"><a href="#initializeArrayWithValues" class="headerlink" title="initializeArrayWithValues"></a>initializeArrayWithValues</h3><p>Initializes and fills an array with the specified values.</p>
<p>Use <code>Array(n)</code> to create an array of the desired length, <code>fill(v)</code> to fill it with the desired values.<br>You can omit <code>value</code> to use a default value of <code>0</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initializeArrayWithValues = <span class="function">(<span class="params">n, value = <span class="number">0</span></span>) =&gt;</span> <span class="built_in">Array</span>(n).fill(value);</span><br><span class="line"><span class="comment">// initializeArrayWithValues(5, 2) -&gt; [2,2,2,2,2]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="intersection"><a href="#intersection" class="headerlink" title="intersection"></a>intersection</h3><p>Returns a list of elements that exist in both arrays.</p>
<p>Create a <code>Set</code> from <code>b</code>, then use <code>Array.filter()</code> on <code>a</code> to only keep values contained in <code>b</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> intersection = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123; <span class="keyword">const</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>(b); <span class="keyword">return</span> a.filter(<span class="function"><span class="params">x</span> =&gt;</span> s.has(x)); &#125;;</span><br><span class="line"><span class="comment">// intersection([1,2,3], [4,3,2]) -&gt; [2,3]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="last"><a href="#last" class="headerlink" title="last"></a>last</h3><p>Returns the last element in an array.</p>
<p>Use <code>arr.length - 1</code> to compute the index of the last element of the given array and returning it.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> last = <span class="function"><span class="params">arr</span> =&gt;</span> arr[arr.length - <span class="number">1</span>];</span><br><span class="line"><span class="comment">// last([1,2,3]) -&gt; 3</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="mapObject"><a href="#mapObject" class="headerlink" title="mapObject"></a>mapObject</h3><p>Maps the values of an array to an object using a function, where the key-value pairs consist of the original value as the key and the mapped value.</p>
<p>Use an anonymous inner function scope to declare an undefined memory space, using closures to store a return value. Use a new <code>Array</code> to store the array with a map of the function over its data set and a comma operator to return a second step, without needing to move from one context to another (due to closures and order of operations).</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapObject = <span class="function">(<span class="params">arr, fn</span>) =&gt;</span></span><br><span class="line">  (<span class="function"><span class="params">a</span> =&gt;</span> (a = [arr, arr.map(fn)], a[<span class="number">0</span>].reduce(<span class="function">(<span class="params">acc, val, ind</span>) =&gt;</span> (acc[val] = a[<span class="number">1</span>][ind], acc), &#123;&#125;)))();</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">const squareIt = arr =&gt; mapObject(arr, a =&gt; a*a)</span></span><br><span class="line"><span class="comment">squareIt([1,2,3]) // &#123; 1: 1, 2: 4, 3: 9 &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="nthElement"><a href="#nthElement" class="headerlink" title="nthElement"></a>nthElement</h3><p>Returns the nth element of an array.</p>
<p>Use <code>Array.slice()</code> to get an array containing the nth element at the first place.<br>If the index is out of bounds, return <code>[]</code>.<br>Omit the second argument, <code>n</code>, to get the first element of the array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> nthElement = <span class="function">(<span class="params">arr, n = <span class="number">0</span></span>) =&gt;</span> (n &gt; <span class="number">0</span> ? arr.slice(n, n + <span class="number">1</span>) : arr.slice(n))[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// nthElement(['a','b','c'],1) -&gt; 'b'</span></span><br><span class="line"><span class="comment">// nthElement(['a','b','b'],-3) -&gt; 'a'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="pick"><a href="#pick" class="headerlink" title="pick"></a>pick</h3><p>Picks the key-value pairs corresponding to the given keys from an object.</p>
<p>Use <code>Array.reduce()</code> to convert the filtered/picked keys back to an object with the corresponding key-value pair if the key exists in the obj.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pick = <span class="function">(<span class="params">obj, arr</span>) =&gt;</span></span><br><span class="line">  arr.reduce(<span class="function">(<span class="params">acc, curr</span>) =&gt;</span> (curr <span class="keyword">in</span> obj &amp;&amp; (acc[curr] = obj[curr]), acc), &#123;&#125;);</span><br><span class="line"><span class="comment">// pick(&#123; 'a': 1, 'b': '2', 'c': 3 &#125;, ['a', 'c']) -&gt; &#123; 'a': 1, 'c': 3 &#125;</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h3><p>Mutates the original array to filter out the values specified.</p>
<p>Use <code>Array.filter()</code> and <code>Array.includes()</code> to pull out the values that are not needed.<br>Use <code>Array.length = 0</code> to mutate the passed in an array by resetting it’s length to zero and <code>Array.push()</code> to re-populate it with only the pulled values.</p>
<p><em>(For a snippet that does not mutate the original array see <a href="#without"><code>without</code></a>)</em></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pull = <span class="function">(<span class="params">arr, ...args</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> argState = <span class="built_in">Array</span>.isArray(args[<span class="number">0</span>]) ? args[<span class="number">0</span>] : args;</span><br><span class="line">  <span class="keyword">let</span> pulled = arr.filter(<span class="function">(<span class="params">v, i</span>) =&gt;</span> !argState.includes(v));</span><br><span class="line">  arr.length = <span class="number">0</span>;</span><br><span class="line">  pulled.forEach(<span class="function"><span class="params">v</span> =&gt;</span> arr.push(v));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// let myArray1 = ['a', 'b', 'c', 'a', 'b', 'c'];</span></span><br><span class="line"><span class="comment">// pull(myArray1, 'a', 'c');</span></span><br><span class="line"><span class="comment">// console.log(myArray1) -&gt; [ 'b', 'b' ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// let myArray2 = ['a', 'b', 'c', 'a', 'b', 'c'];</span></span><br><span class="line"><span class="comment">// pull(myArray2, ['a', 'c']);</span></span><br><span class="line"><span class="comment">// console.log(myArray2) -&gt; [ 'b', 'b' ]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="pullAtIndex"><a href="#pullAtIndex" class="headerlink" title="pullAtIndex"></a>pullAtIndex</h3><p>Mutates the original array to filter out the values at the specified indexes.</p>
<p>Use <code>Array.filter()</code> and <code>Array.includes()</code> to pull out the values that are not needed.<br>Use <code>Array.length = 0</code> to mutate the passed in an array by resetting it’s length to zero and <code>Array.push()</code> to re-populate it with only the pulled values.<br>Use <code>Array.push()</code> to keep track of pulled values</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pullAtIndex = <span class="function">(<span class="params">arr, pullArr</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> removed = [];</span><br><span class="line">  <span class="keyword">let</span> pulled = arr.map(<span class="function">(<span class="params">v, i</span>) =&gt;</span> pullArr.includes(i) ? removed.push(v) : v)</span><br><span class="line">                  .filter(<span class="function">(<span class="params">v, i</span>) =&gt;</span> !pullArr.includes(i));</span><br><span class="line">  arr.length = <span class="number">0</span>;</span><br><span class="line">  pulled.forEach(<span class="function"><span class="params">v</span> =&gt;</span> arr.push(v));</span><br><span class="line">  <span class="keyword">return</span> removed;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// let myArray = ['a', 'b', 'c', 'd'];</span></span><br><span class="line"><span class="comment">// let pulled = pullAtIndex(myArray, [1, 3]);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(myArray); -&gt; [ 'a', 'c' ]</span></span><br><span class="line"><span class="comment">// console.log(pulled); -&gt; [ 'b', 'd' ]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="pullAtValue"><a href="#pullAtValue" class="headerlink" title="pullAtValue"></a>pullAtValue</h3><p>Mutates the original array to filter out the values specified. Returns the removed elements.</p>
<p>Use <code>Array.filter()</code> and <code>Array.includes()</code> to pull out the values that are not needed.<br>Use <code>Array.length = 0</code> to mutate the passed in an array by resetting it’s length to zero and <code>Array.push()</code> to re-populate it with only the pulled values.<br>Use <code>Array.push()</code> to keep track of pulled values</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pullAtValue = <span class="function">(<span class="params">arr, pullArr</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> removed = [],</span><br><span class="line">    pushToRemove = arr.forEach(<span class="function">(<span class="params">v, i</span>) =&gt;</span> pullArr.includes(v) ? removed.push(v) : v),</span><br><span class="line">    mutateTo = arr.filter(<span class="function">(<span class="params">v, i</span>) =&gt;</span> !pullArr.includes(v));</span><br><span class="line">  arr.length = <span class="number">0</span>;</span><br><span class="line">  mutateTo.forEach(<span class="function"><span class="params">v</span> =&gt;</span> arr.push(v));</span><br><span class="line">  <span class="keyword">return</span> removed;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">let myArray = ['a', 'b', 'c', 'd'];</span></span><br><span class="line"><span class="comment">let pulled = pullAtValue(myArray, ['b', 'd']);</span></span><br><span class="line"><span class="comment">console.log(myArray); -&gt; [ 'a', 'c' ]</span></span><br><span class="line"><span class="comment">console.log(pulled); -&gt; [ 'b', 'd' ]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="remove"><a href="#remove" class="headerlink" title="remove"></a>remove</h3><p>Removes elements from an array for which the given function returns <code>false</code>.</p>
<p>Use <code>Array.filter()</code> to find array elements that return truthy values and <code>Array.reduce()</code> to remove elements using <code>Array.splice()</code>.<br>The <code>func</code> is invoked with three arguments (<code>value, index, array</code>).</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> remove = <span class="function">(<span class="params">arr, func</span>) =&gt;</span></span><br><span class="line">  <span class="built_in">Array</span>.isArray(arr) ? arr.filter(func).reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> &#123;</span><br><span class="line">    arr.splice(arr.indexOf(val), <span class="number">1</span>); <span class="keyword">return</span> acc.concat(val);</span><br><span class="line">  &#125;, [])</span><br><span class="line">  : [];</span><br><span class="line"><span class="comment">// remove([1, 2, 3, 4], n =&gt; n % 2 == 0) -&gt; [2, 4]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="sample"><a href="#sample" class="headerlink" title="sample"></a>sample</h3><p>Returns a random element from an array.</p>
<p>Use <code>Math.random()</code> to generate a random number, multiply it by <code>length</code> and round it of to the nearest whole number using <code>Math.floor()</code>.<br>This method also works with strings.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sample = <span class="function"><span class="params">arr</span> =&gt;</span> arr[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * arr.length)];</span><br><span class="line"><span class="comment">// sample([3, 7, 9, 11]) -&gt; 9</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="shuffle"><a href="#shuffle" class="headerlink" title="shuffle"></a>shuffle</h3><p>Randomizes the order of the values of an array, returning a new array.</p>
<p>Uses the Fisher-Yates algoritm to reorder the elements of the array, based on the <a href="https://github.com/lodash/lodash/blob/b2ea6b1cd251796dcb5f9700c4911a7b6223920b/shuffle.js" target="_blank" rel="noopener">Lodash implementation</a>, but as a pure function.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> shuffle = <span class="function">(<span class="params">[...arr]</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> m = arr.length;</span><br><span class="line">  <span class="keyword">while</span> (m) &#123;</span><br><span class="line">    <span class="keyword">const</span> i = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * m--);</span><br><span class="line">    [arr[m], arr[i]] = [arr[i], arr[m]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// const foo = [1,2,3]</span></span><br><span class="line"><span class="comment">// shuffle(foo) -&gt; [2,3,1]</span></span><br><span class="line"><span class="comment">// console.log(foo) -&gt; [1,2,3]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="similarity"><a href="#similarity" class="headerlink" title="similarity"></a>similarity</h3><p>Returns an array of elements that appear in both arrays.</p>
<p>Use <code>filter()</code> to remove values that are not part of <code>values</code>, determined using <code>includes()</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> similarity = <span class="function">(<span class="params">arr, values</span>) =&gt;</span> arr.filter(<span class="function"><span class="params">v</span> =&gt;</span> values.includes(v));</span><br><span class="line"><span class="comment">// similarity([1,2,3], [1,2,4]) -&gt; [1,2]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="symmetricDifference"><a href="#symmetricDifference" class="headerlink" title="symmetricDifference"></a>symmetricDifference</h3><p>Returns the symmetric difference between two arrays.</p>
<p>Create a <code>Set</code> from each array, then use <code>Array.filter()</code> on each of them to only keep values not contained in the other.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> symmetricDifference = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> sA = <span class="keyword">new</span> <span class="built_in">Set</span>(a), sB = <span class="keyword">new</span> <span class="built_in">Set</span>(b);</span><br><span class="line">  <span class="keyword">return</span> [...a.filter(<span class="function"><span class="params">x</span> =&gt;</span> !sB.has(x)), ...b.filter(<span class="function"><span class="params">x</span> =&gt;</span> !sA.has(x))];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// symmetricDifference([1,2,3], [1,2,4]) -&gt; [3,4]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h3><p>Returns all elements in an array except for the first one.</p>
<p>Return <code>arr.slice(1)</code> if the array’s <code>length</code> is more than <code>1</code>, otherwise, return the whole array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tail = <span class="function"><span class="params">arr</span> =&gt;</span> arr.length &gt; <span class="number">1</span> ? arr.slice(<span class="number">1</span>) : arr;</span><br><span class="line"><span class="comment">// tail([1,2,3]) -&gt; [2,3]</span></span><br><span class="line"><span class="comment">// tail([1]) -&gt; [1]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="take"><a href="#take" class="headerlink" title="take"></a>take</h3><p>Returns an array with n elements removed from the beginning.</p>
<p>Use <code>Array.slice()</code> to create a slice of the array with <code>n</code> elements taken from the beginning.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> take = <span class="function">(<span class="params">arr, n = <span class="number">1</span></span>) =&gt;</span> arr.slice(<span class="number">0</span>, n);</span><br><span class="line"><span class="comment">// take([1, 2, 3], 5) -&gt; [1, 2, 3]</span></span><br><span class="line"><span class="comment">// take([1, 2, 3], 0) -&gt; []</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="takeRight"><a href="#takeRight" class="headerlink" title="takeRight"></a>takeRight</h3><p>Returns an array with n elements removed from the end.</p>
<p>Use <code>Array.slice()</code> to create a slice of the array with <code>n</code> elements taken from the end.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> takeRight = <span class="function">(<span class="params">arr, n = <span class="number">1</span></span>) =&gt;</span> arr.slice(arr.length - n, arr.length);</span><br><span class="line"><span class="comment">// takeRight([1, 2, 3], 2) -&gt; [ 2, 3 ]</span></span><br><span class="line"><span class="comment">// takeRight([1, 2, 3]) -&gt; [3]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="union"><a href="#union" class="headerlink" title="union"></a>union</h3><p>Returns every element that exists in any of the two arrays once.</p>
<p>Create a <code>Set</code> with all values of <code>a</code> and <code>b</code> and convert to an array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> union = <span class="function">(<span class="params">a, b</span>) =&gt;</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>([...a, ...b]));</span><br><span class="line"><span class="comment">// union([1,2,3], [4,3,2]) -&gt; [1,2,3,4]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="without"><a href="#without" class="headerlink" title="without"></a>without</h3><p>Filters out the elements of an array, that have one of the specified values.</p>
<p>Use <code>Array.filter()</code> to create an array excluding(using <code>!Array.includes()</code>) all given values.</p>
<p><em>(For a snippet that mutates the original array see <a href="#pull"><code>pull</code></a>)</em></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> without = <span class="function">(<span class="params">arr, ...args</span>) =&gt;</span> arr.filter(<span class="function"><span class="params">v</span> =&gt;</span> !args.includes(v));</span><br><span class="line"><span class="comment">// without([2, 1, 2, 3], 1, 2) -&gt; [3]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h3><p>Creates an array of elements, grouped based on the position in the original arrays.</p>
<p>Use <code>Math.max.apply()</code> to get the longest array in the arguments.<br>Creates an array with that length as return value and use <code>Array.from()</code> with a map-function to create an array of grouped elements.<br>If lengths of the argument-arrays vary, <code>undefined</code> is used where no value could be found.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> zip = <span class="function">(<span class="params">...arrays</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> maxLength = <span class="built_in">Math</span>.max(...arrays.map(<span class="function"><span class="params">x</span> =&gt;</span> x.length));</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.from(&#123;<span class="attr">length</span>: maxLength&#125;).map(<span class="function">(<span class="params">_, i</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(&#123;<span class="attr">length</span>: arrays.length&#125;, (_, k) =&gt; arrays[k][i]);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// zip(['a', 'b'], [1, 2], [true, false]); -&gt; [['a', 1, true], ['b', 2, false]]</span></span><br><span class="line"><span class="comment">// zip(['a'], [1, 2], [true, false]); -&gt; [['a', 1, true], [undefined, 2, false]]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="zipObject"><a href="#zipObject" class="headerlink" title="zipObject"></a>zipObject</h3><p>Given an array of valid property identifiers and an array of values, return an object associating the properties to the values.</p>
<p>Since an object can have undefined values but not undefined property pointers, the array of properties is used to decide the structure of the resulting object using <code>Array.reduce()</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> zipObject = <span class="function">(<span class="params">props, values</span>) =&gt;</span> props.reduce(<span class="function">(<span class="params">obj, prop, index</span>) =&gt;</span> (obj[prop] = values[index], obj), &#123;&#125;);</span><br><span class="line"><span class="comment">// zipObject(['a','b','c'], [1,2]) -&gt; &#123;a: 1, b: 2, c: undefined&#125;</span></span><br><span class="line"><span class="comment">// zipObject(['a','b'], [1,2,3]) -&gt; &#123;a: 1, b: 2&#125;</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h2 id="Browser-1"><a href="#Browser-1" class="headerlink" title="Browser"></a>Browser</h2><h3 id="arrayToHtmlList"><a href="#arrayToHtmlList" class="headerlink" title="arrayToHtmlList"></a>arrayToHtmlList</h3><p>Converts the given array elements into <code>&lt;li&gt;</code> tags and appends them to the list of the given id.</p>
<p>Use <code>Array.map()</code> and <code>document.querySelector()</code> to create a list of html tags.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayToHtmlList = <span class="function">(<span class="params">arr, listID</span>) =&gt;</span> arr.map(<span class="function"><span class="params">item</span> =&gt;</span> <span class="built_in">document</span>.querySelector(<span class="string">'#'</span> + listID).innerHTML += <span class="string">`&lt;li&gt;<span class="subst">$&#123;item&#125;</span>&lt;/li&gt;`</span>);</span><br><span class="line"><span class="comment">// arrayToHtmlList(['item 1', 'item 2'],'myListID')</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="bottomVisible"><a href="#bottomVisible" class="headerlink" title="bottomVisible"></a>bottomVisible</h3><p>Returns <code>true</code> if the bottom of the page is visible, <code>false</code> otherwise.</p>
<p>Use <code>scrollY</code>, <code>scrollHeight</code> and <code>clientHeight</code> to determine if the bottom of the page is visible.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bottomVisible = <span class="function"><span class="params">()</span> =&gt;</span></span><br><span class="line">  <span class="built_in">document</span>.documentElement.clientHeight + <span class="built_in">window</span>.scrollY &gt;= (<span class="built_in">document</span>.documentElement.scrollHeight || <span class="built_in">document</span>.documentElement.clientHeight);</span><br><span class="line"><span class="comment">// bottomVisible() -&gt; true</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="currentURL"><a href="#currentURL" class="headerlink" title="currentURL"></a>currentURL</h3><p>Returns the current URL.</p>
<p>Use <code>window.location.href</code> to get current URL.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> currentURL = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">window</span>.location.href;</span><br><span class="line"><span class="comment">// currentUrl() -&gt; 'https://google.com'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="detectDeviceType"><a href="#detectDeviceType" class="headerlink" title="detectDeviceType"></a>detectDeviceType</h3><p>Detects wether the website is being opened in a mobile device or a desktop/laptop.</p>
<p>Use a regular expression to test the <code>navigator.userAgent</code> property to figure out if the device is a mobile device or a desktop/laptop.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> detectDeviceType = <span class="function"><span class="params">()</span> =&gt;</span> /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ? <span class="string">'Mobile'</span> : <span class="string">'Desktop'</span>;</span><br><span class="line"><span class="comment">// detectDeviceType() -&gt; "Mobile"</span></span><br><span class="line"><span class="comment">// detectDeviceType() -&gt; "Desktop"</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="elementIsVisibleInViewport"><a href="#elementIsVisibleInViewport" class="headerlink" title="elementIsVisibleInViewport"></a>elementIsVisibleInViewport</h3><p>Returns <code>true</code> if the element specified is visible in the viewport, <code>false</code> otherwise.</p>
<p>Use <code>Element.getBoundingClientRect()</code> and the <code>window.inner(Width|Height)</code> values<br>to determine if a given element is visible in the viewport.<br>Omit the second argument to determine if the element is entirely visible, or specify <code>true</code> to determine if<br>it is partially visible.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> elementIsVisibleInViewport = <span class="function">(<span class="params">el, partiallyVisible = <span class="literal">false</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; top, left, bottom, right &#125; = el.getBoundingClientRect();</span><br><span class="line">  <span class="keyword">const</span> &#123; innerHeight, innerWidth &#125; = <span class="built_in">window</span>;</span><br><span class="line">  <span class="keyword">return</span> partiallyVisible</span><br><span class="line">    ? ((top &gt; <span class="number">0</span> &amp;&amp; top &lt; innerHeight) || (bottom &gt; <span class="number">0</span> &amp;&amp; bottom &lt; innerHeight)) &amp;&amp;</span><br><span class="line">      ((left &gt; <span class="number">0</span> &amp;&amp; left &lt; innerWidth) || (right &gt; <span class="number">0</span> &amp;&amp; right &lt; innerWidth))</span><br><span class="line">    : top &gt;= <span class="number">0</span> &amp;&amp; left &gt;= <span class="number">0</span> &amp;&amp; bottom &lt;= innerHeight &amp;&amp; right &lt;= innerWidth;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// e.g. 100x100 viewport and a 10x10px element at position &#123;top: -1, left: 0, bottom: 9, right: 10&#125;</span></span><br><span class="line"><span class="comment">// elementIsVisibleInViewport(el) -&gt; false (not fully visible)</span></span><br><span class="line"><span class="comment">// elementIsVisibleInViewport(el, true) -&gt; true (partially visible)</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="getScrollPosition"><a href="#getScrollPosition" class="headerlink" title="getScrollPosition"></a>getScrollPosition</h3><p>Returns the scroll position of the current page.</p>
<p>Use <code>pageXOffset</code> and <code>pageYOffset</code> if they are defined, otherwise <code>scrollLeft</code> and <code>scrollTop</code>.<br>You can omit <code>el</code> to use a default value of <code>window</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getScrollPosition = <span class="function">(<span class="params">el = <span class="built_in">window</span></span>) =&gt;</span></span><br><span class="line">  (&#123;<span class="attr">x</span>: (el.pageXOffset !== <span class="literal">undefined</span>) ? el.pageXOffset : el.scrollLeft,</span><br><span class="line">    y: (el.pageYOffset !== <span class="literal">undefined</span>) ? el.pageYOffset : el.scrollTop&#125;);</span><br><span class="line"><span class="comment">// getScrollPosition() -&gt; &#123;x: 0, y: 200&#125;</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="getURLParameters"><a href="#getURLParameters" class="headerlink" title="getURLParameters"></a>getURLParameters</h3><p>Returns an object containing the parameters of the current URL.</p>
<p>Use <code>match()</code> with an appropriate regular expression to get all key-value pairs, <code>Array.reduce()</code> to map and combine them into a single object.<br>Pass <code>location.search</code> as the argument to apply to the current <code>url</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getURLParameters = <span class="function"><span class="params">url</span> =&gt;</span></span><br><span class="line">  url.match(<span class="regexp">/([^?=&amp;]+)(=([^&amp;]*))/g</span>).reduce(</span><br><span class="line">    (a, v) =&gt; (a[v.slice(<span class="number">0</span>, v.indexOf(<span class="string">'='</span>))] = v.slice(v.indexOf(<span class="string">'='</span>) + <span class="number">1</span>), a), &#123;&#125;</span><br><span class="line">  );</span><br><span class="line"><span class="comment">// getURLParameters('http://url.com/page?name=Adam&amp;surname=Smith') -&gt; &#123;name: 'Adam', surname: 'Smith'&#125;</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="httpsRedirect"><a href="#httpsRedirect" class="headerlink" title="httpsRedirect"></a>httpsRedirect</h3><p>Redirects the page to HTTPS if its currently in HTTP. Also, pressing the back button doesn’t take it back to the HTTP page as its replaced in the history.</p>
<p>Use <code>location.protocol</code> to get the protocol currently being used. If it’s not HTTPS, use <code>location.replace()</code> to replace the existing page with the HTTPS version of the page. Use <code>location.href</code> to get the full address, split it with <code>String.split()</code> and remove the protocol part of the URL.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> httpsRedirect = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (location.protocol !== <span class="string">'https:'</span>) location.replace(<span class="string">'https://'</span> + location.href.split(<span class="string">'//'</span>)[<span class="number">1</span>]);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="redirect"><a href="#redirect" class="headerlink" title="redirect"></a>redirect</h3><p>Redirects to a specified URL.</p>
<p>Use <code>window.location.href</code> or <code>window.location.replace()</code> to redirect to <code>url</code>.<br>Pass a second argument to simulate a link click (<code>true</code> - default) or an HTTP redirect (<code>false</code>).</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> redirect = <span class="function">(<span class="params">url, asLink = <span class="literal">true</span></span>) =&gt;</span></span><br><span class="line">  asLink ? <span class="built_in">window</span>.location.href = url : <span class="built_in">window</span>.location.replace(url);</span><br><span class="line"><span class="comment">// redirect('https://google.com')</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="scrollToTop"><a href="#scrollToTop" class="headerlink" title="scrollToTop"></a>scrollToTop</h3><p>Smooth-scrolls to the top of the page.</p>
<p>Get distance from top using <code>document.documentElement.scrollTop</code> or <code>document.body.scrollTop</code>.<br>Scroll by a fraction of the distance from the top. Use <code>window.requestAnimationFrame()</code> to animate the scrolling.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> scrollToTop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> c = <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop;</span><br><span class="line">  <span class="keyword">if</span> (c &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">window</span>.requestAnimationFrame(scrollToTop);</span><br><span class="line">    <span class="built_in">window</span>.scrollTo(<span class="number">0</span>, c - c / <span class="number">8</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// scrollToTop()</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h2 id="Date-1"><a href="#Date-1" class="headerlink" title="Date"></a>Date</h2><h3 id="getDaysDiffBetweenDates"><a href="#getDaysDiffBetweenDates" class="headerlink" title="getDaysDiffBetweenDates"></a>getDaysDiffBetweenDates</h3><p>Returns the difference (in days) between two dates.</p>
<p>Calculate the difference (in days) between two <code>Date</code> objects.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getDaysDiffBetweenDates = <span class="function">(<span class="params">dateInitial, dateFinal</span>) =&gt;</span> (dateFinal - dateInitial) / (<span class="number">1000</span> * <span class="number">3600</span> * <span class="number">24</span>);</span><br><span class="line"><span class="comment">// getDaysDiffBetweenDates(new Date("2017-12-13"), new Date("2017-12-22")) -&gt; 9</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="JSONToDate"><a href="#JSONToDate" class="headerlink" title="JSONToDate"></a>JSONToDate</h3><p>Converts a JSON object to a date.</p>
<p>Use <code>Date()</code>, to convert dates in JSON format to readable format (<code>dd/mm/yyyy</code>).</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> JSONToDate = <span class="function"><span class="params">arr</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> dt = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">parseInt</span>(arr.toString().substr(<span class="number">6</span>)));</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;dt.getDate()&#125;</span>/<span class="subst">$&#123;dt.getMonth() + <span class="number">1</span>&#125;</span>/<span class="subst">$&#123;dt.getFullYear()&#125;</span>`</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// JSONToDate(/Date(1489525200000)/) -&gt; "14/3/2017"</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="toEnglishDate"><a href="#toEnglishDate" class="headerlink" title="toEnglishDate"></a>toEnglishDate</h3><p>Converts a date from American format to English format.</p>
<p>Use <code>Date.toISOString()</code>, <code>split(&#39;T&#39;)</code> and <code>replace()</code> to convert a date from American format to the English format.<br>Throws an error if the passed time cannot be converted to a date.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> toEnglishDate = <span class="function">(<span class="params">time</span>) =&gt;</span> &#123; <span class="keyword">try</span> &#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(time).toISOString().split(<span class="string">'T'</span>)[<span class="number">0</span>].replace(<span class="regexp">/-/g</span>, <span class="string">'/'</span>); &#125; <span class="keyword">catch</span> (e) &#123;&#125; &#125;;</span><br><span class="line"><span class="comment">// toEnglishDate('09/21/2010') -&gt; '21/09/2010'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="tomorrow"><a href="#tomorrow" class="headerlink" title="tomorrow"></a>tomorrow</h3><p>Results in a string representation of tomorrow’s date.<br>Use <code>new Date()</code> to get today’s date, adding <code>86400000</code> of seconds to it(24 hours), using <code>toISOString</code> to convert Date object to string.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tomorrow = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime() + <span class="number">86400000</span>).toISOString().split(<span class="string">'T'</span>)[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// tomorrow() -&gt; 2017-12-27 (if current date is 2017-12-26)</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h2 id="Function-1"><a href="#Function-1" class="headerlink" title="Function"></a>Function</h2><h3 id="chainAsync"><a href="#chainAsync" class="headerlink" title="chainAsync"></a>chainAsync</h3><p>Chains asynchronous functions.</p>
<p>Loop through an array of functions containing asynchronous events, calling <code>next</code> when each asynchronous event has completed.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> chainAsync = <span class="function"><span class="params">fns</span> =&gt;</span> &#123; <span class="keyword">let</span> curr = <span class="number">0</span>; <span class="keyword">const</span> next = <span class="function"><span class="params">()</span> =&gt;</span> fns[curr++](next); next(); &#125;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">chainAsync([</span></span><br><span class="line"><span class="comment">  next =&gt; &#123; console.log('0 seconds'); setTimeout(next, 1000); &#125;,</span></span><br><span class="line"><span class="comment">  next =&gt; &#123; console.log('1 second');  setTimeout(next, 1000); &#125;,</span></span><br><span class="line"><span class="comment">  next =&gt; &#123; console.log('2 seconds'); &#125;</span></span><br><span class="line"><span class="comment">])</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="compose"><a href="#compose" class="headerlink" title="compose"></a>compose</h3><p>Performs right-to-left function composition.</p>
<p>Use <code>Array.reduce()</code> to perform right-to-left function composition.<br>The last (rightmost) function can accept one or more arguments; the remaining functions must be unary.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> compose = <span class="function">(<span class="params">...fns</span>) =&gt;</span> fns.reduce(<span class="function">(<span class="params">f, g</span>) =&gt;</span> (...args) =&gt; f(g(...args)));</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">const add5 = x =&gt; x + 5</span></span><br><span class="line"><span class="comment">const multiply = (x, y) =&gt; x * y</span></span><br><span class="line"><span class="comment">const multiplyAndAdd5 = compose(add5, multiply)</span></span><br><span class="line"><span class="comment">multiplyAndAdd5(5, 2) -&gt; 15</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="curry"><a href="#curry" class="headerlink" title="curry"></a>curry</h3><p>Curries a function.</p>
<p>Use recursion.<br>If the number of provided arguments (<code>args</code>) is sufficient, call the passed function <code>fn</code>.<br>Otherwise, return a curried function <code>fn</code> that expects the rest of the arguments.<br>If you want to curry a function that accepts a variable number of arguments (a variadic function, e.g. <code>Math.min()</code>), you can optionally pass the number of arguments to the second parameter <code>arity</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> curry = <span class="function">(<span class="params">fn, arity = fn.length, ...args</span>) =&gt;</span></span><br><span class="line">  arity &lt;= args.length</span><br><span class="line">    ? fn(...args)</span><br><span class="line">    : curry.bind(<span class="literal">null</span>, fn, arity, ...args);</span><br><span class="line"><span class="comment">// curry(Math.pow)(2)(10) -&gt; 1024</span></span><br><span class="line"><span class="comment">// curry(Math.min, 3)(10)(50)(2) -&gt; 2</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="functionName"><a href="#functionName" class="headerlink" title="functionName"></a>functionName</h3><p>Logs the name of a function.</p>
<p>Use <code>console.debug()</code> and the <code>name</code> property of the passed method to log the method’s name to the <code>debug</code> channel of the console.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> functionName = <span class="function"><span class="params">fn</span> =&gt;</span> (<span class="built_in">console</span>.debug(fn.name), fn);</span><br><span class="line"><span class="comment">// functionName(Math.max) -&gt; max (logged in debug channel of console)</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="runPromisesInSeries"><a href="#runPromisesInSeries" class="headerlink" title="runPromisesInSeries"></a>runPromisesInSeries</h3><p>Runs an array of promises in series.</p>
<p>Use <code>Array.reduce()</code> to create a promise chain, where each promise returns the next promise when resolved.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> runPromisesInSeries = <span class="function"><span class="params">ps</span> =&gt;</span> ps.reduce(<span class="function">(<span class="params">p, next</span>) =&gt;</span> p.then(next), <span class="built_in">Promise</span>.resolve());</span><br><span class="line"><span class="comment">// const delay = (d) =&gt; new Promise(r =&gt; setTimeout(r, d))</span></span><br><span class="line"><span class="comment">// runPromisesInSeries([() =&gt; delay(1000), () =&gt; delay(2000)]) -&gt; executes each promise sequentially, taking a total of 3 seconds to complete</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="sleep"><a href="#sleep" class="headerlink" title="sleep"></a>sleep</h3><p>Delays the execution of an asynchronous function.</p>
<p>Delay executing part of an <code>async</code> function, by putting it to sleep, returning a <code>Promise</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sleep = <span class="function"><span class="params">ms</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> setTimeout(resolve, ms));</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">async function sleepyWork() &#123;</span></span><br><span class="line"><span class="comment">  console.log('I\'m going to sleep for 1 second.');</span></span><br><span class="line"><span class="comment">  await sleep(1000);</span></span><br><span class="line"><span class="comment">  console.log('I woke up after 1 second.');</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h2 id="Logic-1"><a href="#Logic-1" class="headerlink" title="Logic"></a>Logic</h2><h3 id="negate"><a href="#negate" class="headerlink" title="negate"></a>negate</h3><p>Negates a predicate function.</p>
<p>Take a predicate function and apply <code>not</code> to it with its arguments.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> negate = <span class="function"><span class="params">func</span> =&gt;</span> (...args) =&gt; !func(...args);</span><br><span class="line"><span class="comment">// filter([1, 2, 3, 4, 5, 6], negate(isEven)) -&gt; [1, 3, 5]</span></span><br><span class="line"><span class="comment">// negate(isOdd)(1) -&gt; false</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h2 id="Math-1"><a href="#Math-1" class="headerlink" title="Math"></a>Math</h2><h3 id="arrayAverage"><a href="#arrayAverage" class="headerlink" title="arrayAverage"></a>arrayAverage</h3><p>Returns the average of an array of numbers.</p>
<p>Use <code>Array.reduce()</code> to add each value to an accumulator, initialized with a value of <code>0</code>, divide by the <code>length</code> of the array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrayAverage = <span class="function"><span class="params">arr</span> =&gt;</span> arr.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>) / arr.length;</span><br><span class="line"><span class="comment">// arrayAverage([1,2,3]) -&gt; 2</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="arraySum"><a href="#arraySum" class="headerlink" title="arraySum"></a>arraySum</h3><p>Returns the sum of an array of numbers.</p>
<p>Use <code>Array.reduce()</code> to add each value to an accumulator, initialized with a value of <code>0</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arraySum = <span class="function"><span class="params">arr</span> =&gt;</span> arr.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// arraySum([1,2,3,4]) -&gt; 10</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="clampNumber"><a href="#clampNumber" class="headerlink" title="clampNumber"></a>clampNumber</h3><p>Clamps <code>num</code> within the inclusive range specified by the boundary values <code>a</code> and <code>b</code></p>
<p>If <code>num</code> falls within the range, return <code>num</code>.<br>Otherwise, return the nearest number in the range.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> clampNumber = <span class="function">(<span class="params">num, a, b</span>) =&gt;</span> <span class="built_in">Math</span>.max(<span class="built_in">Math</span>.min(num, <span class="built_in">Math</span>.max(a,b)),<span class="built_in">Math</span>.min(a,b));</span><br><span class="line"><span class="comment">// clampNumber(2, 3, 5) -&gt; 3</span></span><br><span class="line"><span class="comment">// clampNumber(1, -1, -5) -&gt; -1</span></span><br><span class="line"><span class="comment">// clampNumber(3, 2, 4) -&gt; 3</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="collatz"><a href="#collatz" class="headerlink" title="collatz"></a>collatz</h3><p>Applies the Collatz algorithm.</p>
<p>If <code>n</code> is even, return <code>n/2</code>. Otherwise, return <code>3n+1</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> collatz = <span class="function"><span class="params">n</span> =&gt;</span> (n % <span class="number">2</span> == <span class="number">0</span>) ? (n / <span class="number">2</span>) : (<span class="number">3</span> * n + <span class="number">1</span>);</span><br><span class="line"><span class="comment">// collatz(8) --&gt; 4</span></span><br><span class="line"><span class="comment">// collatz(5) --&gt; 16</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="digitize"><a href="#digitize" class="headerlink" title="digitize"></a>digitize</h3><p>Converts a number to an array of digits.</p>
<p>Convert the number to a string, using spread operators in ES6(<code>[...string]</code>) build an array.<br>Use <code>Array.map()</code> and <code>parseInt()</code> to transform each value to an integer.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> digitize = <span class="function"><span class="params">n</span> =&gt;</span> [...<span class="string">''</span> + n].map(<span class="function"><span class="params">i</span> =&gt;</span> <span class="built_in">parseInt</span>(i));</span><br><span class="line"><span class="comment">// digitize(2334) -&gt; [2, 3, 3, 4]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="distance"><a href="#distance" class="headerlink" title="distance"></a>distance</h3><p>Returns the distance between two points.</p>
<p>Use <code>Math.hypot()</code> to calculate the Euclidean distance between two points.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> distance = <span class="function">(<span class="params">x0, y0, x1, y1</span>) =&gt;</span> <span class="built_in">Math</span>.hypot(x1 - x0, y1 - y0);</span><br><span class="line"><span class="comment">// distance(1,1, 2,3) -&gt; 2.23606797749979</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="factorial"><a href="#factorial" class="headerlink" title="factorial"></a>factorial</h3><p>Calculates the factorial of a number.</p>
<p>Use recursion.<br>If <code>n</code> is less than or equal to <code>1</code>, return <code>1</code>.<br>Otherwise, return the product of <code>n</code> and the factorial of <code>n - 1</code>.<br>Throws an exception if <code>n</code> is a negative number.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> factorial = <span class="function"><span class="params">n</span> =&gt;</span></span><br><span class="line">  n &lt; <span class="number">0</span> ? <span class="function">(<span class="params">(</span>) =&gt;</span> &#123; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Negative numbers are not allowed!'</span>); &#125;)()</span><br><span class="line">  : n &lt;= <span class="number">1</span> ? <span class="number">1</span> : n * factorial(n - <span class="number">1</span>);</span><br><span class="line"><span class="comment">// factorial(6) -&gt; 720</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="fibonacci"><a href="#fibonacci" class="headerlink" title="fibonacci"></a>fibonacci</h3><p>Generates an array, containing the Fibonacci sequence, up until the nth term.</p>
<p>Create an empty array of the specific length, initializing the first two values (<code>0</code> and <code>1</code>).<br>Use <code>Array.reduce()</code> to add values into the array, using the sum of the last two values, except for the first two.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fibonacci = <span class="function"><span class="params">n</span> =&gt;</span></span><br><span class="line">  <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: n&#125;).reduce(<span class="function">(<span class="params">acc, val, i</span>) =&gt;</span> acc.concat(i &gt; <span class="number">1</span> ? acc[i - <span class="number">1</span>] + acc[i - <span class="number">2</span>] : i), []);</span><br><span class="line"><span class="comment">// fibonacci(5) -&gt; [0,1,1,2,3]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="fibonacciCountUntilNum"><a href="#fibonacciCountUntilNum" class="headerlink" title="fibonacciCountUntilNum"></a>fibonacciCountUntilNum</h3><p>Returns the number of fibonnacci numbers up to <code>num</code>(<code>0</code> and <code>num</code> inclusive).</p>
<p>Use a mathematical formula to calculate the number of fibonacci numbers until <code>num</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fibonacciCountUntilNum = <span class="function"><span class="params">num</span> =&gt;</span></span><br><span class="line">  <span class="built_in">Math</span>.ceil(<span class="built_in">Math</span>.log(num * <span class="built_in">Math</span>.sqrt(<span class="number">5</span>) + <span class="number">1</span> / <span class="number">2</span>) / <span class="built_in">Math</span>.log((<span class="built_in">Math</span>.sqrt(<span class="number">5</span>) + <span class="number">1</span>) / <span class="number">2</span>));</span><br><span class="line"><span class="comment">// fibonacciCountUntilNum(10) -&gt; 7</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="fibonacciUntilNum"><a href="#fibonacciUntilNum" class="headerlink" title="fibonacciUntilNum"></a>fibonacciUntilNum</h3><p>Generates an array, containing the Fibonacci sequence, up until the nth term.</p>
<p>Create an empty array of the specific length, initializing the first two values (<code>0</code> and <code>1</code>).<br>Use <code>Array.reduce()</code> to add values into the array, using the sum of the last two values, except for the first two.<br>Uses a mathematical formula to calculate the length of the array required.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fibonacciUntilNum = <span class="function"><span class="params">num</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> n = <span class="built_in">Math</span>.ceil(<span class="built_in">Math</span>.log(num * <span class="built_in">Math</span>.sqrt(<span class="number">5</span>) + <span class="number">1</span> / <span class="number">2</span>) / <span class="built_in">Math</span>.log((<span class="built_in">Math</span>.sqrt(<span class="number">5</span>) + <span class="number">1</span>) / <span class="number">2</span>));</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: n&#125;).reduce(<span class="function">(<span class="params">acc, val, i</span>) =&gt;</span> acc.concat(i &gt; <span class="number">1</span> ? acc[i - <span class="number">1</span>] + acc[i - <span class="number">2</span>] : i), []);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// fibonacciUntilNum(15) -&gt; [0,1,1,2,3,5,8,13]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="gcd"><a href="#gcd" class="headerlink" title="gcd"></a>gcd</h3><p>Calculates the greatest common divisor between two numbers.</p>
<p>Use recursion.<br>Base case is when <code>y</code> equals <code>0</code>. In this case, return <code>x</code>.<br>Otherwise, return the GCD of <code>y</code> and the remainder of the division <code>x/y</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gcd = <span class="function">(<span class="params">x, y</span>) =&gt;</span> !y ? x : gcd(y, x % y);</span><br><span class="line"><span class="comment">// gcd (8, 36) -&gt; 4</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="hammingDistance"><a href="#hammingDistance" class="headerlink" title="hammingDistance"></a>hammingDistance</h3><p>Calculates the Hamming distance between two values.</p>
<p>Use XOR operator (<code>^</code>) to find the bit difference between the two numbers, convert to a binary string using <code>toString(2)</code>.<br>Count and return the number of <code>1</code>s in the string, using <code>match(/1/g)</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> hammingDistance = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span></span><br><span class="line">  ((num1 ^ num2).toString(<span class="number">2</span>).match(<span class="regexp">/1/g</span>) || <span class="string">''</span>).length;</span><br><span class="line"><span class="comment">// hammingDistance(2,3) -&gt; 1</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="inRange"><a href="#inRange" class="headerlink" title="inRange"></a>inRange</h3><p>Checks if the given number falls within the given range.</p>
<p>Use arithmetic comparison to check if the given number is in the specified range.<br>If the second parameter, <code>end</code>, is not specified, the range is considered to be from <code>0</code> to <code>start</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> inRange = <span class="function">(<span class="params">n, start, end = <span class="literal">null</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (end &amp;&amp; start &gt; end) end = [start, start = end][<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">return</span> (end == <span class="literal">null</span>) ? (n &gt;= <span class="number">0</span> &amp;&amp; n &lt; start) : (n &gt;= start &amp;&amp; n &lt; end);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// inRange(3, 2, 5) -&gt; true</span></span><br><span class="line"><span class="comment">// inRange(3, 4) -&gt; true</span></span><br><span class="line"><span class="comment">// inRange(2, 3, 5) -&gt; false</span></span><br><span class="line"><span class="comment">// inrange(3, 2) -&gt; false</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="isArmstrongNumber"><a href="#isArmstrongNumber" class="headerlink" title="isArmstrongNumber"></a>isArmstrongNumber</h3><p>Checks if the given number is an Armstrong number or not.</p>
<p>Convert the given number into an array of digits. Use <code>Math.pow()</code> to get the appropriate power for each digit and sum them up. If the sum is equal to the number itself, return <code>true</code> otherwise <code>false</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isArmstrongNumber = <span class="function"><span class="params">digits</span> =&gt;</span></span><br><span class="line">  (<span class="function"><span class="params">arr</span> =&gt;</span> arr.reduce(<span class="function">(<span class="params">a, d</span>) =&gt;</span> a + <span class="built_in">Math</span>.pow(<span class="built_in">parseInt</span>(d), arr.length), <span class="number">0</span>) == digits)((digits + <span class="string">''</span>).split(<span class="string">''</span>));</span><br><span class="line"><span class="comment">// isArmstrongNumber(1634) -&gt; true</span></span><br><span class="line"><span class="comment">// isArmstrongNumber(371) -&gt; true</span></span><br><span class="line"><span class="comment">// isArmstrongNumber(56) -&gt; false</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="isDivisible"><a href="#isDivisible" class="headerlink" title="isDivisible"></a>isDivisible</h3><p>Checks if the first numeric argument is divisible by the second one.</p>
<p>Use the modulo operator (<code>%</code>) to check if the remainder is equal to <code>0</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isDivisible = <span class="function">(<span class="params">dividend, divisor</span>) =&gt;</span> dividend % divisor === <span class="number">0</span>;</span><br><span class="line"><span class="comment">// isDivisible(6,3) -&gt; true</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="isEven"><a href="#isEven" class="headerlink" title="isEven"></a>isEven</h3><p>Returns <code>true</code> if the given number is even, <code>false</code> otherwise.</p>
<p>Checks whether a number is odd or even using the modulo (<code>%</code>) operator.<br>Returns <code>true</code> if the number is even, <code>false</code> if the number is odd.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isEven = <span class="function"><span class="params">num</span> =&gt;</span> num % <span class="number">2</span> === <span class="number">0</span>;</span><br><span class="line"><span class="comment">// isEven(3) -&gt; false</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="isPrime"><a href="#isPrime" class="headerlink" title="isPrime"></a>isPrime</h3><p>Checks if the provided integer is a prime number.</p>
<p>Check numbers from <code>2</code> to the square root of the given number.<br>Return <code>false</code> if any of them divides the given number, else return <code>true</code>, unless the number is less than <code>2</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isPrime = <span class="function"><span class="params">num</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> boundary = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.sqrt(num));</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">2</span>; i * i &lt;= boundary; i++) <span class="keyword">if</span> (num % i == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> num &gt;= <span class="number">2</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// isPrime(11) -&gt; true</span></span><br><span class="line"><span class="comment">// isPrime(12) -&gt; false</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="lcm"><a href="#lcm" class="headerlink" title="lcm"></a>lcm</h3><p>Returns the least common multiple of two numbers.</p>
<p>Use the greatest common divisor (GCD) formula and <code>Math.abs()</code> to determine the least common multiple.<br>The GCD formula uses recursion.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> lcm = <span class="function">(<span class="params">x, y</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> gcd = <span class="function">(<span class="params">x, y</span>) =&gt;</span> !y ? x : gcd(y, x % y);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.abs(x * y) / (gcd(x, y));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// lcm(12,7) -&gt; 84</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="median"><a href="#median" class="headerlink" title="median"></a>median</h3><p>Returns the median of an array of numbers.</p>
<p>Find the middle of the array, use <code>Array.sort()</code> to sort the values.<br>Return the number at the midpoint if <code>length</code> is odd, otherwise the average of the two middle numbers.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> median = <span class="function"><span class="params">arr</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mid = <span class="built_in">Math</span>.floor(arr.length / <span class="number">2</span>), nums = [...arr].sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b);</span><br><span class="line">  <span class="keyword">return</span> arr.length % <span class="number">2</span> !== <span class="number">0</span> ? nums[mid] : (nums[mid - <span class="number">1</span>] + nums[mid]) / <span class="number">2</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// median([5,6,50,1,-5]) -&gt; 5</span></span><br><span class="line"><span class="comment">// median([0,10,-2,7]) -&gt; 3.5</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="palindrome"><a href="#palindrome" class="headerlink" title="palindrome"></a>palindrome</h3><p>Returns <code>true</code> if the given string is a palindrome, <code>false</code> otherwise.</p>
<p>Convert string <code>toLowerCase()</code> and use <code>replace()</code> to remove non-alphanumeric characters from it.<br>Then, <code>split(&#39;&#39;)</code> into individual characters, <code>reverse()</code>, <code>join(&#39;&#39;)</code> and compare to the original, unreversed string, after converting it <code>tolowerCase()</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> palindrome = <span class="function"><span class="params">str</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> s = str.toLowerCase().replace(<span class="regexp">/[\W_]/g</span>,<span class="string">''</span>);</span><br><span class="line">  <span class="keyword">return</span> s === s.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// palindrome('taco cat') -&gt; true</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="percentile"><a href="#percentile" class="headerlink" title="percentile"></a>percentile</h3><p>Uses the percentile formula to calculate how many numbers in the given array are less or equal to the given value.</p>
<p>Use <code>Array.reduce()</code> to calculate how many numbers are below the value and how many are the same value and apply the percentile formula.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> percentile = <span class="function">(<span class="params">arr, val</span>) =&gt;</span></span><br><span class="line">  <span class="number">100</span> * arr.reduce(<span class="function">(<span class="params">acc,v</span>) =&gt;</span> acc + (v &lt; val ? <span class="number">1</span> : <span class="number">0</span>) + (v === val ? <span class="number">0.5</span> : <span class="number">0</span>), <span class="number">0</span>) / arr.length;</span><br><span class="line"><span class="comment">// percentile([1,2,3,4,5,6,7,8,9,10], 6) -&gt; 55</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="powerset"><a href="#powerset" class="headerlink" title="powerset"></a>powerset</h3><p>Returns the powerset of a given array of numbers.</p>
<p>Use <code>Array.reduce()</code> combined with <code>Array.map()</code> to iterate over elements and combine into an array containing all combinations.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> powerset = <span class="function"><span class="params">arr</span> =&gt;</span></span><br><span class="line">  arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> a.concat(a.map(<span class="function"><span class="params">r</span> =&gt;</span> [v].concat(r))), [[]]);</span><br><span class="line"><span class="comment">// powerset([1,2]) -&gt; [[], [1], [2], [2,1]]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="primes"><a href="#primes" class="headerlink" title="primes"></a>primes</h3><p>Generates primes up to a given number, using the Sieve of Eratosthenes.</p>
<p>Generate an array from <code>2</code> to the given number. Use <code>Array.filter()</code> to filter out the values divisible by any number from <code>2</code> to the square root of the provided number.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> primes = <span class="function"><span class="params">num</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> arr = <span class="built_in">Array</span>.from(&#123;<span class="attr">length</span>: num - <span class="number">1</span>&#125;).map(<span class="function">(<span class="params">x, i</span>) =&gt;</span> i + <span class="number">2</span>),</span><br><span class="line">    sqroot = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.sqrt(num)),</span><br><span class="line">    numsTillSqroot = <span class="built_in">Array</span>.from(&#123;<span class="attr">length</span>: sqroot - <span class="number">1</span>&#125;).map(<span class="function">(<span class="params">x, i</span>) =&gt;</span> i + <span class="number">2</span>);</span><br><span class="line">  numsTillSqroot.forEach(<span class="function"><span class="params">x</span> =&gt;</span> arr = arr.filter(<span class="function"><span class="params">y</span> =&gt;</span> ((y % x) !== <span class="number">0</span>) || (y == x)));</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// primes(10) -&gt; [2,3,5,7]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="randomIntegerInRange"><a href="#randomIntegerInRange" class="headerlink" title="randomIntegerInRange"></a>randomIntegerInRange</h3><p>Returns a random integer in the specified range.</p>
<p>Use <code>Math.random()</code> to generate a random number and map it to the desired range, using <code>Math.floor()</code> to make it an integer.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> randomIntegerInRange = <span class="function">(<span class="params">min, max</span>) =&gt;</span> <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (max - min + <span class="number">1</span>)) + min;</span><br><span class="line"><span class="comment">// randomIntegerInRange(0, 5) -&gt; 2</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="randomNumberInRange"><a href="#randomNumberInRange" class="headerlink" title="randomNumberInRange"></a>randomNumberInRange</h3><p>Returns a random number in the specified range.</p>
<p>Use <code>Math.random()</code> to generate a random value, map it to the desired range using multiplication.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> randomNumberInRange = <span class="function">(<span class="params">min, max</span>) =&gt;</span> <span class="built_in">Math</span>.random() * (max - min) + min;</span><br><span class="line"><span class="comment">// randomNumberInRange(2,10) -&gt; 6.0211363285087005</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="round"><a href="#round" class="headerlink" title="round"></a>round</h3><p>Rounds a number to a specified amount of digits.</p>
<p>Use <code>Math.round()</code> and template literals to round the number to the specified number of digits.<br>Omit the second argument, <code>decimals</code> to round to an integer.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> round = <span class="function">(<span class="params">n, decimals = <span class="number">0</span></span>) =&gt;</span> <span class="built_in">Number</span>(<span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.round(<span class="string">`<span class="subst">$&#123;n&#125;</span>e<span class="subst">$&#123;decimals&#125;</span>`</span>)&#125;</span>e-<span class="subst">$&#123;decimals&#125;</span>`</span>);</span><br><span class="line"><span class="comment">// round(1.005, 2) -&gt; 1.01</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="sdbmHashAlgorithm"><a href="#sdbmHashAlgorithm" class="headerlink" title="sdbmHashAlgorithm"></a>sdbmHashAlgorithm</h3><p>This algorithm is a simple hash-algorithm that hashes it input string <code>s</code> into a whole number.</p>
<p>Use <code>split(&#39;&#39;)</code> and <code>Array.reduce()</code> to create a hash of the input string, utilizing bit shifting.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sdbm = <span class="function"><span class="params">str</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> arr = str.split(<span class="string">''</span>);</span><br><span class="line">  <span class="keyword">return</span> arr.reduce(<span class="function">(<span class="params">hashCode, currentVal</span>) =&gt;</span></span><br><span class="line">    hashCode = currentVal.charCodeAt(<span class="number">0</span>) + (hashCode &lt;&lt; <span class="number">6</span>) + (hashCode &lt;&lt; <span class="number">16</span>)  - hashCode</span><br><span class="line">  ,<span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// console.log(sdbm("name")) // -3521204949</span></span><br><span class="line"><span class="comment">// console.log(sdbm("age")) // 808122783</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="standardDeviation"><a href="#standardDeviation" class="headerlink" title="standardDeviation"></a>standardDeviation</h3><p>Returns the standard deviation of an array of numbers.</p>
<p>Use <code>Array.reduce()</code> to calculate the mean, variance and the sum of the variance of the values, the variance of the values, then<br>determine the standard deviation.<br>You can omit the second argument to get the sample standard deviation or set it to <code>true</code> to get the population standard deviation.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> standardDeviation = <span class="function">(<span class="params">arr, usePopulation = <span class="literal">false</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mean = arr.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>) / arr.length;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(</span><br><span class="line">    arr.reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc.concat(<span class="built_in">Math</span>.pow(val - mean, <span class="number">2</span>)), [])</span><br><span class="line">       .reduce(<span class="function">(<span class="params">acc, val</span>) =&gt;</span> acc + val, <span class="number">0</span>) / (arr.length - (usePopulation ? <span class="number">0</span> : <span class="number">1</span>))</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// standardDeviation([10,2,38,23,38,23,21]) -&gt; 13.284434142114991 (sample)</span></span><br><span class="line"><span class="comment">// standardDeviation([10,2,38,23,38,23,21], true) -&gt; 12.29899614287479 (population)</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h2 id="Media-1"><a href="#Media-1" class="headerlink" title="Media"></a>Media</h2><h3 id="speechSynthesis"><a href="#speechSynthesis" class="headerlink" title="speechSynthesis"></a>speechSynthesis</h3><p>Performs speech synthesis (experimental).</p>
<p>Use <code>SpeechSynthesisUtterance.voice</code> and <code>window.speechSynthesis.getVoices()</code> to convert a message to speech.<br>Use <code>window.speechSynthesis.speak()</code> to play the message.</p>
<p>Learn more about the <a href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesisUtterance" target="_blank" rel="noopener">SpeechSynthesisUtterance interface of the Web Speech API</a>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> speechSynthesis = <span class="function"><span class="params">message</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> msg = <span class="keyword">new</span> SpeechSynthesisUtterance(message);</span><br><span class="line">  msg.voice = <span class="built_in">window</span>.speechSynthesis.getVoices()[<span class="number">0</span>];</span><br><span class="line">  <span class="built_in">window</span>.speechSynthesis.speak(msg);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// speechSynthesis('Hello, World') -&gt; plays the message</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h2 id="Node-1"><a href="#Node-1" class="headerlink" title="Node"></a>Node</h2><h3 id="JSONToFile"><a href="#JSONToFile" class="headerlink" title="JSONToFile"></a>JSONToFile</h3><p>Writes a JSON object to a file.</p>
<p>Use <code>fs.writeFile()</code>, template literals and <code>JSON.stringify()</code> to write a <code>json</code> object to a <code>.json</code> file.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> JSONToFile = <span class="function">(<span class="params">obj, filename</span>) =&gt;</span> fs.writeFile(<span class="string">`<span class="subst">$&#123;filename&#125;</span>.json`</span>, <span class="built_in">JSON</span>.stringify(obj, <span class="literal">null</span>, <span class="number">2</span>));</span><br><span class="line"><span class="comment">// JSONToFile(&#123;test: "is passed"&#125;, 'testJsonFile') -&gt; writes the object to 'testJsonFile.json'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="readFileLines"><a href="#readFileLines" class="headerlink" title="readFileLines"></a>readFileLines</h3><p>Returns an array of lines from the specified file.</p>
<p>Use <code>readFileSync</code> function in <code>fs</code> node package to create a <code>Buffer</code> from a file.<br>convert buffer to string using <code>toString(encoding)</code> function.<br>creating an array from contents of file by <code>split</code>ing file content line by line (each <code>\n</code>).</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> readFileLines = <span class="function"><span class="params">filename</span> =&gt;</span> fs.readFileSync(filename).toString(<span class="string">'UTF8'</span>).split(<span class="regexp">/\r?\n/</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  contents of test.txt :</span></span><br><span class="line"><span class="comment">    line1</span></span><br><span class="line"><span class="comment">    line2</span></span><br><span class="line"><span class="comment">    line3</span></span><br><span class="line"><span class="comment">    ___________________________</span></span><br><span class="line"><span class="comment">  let arr = readFileLines('test.txt')</span></span><br><span class="line"><span class="comment">  console.log(arr) // -&gt; ['line1', 'line2', 'line3']</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h2 id="Object-1"><a href="#Object-1" class="headerlink" title="Object"></a>Object</h2><h3 id="cleanObj"><a href="#cleanObj" class="headerlink" title="cleanObj"></a>cleanObj</h3><p>Removes any properties except the ones specified from a JSON object.</p>
<p>Use <code>Object.keys()</code> method to loop over given JSON object and deleting keys that are not <code>include</code>d in given array.<br>Also if you give it a special key (<code>childIndicator</code>) it will search deeply inside it to apply function to inner objects too.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cleanObj = <span class="function">(<span class="params">obj, keysToKeep = [], childIndicator</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">Object</span>.keys(obj).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (key === childIndicator) &#123;</span><br><span class="line">      cleanObj(obj[key], keysToKeep, childIndicator);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!keysToKeep.includes(key)) &#123;</span><br><span class="line">      <span class="keyword">delete</span> obj[key];</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;);</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  const testObj = &#123;a: 1, b: 2, children: &#123;a: 1, b: 2&#125;&#125;</span></span><br><span class="line"><span class="comment">  cleanObj(testObj, ["a"],"children") // &#123; a: 1, children : &#123; a: 1&#125;&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="objectFromPairs"><a href="#objectFromPairs" class="headerlink" title="objectFromPairs"></a>objectFromPairs</h3><p>Creates an object from the given key-value pairs.</p>
<p>Use <code>Array.reduce()</code> to create and combine key-value pairs.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> objectFromPairs = <span class="function"><span class="params">arr</span> =&gt;</span> arr.reduce(<span class="function">(<span class="params">a, v</span>) =&gt;</span> (a[v[<span class="number">0</span>]] = v[<span class="number">1</span>], a), &#123;&#125;);</span><br><span class="line"><span class="comment">// objectFromPairs([['a',1],['b',2]]) -&gt; &#123;a: 1, b: 2&#125;</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="objectToPairs"><a href="#objectToPairs" class="headerlink" title="objectToPairs"></a>objectToPairs</h3><p>Creates an array of key-value pair arrays from an object.</p>
<p>Use <code>Object.keys()</code> and <code>Array.map()</code> to iterate over the object’s keys and produce an array with key-value pairs.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> objectToPairs = <span class="function"><span class="params">obj</span> =&gt;</span> <span class="built_in">Object</span>.keys(obj).map(<span class="function"><span class="params">k</span> =&gt;</span> [k, obj[k]]);</span><br><span class="line"><span class="comment">// objectToPairs(&#123;a: 1, b: 2&#125;) -&gt; [['a',1],['b',2]])</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="orderBy"><a href="#orderBy" class="headerlink" title="orderBy"></a>orderBy</h3><p>Returns a sorted array of objects ordered by properties and orders.</p>
<p>Uses a custom implementation of sort, that reduces the props array argument with a default value of 0, it uses destructuring to swap the properties position depending on the order passed.<br>If no orders array is passed it sort by ‘asc’ by default.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> orderBy = <span class="function">(<span class="params">arr, props, orders</span>) =&gt;</span></span><br><span class="line">  arr.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span></span><br><span class="line">    props.reduce(<span class="function">(<span class="params">acc, prop, i</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (acc === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> [p1, p2] = orders &amp;&amp; orders[i] === <span class="string">'desc'</span> ? [b[prop], a[prop]] : [a[prop], b[prop]];</span><br><span class="line">        acc = p1 &gt; p2 ? <span class="number">1</span> : p1 &lt; p2 ? <span class="number">-1</span> : <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> acc;</span><br><span class="line">    &#125;, <span class="number">0</span>)</span><br><span class="line">  );</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">const users = [&#123; 'name': 'fred',   'age': 48 &#125;,&#123; 'name': 'barney', 'age': 36 &#125;,</span></span><br><span class="line"><span class="comment">  &#123; 'name': 'fred',   'age': 40 &#125;,&#123; 'name': 'barney', 'age': 34 &#125;];</span></span><br><span class="line"><span class="comment">orderby(users, ['name', 'age'], ['asc', 'desc']) -&gt; [&#123;name: 'barney', age: 36&#125;, &#123;name: 'barney', age: 34&#125;, &#123;name: 'fred', age: 48&#125;, &#123;name: 'fred', age: 40&#125;]</span></span><br><span class="line"><span class="comment">orderby(users, ['name', 'age']) -&gt; [&#123;name: 'barney', age: 34&#125;, &#123;name: 'barney', age: 36&#125;, &#123;name: 'fred', age: 40&#125;, &#123;name: 'fred', age: 48&#125;]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="select"><a href="#select" class="headerlink" title="select"></a>select</h3><p>Retrieve a property that indicated by the selector from an object.</p>
<p>If the property does not exists returns <code>undefined</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> select = <span class="function">(<span class="params"><span class="keyword">from</span>, selector</span>) =&gt;</span></span><br><span class="line">  selector.split(<span class="string">'.'</span>).reduce(<span class="function">(<span class="params">prev, cur</span>) =&gt;</span> prev &amp;&amp; prev[cur], <span class="keyword">from</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// const obj = &#123;selector: &#123;to: &#123;val: 'val to select'&#125;&#125;&#125;;</span></span><br><span class="line"><span class="comment">// select(obj, 'selector.to.val'); -&gt; 'val to select'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="shallowClone"><a href="#shallowClone" class="headerlink" title="shallowClone"></a>shallowClone</h3><p>Creates a shallow clone of an object.</p>
<p>Use <code>Object.assign()</code> and an empty object (<code>{}</code>) to create a shallow clone of the original.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> shallowClone = <span class="function"><span class="params">obj</span> =&gt;</span> <span class="built_in">Object</span>.assign(&#123;&#125;, obj);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">const a = &#123; x: true, y: 1 &#125;;</span></span><br><span class="line"><span class="comment">const b = shallowClone(a);</span></span><br><span class="line"><span class="comment">a === b -&gt; false</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="truthCheckCollection"><a href="#truthCheckCollection" class="headerlink" title="truthCheckCollection"></a>truthCheckCollection</h3><p>Checks if the predicate (second argument) is truthy on all elements of a collection (first argument).</p>
<p>Use <code>Array.every()</code> to check if each passed object has the specified property and if it returns a truthy value.</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> truthCheckCollection = <span class="function">(<span class="params">collection, pre</span>) =&gt;</span> (collection.every(<span class="function"><span class="params">obj</span> =&gt;</span> obj[pre]));</span><br><span class="line"><span class="comment">// truthCheckCollection([&#123;"user": "Tinky-Winky", "sex": "male"&#125;, &#123;"user": "Dipsy", "sex": "male"&#125;], "sex") -&gt; true</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h2 id="String-1"><a href="#String-1" class="headerlink" title="String"></a>String</h2><h3 id="anagrams"><a href="#anagrams" class="headerlink" title="anagrams"></a>anagrams</h3><p>Generates all anagrams of a string (contains duplicates).</p>
<p>Use recursion.<br>For each letter in the given string, create all the partial anagrams for the rest of its letters.<br>Use <code>Array.map()</code> to combine the letter with each partial anagram, then <code>Array.reduce()</code> to combine all anagrams in one array.<br>Base cases are for string <code>length</code> equal to <code>2</code> or <code>1</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> anagrams = <span class="function"><span class="params">str</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (str.length &lt;= <span class="number">2</span>) <span class="keyword">return</span> str.length === <span class="number">2</span> ? [str, str[<span class="number">1</span>] + str[<span class="number">0</span>]] : [str];</span><br><span class="line">  <span class="keyword">return</span> str.split(<span class="string">''</span>).reduce(<span class="function">(<span class="params">acc, letter, i</span>) =&gt;</span></span><br><span class="line">    acc.concat(anagrams(str.slice(<span class="number">0</span>, i) + str.slice(i + <span class="number">1</span>)).map(<span class="function"><span class="params">val</span> =&gt;</span> letter + val)), []);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// anagrams('abc') -&gt; ['abc','acb','bac','bca','cab','cba']</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="Capitalize"><a href="#Capitalize" class="headerlink" title="Capitalize"></a>Capitalize</h3><p>Capitalizes the first letter of a string.</p>
<p>Use destructuring and <code>toUpperCase()</code> to capitalize first letter, <code>...rest</code> to get array of characters after first letter and then <code>Array.join(&#39;&#39;)</code> to make it a string again.<br>Omit the <code>lowerRest</code> parameter to keep the rest of the string intact, or set it to <code>true</code> to convert to lowercase.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> capitalize = <span class="function">(<span class="params">[first, ...rest], lowerRest = <span class="literal">false</span></span>) =&gt;</span></span><br><span class="line">  first.toUpperCase() + (lowerRest ? rest.join(<span class="string">''</span>).toLowerCase() : rest.join(<span class="string">''</span>));</span><br><span class="line"><span class="comment">// capitalize('myName') -&gt; 'MyName'</span></span><br><span class="line"><span class="comment">// capitalize('myName', true) -&gt; 'Myname'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="capitalizeEveryWord"><a href="#capitalizeEveryWord" class="headerlink" title="capitalizeEveryWord"></a>capitalizeEveryWord</h3><p>Capitalizes the first letter of every word in a string.</p>
<p>Use <code>replace()</code> to match the first character of each word and <code>toUpperCase()</code> to capitalize it.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> capitalizeEveryWord = <span class="function"><span class="params">str</span> =&gt;</span> str.replace(<span class="regexp">/\b[a-z]/g</span>, char =&gt; char.toUpperCase());</span><br><span class="line"><span class="comment">// capitalizeEveryWord('hello world!') -&gt; 'Hello World!'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="countVowels"><a href="#countVowels" class="headerlink" title="countVowels"></a>countVowels</h3><p>Retuns <code>number</code> of vowels in provided string.</p>
<p>Use a regular expression to count the number of vowels <code>(A, E, I, O, U)</code> in a <code>string</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> countVowels = <span class="function"><span class="params">str</span> =&gt;</span> (str.match(<span class="regexp">/[aeiou]/ig</span>) || []).length;</span><br><span class="line"><span class="comment">// countVowels('foobar') -&gt; 3</span></span><br><span class="line"><span class="comment">// countVowels('gym') -&gt; 0</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="escapeRegExp"><a href="#escapeRegExp" class="headerlink" title="escapeRegExp"></a>escapeRegExp</h3><p>Escapes a string to use in a regular expression.</p>
<p>Use <code>replace()</code> to escape special characters.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> escapeRegExp = <span class="function"><span class="params">str</span> =&gt;</span> str.replace(<span class="regexp">/[.*+?^$&#123;&#125;()|[\]\\]/g</span>, <span class="string">'\\$&amp;'</span>);</span><br><span class="line"><span class="comment">// escapeRegExp('(test)') -&gt; \\(test\\)</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="fromCamelCase"><a href="#fromCamelCase" class="headerlink" title="fromCamelCase"></a>fromCamelCase</h3><p>Converts a string from camelcase.</p>
<p>Use <code>replace()</code> to remove underscores, hyphens, and spaces and convert words to camelcase.<br>Omit the second argument to use a default separator of <code>_</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fromCamelCase = <span class="function">(<span class="params">str, separator = <span class="string">'_'</span></span>) =&gt;</span></span><br><span class="line">  str.replace(<span class="regexp">/([a-z\d])([A-Z])/g</span>, <span class="string">'$1'</span> + separator + <span class="string">'$2'</span>)</span><br><span class="line">    .replace(<span class="regexp">/([A-Z]+)([A-Z][a-z\d]+)/g</span>, <span class="string">'$1'</span> + separator + <span class="string">'$2'</span>).toLowerCase();</span><br><span class="line"><span class="comment">// fromCamelCase('someDatabaseFieldName', ' ') -&gt; 'some database field name'</span></span><br><span class="line"><span class="comment">// fromCamelCase('someLabelThatNeedsToBeCamelized', '-') -&gt; 'some-label-that-needs-to-be-camelized'</span></span><br><span class="line"><span class="comment">// fromCamelCase('someJavascriptProperty', '_') -&gt; 'some_javascript_property'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="repeatString"><a href="#repeatString" class="headerlink" title="repeatString"></a>repeatString</h3><p>Repeats a string n times using <code>String.repeat()</code></p>
<p>If no string is provided the default is <code>&quot;&quot;</code> and the default number of times is 2.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> repeatString = <span class="function">(<span class="params">str = <span class="string">''</span>, num = <span class="number">2</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> num &gt;= <span class="number">0</span> ? str.repeat(num) : str;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// repeatString("abc",3) -&gt; 'abcabcabc'</span></span><br><span class="line"><span class="comment">// repeatString("abc") -&gt; 'abcabc'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="reverseString"><a href="#reverseString" class="headerlink" title="reverseString"></a>reverseString</h3><p>Reverses a string.</p>
<p>Use <code>split(&#39;&#39;)</code> and <code>Array.reverse()</code> to reverse the order of the characters in the string.<br>Combine characters to get a string using <code>join(&#39;&#39;)</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reverseString = <span class="function"><span class="params">str</span> =&gt;</span> str.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>);</span><br><span class="line"><span class="comment">// reverseString('foobar') -&gt; 'raboof'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="sortCharactersInString"><a href="#sortCharactersInString" class="headerlink" title="sortCharactersInString"></a>sortCharactersInString</h3><p>Alphabetically sorts the characters in a string.</p>
<p>Split the string using <code>split(&#39;&#39;)</code>, <code>Array.sort()</code> utilizing <code>localeCompare()</code>, recombine using <code>join(&#39;&#39;)</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sortCharactersInString = <span class="function"><span class="params">str</span> =&gt;</span></span><br><span class="line">  str.split(<span class="string">''</span>).sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.localeCompare(b)).join(<span class="string">''</span>);</span><br><span class="line"><span class="comment">// sortCharactersInString('cabbage') -&gt; 'aabbceg'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="toCamelCase"><a href="#toCamelCase" class="headerlink" title="toCamelCase"></a>toCamelCase</h3><p>Converts a string to camelcase.</p>
<p>Break the string into words and combine them capitalizing the first letter of each word.<br>For more detailed explanation of this Regex, <a href="https://regex101.com/r/bMCgAB/1" target="_blank" rel="noopener">visit this Site</a>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> toCamelCase = <span class="function"><span class="params">str</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> s = str &amp;&amp; str.match(<span class="regexp">/[A-Z]&#123;2,&#125;(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g</span>)</span><br><span class="line">    .map(<span class="function"><span class="params">x</span> =&gt;</span> x.slice(<span class="number">0</span>, <span class="number">1</span>).toUpperCase() + x.slice(<span class="number">1</span>).toLowerCase())</span><br><span class="line">    .join(<span class="string">''</span>);</span><br><span class="line">  <span class="keyword">return</span> s.slice(<span class="number">0</span>, <span class="number">1</span>).toLowerCase() + s.slice(<span class="number">1</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// toCamelCase("some_database_field_name") -&gt; 'someDatabaseFieldName'</span></span><br><span class="line"><span class="comment">// toCamelCase("Some label that needs to be camelized") -&gt; 'someLabelThatNeedsToBeCamelized'</span></span><br><span class="line"><span class="comment">// toCamelCase("some-javascript-property") -&gt; 'someJavascriptProperty'</span></span><br><span class="line"><span class="comment">// toCamelCase("some-mixed_string with spaces_underscores-and-hyphens") -&gt; 'someMixedStringWithSpacesUnderscoresAndHyphens'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="toKebabCase"><a href="#toKebabCase" class="headerlink" title="toKebabCase"></a>toKebabCase</h3><p>Converts a string to kebab case.</p>
<p>Break the string into words and combine them using <code>-</code> as a separator.<br>For more detailed explanation of this Regex, <a href="https://regex101.com/r/bMCgAB/1" target="_blank" rel="noopener">visit this Site</a>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> toKebabCase = <span class="function"><span class="params">str</span> =&gt;</span></span><br><span class="line">  str &amp;&amp; str.match(<span class="regexp">/[A-Z]&#123;2,&#125;(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g</span>)</span><br><span class="line">    .map(<span class="function"><span class="params">x</span> =&gt;</span> x.toLowerCase())</span><br><span class="line">    .join(<span class="string">'-'</span>);</span><br><span class="line"><span class="comment">// toKebabCase("camelCase") -&gt; 'camel-case'</span></span><br><span class="line"><span class="comment">// toKebabCase("some text") -&gt; 'some-text'</span></span><br><span class="line"><span class="comment">// toKebabCase("some-mixed_string With spaces_underscores-and-hyphens") -&gt; 'some-mixed-string-with-spaces-underscores-and-hyphens'</span></span><br><span class="line"><span class="comment">// toKebabCase("AllThe-small Things") -&gt; "all-the-small-things"</span></span><br><span class="line"><span class="comment">// toKebabCase('IAmListeningToFMWhileLoadingDifferentURLOnMyBrowserAndAlsoEditingSomeXMLAndHTML') -&gt; "i-am-listening-to-fm-while-loading-different-url-on-my-browser-and-also-editing-xml-and-html"</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="toSnakeCase"><a href="#toSnakeCase" class="headerlink" title="toSnakeCase"></a>toSnakeCase</h3><p>Converts a string to snake case.</p>
<p>Break the string into words and combine them using <code>_</code> as a separator.<br>For more detailed explanation of this Regex, <a href="https://regex101.com/r/bMCgAB/1" target="_blank" rel="noopener">visit this Site</a>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> toSnakeCase = <span class="function"><span class="params">str</span> =&gt;</span> &#123;</span><br><span class="line">  str &amp;&amp; str.match(<span class="regexp">/[A-Z]&#123;2,&#125;(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g</span>)</span><br><span class="line">    .map(<span class="function"><span class="params">x</span> =&gt;</span> x.toLowerCase())</span><br><span class="line">    .join(<span class="string">'_'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// toSnakeCase("camelCase") -&gt; 'camel_case'</span></span><br><span class="line"><span class="comment">// toSnakeCase("some text") -&gt; 'some_text'</span></span><br><span class="line"><span class="comment">// toSnakeCase("some-javascript-property") -&gt; 'some_javascript_property'</span></span><br><span class="line"><span class="comment">// toSnakeCase("some-mixed_string With spaces_underscores-and-hyphens") -&gt; 'some_mixed_string_with_spaces_underscores_and_hyphens'</span></span><br><span class="line"><span class="comment">// toSnakeCase("AllThe-small Things") -&gt; "all_the_small_things"</span></span><br><span class="line"><span class="comment">// toSnakeCase('IAmListeningToFMWhileLoadingDifferentURLOnMyBrowserAndAlsoEditingSomeXMLAndHTML') -&gt; "i_am_listening_to_fm_while_loading_different_url_on_my_browser_and_also_editing_some_xml_and_html"</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="truncateString"><a href="#truncateString" class="headerlink" title="truncateString"></a>truncateString</h3><p>Truncates a string up to a specified length.</p>
<p>Determine if the string’s <code>length</code> is greater than <code>num</code>.<br>Return the string truncated to the desired length, with <code>...</code> appended to the end or the original string.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> truncateString = <span class="function">(<span class="params">str, num</span>) =&gt;</span></span><br><span class="line">  str.length &gt; num ? str.slice(<span class="number">0</span>, num &gt; <span class="number">3</span> ? num - <span class="number">3</span> : num) + <span class="string">'...'</span> : str;</span><br><span class="line"><span class="comment">// truncateString('boomerang', 7) -&gt; 'boom...'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="words"><a href="#words" class="headerlink" title="words"></a>words</h3><p>Converts a given string into an array of words.</p>
<p>Use <code>String.split()</code> with a supplied pattern (defaults to non-alpha as a regex) to convert to an array of strings. Use <code>Array.filter()</code> to remove any empty strings.<br>Omit the second argument to use the default regex.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> words = <span class="function">(<span class="params">str, pattern = <span class="regexp">/[^a-zA-Z-]+/</span></span>) =&gt;</span> str.split(pattern).filter(<span class="built_in">Boolean</span>);</span><br><span class="line"><span class="comment">// words("I love javaScript!!") -&gt; ["I", "love", "javaScript"]</span></span><br><span class="line"><span class="comment">// words("python, javaScript &amp; coffee") -&gt; ["python", "javaScript", "coffee"]</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h2 id="Utility-1"><a href="#Utility-1" class="headerlink" title="Utility"></a>Utility</h2><h3 id="coalesce"><a href="#coalesce" class="headerlink" title="coalesce"></a>coalesce</h3><p>Returns the first non-null/undefined argument.</p>
<p>Use <code>Array.find()</code> to return the first non <code>null</code>/<code>undefined</code> argument.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> coalesce = <span class="function">(<span class="params">...args</span>) =&gt;</span> args.find(<span class="function"><span class="params">_</span> =&gt;</span> ![<span class="literal">undefined</span>, <span class="literal">null</span>].includes(_));</span><br><span class="line"><span class="comment">// coalesce(null,undefined,"",NaN, "Waldo") -&gt; ""</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="coalesceFactory"><a href="#coalesceFactory" class="headerlink" title="coalesceFactory"></a>coalesceFactory</h3><p>Returns a customized coalesce function that returns the first argument that returns <code>true</code> from the provided argument validation function.</p>
<p>Use <code>Array.find()</code> to return the first argument that returns <code>true</code> from the provided argument validation function.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> coalesceFactory = <span class="function"><span class="params">valid</span> =&gt;</span> (...args) =&gt; args.find(valid);</span><br><span class="line"><span class="comment">// const customCoalesce = coalesceFactory(_ =&gt; ![null, undefined, "", NaN].includes(_))</span></span><br><span class="line"><span class="comment">// customCoalesce(undefined, null, NaN, "", "Waldo") //-&gt; "Waldo"</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="extendHex"><a href="#extendHex" class="headerlink" title="extendHex"></a>extendHex</h3><p>Extends a 3-digit color code to a 6-digit color code.</p>
<p>Use <code>Array.map()</code>, <code>split()</code> and <code>Array.join()</code> to join the mapped array for converting a 3-digit RGB notated hexadecimal color-code to the 6-digit form.<br><code>String.slice()</code> is used to remove <code>#</code> from string start since it’s added once.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> extendHex = <span class="function"><span class="params">shortHex</span> =&gt;</span></span><br><span class="line">  <span class="string">'#'</span> + shortHex.slice(shortHex.startsWith(<span class="string">'#'</span>) ? <span class="number">1</span> : <span class="number">0</span>).split(<span class="string">''</span>).map(<span class="function"><span class="params">x</span> =&gt;</span> x + x).join(<span class="string">''</span>);</span><br><span class="line"><span class="comment">// extendHex('#03f') -&gt; '#0033ff'</span></span><br><span class="line"><span class="comment">// extendHex('05a') -&gt; '#0055aa'</span></span><br></pre></td></tr></table></figure></p>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="getType"><a href="#getType" class="headerlink" title="getType"></a>getType</h3><p>Returns the native type of a value.</p>
<p>Returns lowercased constructor name of value, “undefined” or “null” if value is undefined or null</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getType = <span class="function"><span class="params">v</span> =&gt;</span></span><br><span class="line">  v === <span class="literal">undefined</span> ? <span class="string">'undefined'</span> : v === <span class="literal">null</span> ? <span class="string">'null'</span> : v.constructor.name.toLowerCase();</span><br><span class="line"><span class="comment">// getType(new Set([1,2,3])) -&gt; "set"</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="hexToRGB"><a href="#hexToRGB" class="headerlink" title="hexToRGB"></a>hexToRGB</h3><p>Converts a color code to a <code>rgb()</code> or <code>rgba()</code> string if alpha value is provided.</p>
<p>Use bitwise right-shift operator and mask bits with <code>&amp;</code> (and) operator to convert a hexadecimal color code (with or without prefixed with <code>#</code>) to a string with the RGB values. If it’s 3-digit color code, first convert to 6-digit version. If an alpha value is provided alongside 6-digit hex, give <code>rgba()</code> string in return.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> hexToRGB = <span class="function"><span class="params">hex</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> alpha = <span class="literal">false</span>, h = hex.slice(hex.startsWith(<span class="string">'#'</span>) ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> (h.length === <span class="number">3</span>) h = [...h].map(<span class="function"><span class="params">x</span> =&gt;</span> x + x).join(<span class="string">''</span>);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (h.length === <span class="number">8</span>) alpha = <span class="literal">true</span>;</span><br><span class="line">  h = <span class="built_in">parseInt</span>(h, <span class="number">16</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'rgb'</span> + (alpha ? <span class="string">'a'</span> : <span class="string">''</span>) + <span class="string">'('</span> +</span><br><span class="line">    (h &gt;&gt;&gt; (alpha ? <span class="number">24</span> : <span class="number">16</span>)) + <span class="string">', '</span> +</span><br><span class="line">    ((h &amp; (alpha ? <span class="number">0x00ff0000</span> : <span class="number">0x00ff00</span>)) &gt;&gt;&gt; (alpha ? <span class="number">16</span> : <span class="number">8</span>)) + <span class="string">', '</span> +</span><br><span class="line">    ((h &amp; (alpha ? <span class="number">0x0000ff00</span> : <span class="number">0x0000ff</span>)) &gt;&gt;&gt; (alpha ? <span class="number">8</span> : <span class="number">0</span>)) +</span><br><span class="line">    (alpha ? <span class="string">`, <span class="subst">$&#123;(h &amp; <span class="number">0x000000ff</span>)&#125;</span>`</span> : <span class="string">''</span>) + <span class="string">')'</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// hexToRGB('#27ae60ff') -&gt; 'rgba(39, 174, 96, 255)'</span></span><br><span class="line"><span class="comment">// hexToRGB('27ae60') -&gt; 'rgb(39, 174, 96)'</span></span><br><span class="line"><span class="comment">// hexToRGB('#fff') -&gt; 'rgb(255, 255, 255)'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="isArray"><a href="#isArray" class="headerlink" title="isArray"></a>isArray</h3><p>Checks if the given argument is an array.</p>
<p>Use <code>Array.isArray()</code> to check if a value is classified as an array.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isArray = <span class="function"><span class="params">val</span> =&gt;</span> !!val &amp;&amp; <span class="built_in">Array</span>.isArray(val);</span><br><span class="line"><span class="comment">// isArray(null) -&gt; false</span></span><br><span class="line"><span class="comment">// isArray([1]) -&gt; true</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="isBoolean"><a href="#isBoolean" class="headerlink" title="isBoolean"></a>isBoolean</h3><p>Checks if the given argument is a native boolean element.</p>
<p>Use <code>typeof</code> to check if a value is classified as a boolean primitive.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isBoolean = <span class="function"><span class="params">val</span> =&gt;</span> <span class="keyword">typeof</span> val === <span class="string">'boolean'</span>;</span><br><span class="line"><span class="comment">// isBoolean(null) -&gt; false</span></span><br><span class="line"><span class="comment">// isBoolean(false) -&gt; true</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="isFunction"><a href="#isFunction" class="headerlink" title="isFunction"></a>isFunction</h3><p>Checks if the given argument is a function.</p>
<p>Use <code>typeof</code> to check if a value is classified as a function primitive.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isFunction = <span class="function"><span class="params">val</span> =&gt;</span> val &amp;&amp; <span class="keyword">typeof</span> val === <span class="string">'function'</span>;</span><br><span class="line"><span class="comment">// isFunction('x') -&gt; false</span></span><br><span class="line"><span class="comment">// isFunction(x =&gt; x) -&gt; true</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="isNumber"><a href="#isNumber" class="headerlink" title="isNumber"></a>isNumber</h3><p>Checks if the given argument is a number.</p>
<p>Use <code>typeof</code> to check if a value is classified as a number primitive.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isNumber = <span class="function"><span class="params">val</span> =&gt;</span> <span class="keyword">typeof</span> val === <span class="string">'number'</span>;</span><br><span class="line"><span class="comment">// isNumber('1') -&gt; false</span></span><br><span class="line"><span class="comment">// isNumber(1) -&gt; true</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="isString"><a href="#isString" class="headerlink" title="isString"></a>isString</h3><p>Checks if the given argument is a string.</p>
<p>Use <code>typeof</code> to check if a value is classified as a string primitive.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isString = <span class="function"><span class="params">val</span> =&gt;</span> <span class="keyword">typeof</span> val === <span class="string">'string'</span>;</span><br><span class="line"><span class="comment">// isString(10) -&gt; false</span></span><br><span class="line"><span class="comment">// isString('10') -&gt; true</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="isSymbol"><a href="#isSymbol" class="headerlink" title="isSymbol"></a>isSymbol</h3><p>Checks if the given argument is a symbol.</p>
<p>Use <code>typeof</code> to check if a value is classified as a symbol primitive.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isSymbol = <span class="function"><span class="params">val</span> =&gt;</span> <span class="keyword">typeof</span> val === <span class="string">'symbol'</span>;</span><br><span class="line"><span class="comment">// isSymbol('x') -&gt; false</span></span><br><span class="line"><span class="comment">// isSymbol(Symbol('x')) -&gt; true</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="randomHexColor"><a href="#randomHexColor" class="headerlink" title="randomHexColor"></a>randomHexColor</h3><p>Generates a random hexadecimal color code.</p>
<p>Use <code>Math.random</code> to generate a random 24-bit(6x4bits) hexadecimal number. Use bit shifting and then convert it to an hexadecimal String using <code>toString(16)</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> randomHexColor = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> n = (<span class="built_in">Math</span>.random() * <span class="number">0xfffff</span> | <span class="number">0</span>).toString(<span class="number">16</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'#'</span> + (n.length !== <span class="number">6</span></span><br><span class="line">        ? (<span class="built_in">Math</span>.random() * <span class="number">0xf</span> | <span class="number">0</span>).toString(<span class="number">16</span>) + n : n);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// randomHexColorCode() -&gt; "#e34155"</span></span><br><span class="line"><span class="comment">// randomHexColorCode() -&gt; "#fd73a6"</span></span><br><span class="line"><span class="comment">// randomHexColorCode() -&gt; "#4144c6"</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="RGBToHex"><a href="#RGBToHex" class="headerlink" title="RGBToHex"></a>RGBToHex</h3><p>Converts the values of RGB components to a color code.</p>
<p>Convert given RGB parameters to hexadecimal string using bitwise left-shift operator (<code>&lt;&lt;</code>) and <code>toString(16)</code>, then <code>padStart(6,&#39;0&#39;)</code> to get a 6-digit hexadecimal value.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> RGBToHex = <span class="function">(<span class="params">r, g, b</span>) =&gt;</span> ((r &lt;&lt; <span class="number">16</span>) + (g &lt;&lt; <span class="number">8</span>) + b).toString(<span class="number">16</span>).padStart(<span class="number">6</span>, <span class="string">'0'</span>);</span><br><span class="line"><span class="comment">// RGBToHex(255, 165, 1) -&gt; 'ffa501'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="timeTaken"><a href="#timeTaken" class="headerlink" title="timeTaken"></a>timeTaken</h3><p>Measures the time taken by a function to execute.</p>
<p>Use <code>console.time()</code> and <code>console.timeEnd()</code> to measure the difference between the start and end times to determine how long the callback took to execute.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> timeTaken = <span class="function"><span class="params">callback</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.time(<span class="string">'timeTaken'</span>); <span class="keyword">const</span> r = callback();</span><br><span class="line">  <span class="built_in">console</span>.timeEnd(<span class="string">'timeTaken'</span>); <span class="keyword">return</span> r;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// timeTaken(() =&gt; Math.pow(2, 10)) -&gt; 1024</span></span><br><span class="line"><span class="comment">// (logged): timeTaken: 0.02099609375ms</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="toDecimalMark"><a href="#toDecimalMark" class="headerlink" title="toDecimalMark"></a>toDecimalMark</h3><p>Use <code>toLocaleString()</code> to convert a float-point arithmetic to the <a href="https://en.wikipedia.org/wiki/Decimal_mark" target="_blank" rel="noopener">Decimal mark</a> form. It makes a comma separated string from a number.</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> toDecimalMark = <span class="function"><span class="params">num</span> =&gt;</span> num.toLocaleString(<span class="string">'en-US'</span>);</span><br><span class="line"><span class="comment">// toDecimalMark(12305030388.9087) -&gt; "12,305,030,388.9087"</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="toOrdinalSuffix"><a href="#toOrdinalSuffix" class="headerlink" title="toOrdinalSuffix"></a>toOrdinalSuffix</h3><p>Adds an ordinal suffix to a number.</p>
<p>Use the modulo operator (<code>%</code>) to find values of single and tens digits.<br>Find which ordinal pattern digits match.<br>If digit is found in teens pattern, use teens ordinal.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> toOrdinalSuffix = <span class="function"><span class="params">num</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> int = <span class="built_in">parseInt</span>(num), digits = [(int % <span class="number">10</span>), (int % <span class="number">100</span>)],</span><br><span class="line">    ordinals = [<span class="string">'st'</span>, <span class="string">'nd'</span>, <span class="string">'rd'</span>, <span class="string">'th'</span>], oPattern = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    tPattern = [<span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>];</span><br><span class="line">  <span class="keyword">return</span> oPattern.includes(digits[<span class="number">0</span>]) &amp;&amp; !tPattern.includes(digits[<span class="number">1</span>]) ? int + ordinals[digits[<span class="number">0</span>] - <span class="number">1</span>] : int + ordinals[<span class="number">3</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// toOrdinalSuffix("123") -&gt; "123rd"</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="UUIDGenerator"><a href="#UUIDGenerator" class="headerlink" title="UUIDGenerator"></a>UUIDGenerator</h3><p>Generates a UUID.</p>
<p>Use <code>crypto</code> API to generate a UUID, compliant with <a href="https://www.ietf.org/rfc/rfc4122.txt" target="_blank" rel="noopener">RFC4122</a> version 4.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> UUIDGenerator = <span class="function"><span class="params">()</span> =&gt;</span></span><br><span class="line">  ([<span class="number">1e7</span>] + <span class="number">-1e3</span> + <span class="number">-4e3</span> + <span class="number">-8e3</span> + <span class="number">-1e11</span>).replace(<span class="regexp">/[018]/g</span>, c =&gt;</span><br><span class="line">    (c ^ crypto.getRandomValues(<span class="keyword">new</span> <span class="built_in">Uint8Array</span>(<span class="number">1</span>))[<span class="number">0</span>] &amp; <span class="number">15</span> &gt;&gt; c / <span class="number">4</span>).toString(<span class="number">16</span>)</span><br><span class="line">  );</span><br><span class="line"><span class="comment">// UUIDGenerator() -&gt; '7982fcfe-5721-4632-bede-6000885be57d'</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h3 id="validateNumber"><a href="#validateNumber" class="headerlink" title="validateNumber"></a>validateNumber</h3><p>Returns <code>true</code> if the given value is a number, <code>false</code> otherwise.</p>
<p>Use <code>!isNaN</code> in combination with <code>parseFloat()</code> to check if the argument is a number.<br>Use <code>isFinite()</code> to check if the number is finite.<br>Use <code>Number()</code> to check if the coercion holds.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> validateNumber = <span class="function"><span class="params">n</span> =&gt;</span> !<span class="built_in">isNaN</span>(<span class="built_in">parseFloat</span>(n)) &amp;&amp; <span class="built_in">isFinite</span>(n) &amp;&amp; <span class="built_in">Number</span>(n) == n;</span><br><span class="line"><span class="comment">// validateNumber('10') -&gt; true</span></span><br></pre></td></tr></table></figure>
<p><a href="#table-of-contents">⬆ back to top</a></p>
<h2 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h2><p><em>Icons made by <a href="https://www.flaticon.com/authors/smashicons" target="_blank" rel="noopener">Smashicons</a> from <a href="https://www.flaticon.com/" target="_blank" rel="noopener">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank" rel="noopener">CC 3.0 BY</a>.</em></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">javascript</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="../../2017/12/25/30-seconds-of-code/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Project-4-of-Statistics" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="../../2017/12/15/Project-4-of-Statistics/">Project 4 of Statistics.md</a>
    </h1>
  

        
        <a href="../../2017/12/15/Project-4-of-Statistics/" class="archive-article-date">
  	<time datetime="2017-12-15T09:40:41.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-12-15</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Homework-6"><a href="#Homework-6" class="headerlink" title="Homework 6"></a>Homework 6</h2><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><blockquote>
<p>Prove that $\hat \sigma^2 = \dfrac{SS_E}{(a-1)(b-1)}$ is the unbiased estimation of $\sigma^2$</p>
</blockquote>
<p>What we learned is that</p>
<p>$$<br>\begin{align<em>}<br>SS<em>T &amp;= \sum</em>{i=1}^a \sum<em>{j=1}^b (y</em>{ij} - \bar y)^2 \<br>&amp;= \sum<em>{i=1}^a \sum</em>{j=1}^b (y<em>{ij} - \bar y</em>{i\cdot} - \bar y<em>{\cdot j} + \bar y + \bar y</em>{i\cdot} - \bar y + \bar y<em>{j\cdot} - \bar y)^2 \<br>&amp;= \underbrace{\sum</em>{i=1}^a \sum<em>{j=1}^b (y</em>{ij} - \bar y<em>{i\cdot} - \bar y</em>{\cdot j} + \bar y)^2}_{SS<em>E} + \underbrace{\sum</em>{i=1}^a b(\bar y<em>{i\cdot} - \bar y)^2}</em>{SS<em>A} + \underbrace{\sum</em>{j=1}^b a(\bar y<em>{\cdot j} - \bar y)^2}</em>{SS_B} \<br>\end{align</em>}<br>$$</p>
<p>For clarity, we give the corresponding matrix form:</p>
<p>$$<br>\begin{align<em>}<br>SS<em>T &amp;= y’(I</em>{ab} - \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)y \<br>&amp;= y’\Big( (I<em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) + (A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) + (B-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) \Big)y \<br>&amp;= \underbrace{y’(I</em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)y}_{SS<em>E} + \underbrace{ y’(A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’)y }</em>{SS<em>A} + \underbrace{ (B-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) }</em>{SS_B}<br>\end{align</em>}<br>$$</p>
<p>where</p>
<p>$$<br>\begin{align<em>}<br>&amp;A = \underbrace{\frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’ \oplus \cdots \oplus \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}<em>b’}</em>{a \text{ items}} = (I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’) \<br>&amp;B = \underbrace{\frac{1}{b}\boldsymbol{1}_a\boldsymbol{1}_a’ \oplus \cdots \oplus \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}<em>a’}</em>{b \text{ items}} = (I_b \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’)<br>\end{align</em>}<br>$$</p>
<p>By property of tensor product, we declare that<br>$A$ and $B$ are symmetric and idempotent.</p>
<p>$$<br>\begin{align<em>}<br>A^2 &amp;= (I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’) \cdot (I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’) = (I_a\cdot I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’ \cdot \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’) \<br>&amp;= I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’ = A \<br>B^2 &amp;= (I_b \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’) \cdot (I_a \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’) = (I_b\cdot I_b \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’ \cdot \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’) \<br>&amp;= I_b \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’ = B \<br>\end{align</em>}<br>$$</p>
<p>Hence, we claim that $I<em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’$, $A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’$ and $B-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}_{ab}’$ are symmetric and idempotent, with their rank equal to trace:</p>
<p>$$<br>\begin{align<em>}<br>&amp;\mathrm{rank}(I<em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) = (a-1)(b-1) \<br>&amp;\mathrm{rank}(A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) = a-1 \<br>&amp;\mathrm{rank}(B-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}_{ab}’) = b-1<br>\end{align</em>}<br>$$</p>
<p>Thus, under the normal hypothesis $Y \sim N(0, \sigma^2 I)$, we have</p>
<p>$$<br>\begin{align<em>}<br>&amp;\frac{Y’(I<em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’)Y}{\sigma^2} \sim \chi^2\Big((a-1)(b-1)\Big) \<br>&amp;\frac{Y’(A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’)Y}{\sigma^2} \sim \chi^2(a-1) \quad \frac{Y’(B-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}_{ab}’)Y}{\sigma^2} \sim \chi^2(b-1)<br>\end{align</em>}<br>$$</p>
<p>Now, it is sufficient to say $\dfrac{SS_E}{(a-1)(b-1)}$ is the unbiased estimation of $\sigma^2$.</p>
<h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><blockquote>
<p>Prove that both of $SS_A$ and $SS_B$ are independent with $SS_E$</p>
</blockquote>
<p>Note that $\boldsymbol{1}_{ab} = I_a \otimes \boldsymbol{1}_b\boldsymbol{1}_b’ = I_b \otimes \boldsymbol{1}_a\boldsymbol{1}_a’$, it is easy to find that</p>
<p>$$<br>\begin{align<em>}<br>&amp;A\cdot \boldsymbol{1}_{ab} = (I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}_b’) \cdot I_a \otimes \boldsymbol{1}_b\boldsymbol{1}_b’ = I_a \otimes \boldsymbol{1}_b\boldsymbol{1}<em>b’ = \boldsymbol{1}</em>{ab} \<br>&amp;B\cdot \boldsymbol{1}_{ab} = (I_b \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’) \cdot I_b \otimes \boldsymbol{1}_a\boldsymbol{1}_a’ = I_b \otimes \boldsymbol{1}_a\boldsymbol{1}<em>a’ = \boldsymbol{1}</em>{ab}<br>\end{align</em>}<br>$$</p>
<p>Now, based on the derivation of question <a href="###1.">1</a>, it suffices to show that</p>
<p>$$<br>\begin{align<em>}<br>&amp; (I<em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) (A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) = 0 \<br>&amp; (I</em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’) (B-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’) = 0<br>\end{align</em>}<br>$$</p>
<p>By symmetry, we only give the derivation of the first equation, the second is similar to this work.</p>
<p>$$<br>\begin{align<em>}<br>&amp; (I<em>{ab}-A-B+\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) (A-\frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’) \<br>&amp;= [I</em>{ab}-B-(A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)] (A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’) \<br>&amp;= (I-B)(A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’) - (A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)^2 \<br>&amp;= A - BA - \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ + \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ - (A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)^2 \<br>&amp;= A - BA - (A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’) \<br>&amp;= \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ - BA \<br>&amp;= \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ - (I_b \otimes \frac{1}{a}\boldsymbol{1}_a\boldsymbol{1}_a’)(I_a \otimes \frac{1}{b}\boldsymbol{1}_b\boldsymbol{1}<em>b’)\<br>&amp;= \frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}_{ab}’ - \frac{1}{ab} (I_b\boldsymbol{1}_b\boldsymbol{1}_b’ \otimes I_a\boldsymbol{1}_a\boldsymbol{1}<em>a’ ) \<br>&amp;= \frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}_{ab}’ - \frac{1}{ab} (\boldsymbol{1}_b\boldsymbol{1}_b’ \otimes \boldsymbol{1}_a\boldsymbol{1}<em>a’ ) \<br>&amp;= \frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}<em>{ab}’ - \frac{1}{ab}\boldsymbol{1}</em>{ab}\boldsymbol{1}_{ab}’ \<br>&amp;= 0<br>\end{align</em>}<br>$$</p>
<p>The detailed matrix $A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’$ is idempotent since</p>
<p>$$<br>\begin{align<em>}<br>(A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)^2 &amp;= (A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’)(A-\frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’) \<br>&amp;= A^2 - \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’A - \frac{1}{ab}A\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ + \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ \<br>&amp;= A^2 - \frac{2}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ + \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’ \<br>&amp;= A - \frac{1}{ab}\boldsymbol{1}<em>{ab}\boldsymbol{1}</em>{ab}’<br>\end{align</em>}<br>$$</p>
<p>Hence the independency is proved, which furthermore indicates the fact that under the hypothesis $H_1$</p>
<p>$$<br>F_A = \frac{SS_A/(a-1)}{SS<em>E/(a-1)(b-1)} \sim F</em>{a-1, (a-1)(b-1)}<br>$$</p>
<p>Similarly, under the hypothesis $H_2$</p>
<p>$$<br>F_B = \frac{SS_B/(b-1)}{SS<em>E/(a-1)(b-1)} \sim F</em>{b-1, (a-1)(b-1)}<br>$$</p>
<h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><blockquote>
<p>Prove that $c’\beta$ is an estimable function $ \iff\, c \in \mathcal{M}(X’)$</p>
</blockquote>
<p>$c’\beta$ is said to be <em>estimable</em> if and only if there is a linear function of $y$, such that $a’y$ is an unbiased estimator of $c’\beta$ (for arbitrary $\beta$ ), i.e.</p>
<p>$$<br>\begin{align<em>}<br>E(a’y) = c’\beta \quad \forall \beta\in\mathbb{R}^p &amp;\iff a’X\beta = c’\beta \quad \forall \beta\in\mathbb{R}^p \<br>&amp;\iff a’X = c \<br>&amp;\iff c = X’a \in \mathcal{M}(X’)<br>\end{align</em>}<br>$$</p>
<h3 id="4-Project"><a href="#4-Project" class="headerlink" title="4. Project"></a>4. Project</h3><h4 id="One-way-ANCOVA"><a href="#One-way-ANCOVA" class="headerlink" title="One-way ANCOVA"></a>One-way ANCOVA</h4><p>This example comes from the <em>litter</em> dataset in the multcomp package. Pregnant mice were divided into four treatment groups; each group received a different dose of a drug (0, 5, 50, or 500). The mean post-birth weight for each litter was the dependent variable and gestation time was included as a <strong>covariate</strong>.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data(litter, package=<span class="string">"multcomp"</span>)</span><br><span class="line"><span class="keyword">attach</span>(litter)</span><br><span class="line">table(dose)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dose</span><br><span class="line">  <span class="number">0</span>   <span class="number">5</span>  <span class="number">50</span> <span class="number">500</span></span><br><span class="line"> <span class="number">20</span>  <span class="number">19</span>  <span class="number">18</span>  <span class="number">17</span></span><br></pre></td></tr></table></figure>
<p>From the <code>table()</code> function we can see that there are an unequal number of litters at each dosage level.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aggregate(weight, by=list(dose), FUN=mean)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  Group.1        x</span><br><span class="line"><span class="number">1</span>       <span class="number">0</span> <span class="number">32.30850</span></span><br><span class="line"><span class="number">2</span>       <span class="number">5</span> <span class="number">29.30842</span></span><br><span class="line"><span class="number">3</span>      <span class="number">50</span> <span class="number">29.86611</span></span><br><span class="line"><span class="number">4</span>     <span class="number">500</span> <span class="number">29.64647</span></span><br></pre></td></tr></table></figure>
<p>Based on the group means provided by the <code>aggregate()</code> function, the <em>no-drug</em> group had the highest mean litter weight.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit &lt;- aov(weight ~ gesttime + dose)</span><br><span class="line">summary(fit)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Df Sum Sq Mean Sq <span class="literal">F</span> value  Pr(&gt;<span class="literal">F</span>)</span><br><span class="line">gesttime     <span class="number">1</span>  <span class="number">134.3</span>  <span class="number">134.30</span>   <span class="number">8.049</span> <span class="number">0.00597</span> **</span><br><span class="line">dose         <span class="number">3</span>  <span class="number">137.1</span>   <span class="number">45.71</span>   <span class="number">2.739</span> <span class="number">0.04988</span> *</span><br><span class="line">Residuals   <span class="number">69</span> <span class="number">1151.3</span>   <span class="number">16.69</span></span><br><span class="line">---</span><br><span class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>The ANCOVA F tests indicate that</p>
<ol>
<li>gestation time was related to birth weight</li>
<li>drug dosage was related to birth weight after controlling for gestation time.</li>
</ol>
<p>Furthermore, the <code>effects</code> package provides a powerful method of obtaining the adjusted means.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(effects)</span><br><span class="line">effect(<span class="string">"dose"</span>, fit)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> dose effect</span><br><span class="line">dose</span><br><span class="line">       <span class="number">0</span>        <span class="number">5</span>       <span class="number">50</span>      <span class="number">500</span></span><br><span class="line"><span class="number">32.35367</span> <span class="number">28.87672</span> <span class="number">30.56614</span> <span class="number">29.33460</span></span><br></pre></td></tr></table></figure>
<p>But in this case, the adjusted means are similar to unadjusted one produced by the <code>aggregate()</code> function.</p>
<p>Now, suppose we are interested in whether the no-drug condition differs from the three-drug condition. We can use the multcomp package to test specific defined hypothesis about the means.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(multcomp)</span><br><span class="line">contrast &lt;- rbind(<span class="string">"no drug vs. drug"</span> = c(<span class="number">3</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>))</span><br><span class="line">summary(glht(fit, linfct=mcp(dose=contrast)))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">	 Simultaneous Tests <span class="keyword">for</span> General Linear hypothesis</span><br><span class="line"></span><br><span class="line">Multiple Comparisons of Means: User-defined Contrasts</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Fit: aov(formula = weight ~ gesttime + dose)</span><br><span class="line"></span><br><span class="line">Linear hypothesis:</span><br><span class="line">                      Estimate Std. Error t value Pr(&gt;|t|)</span><br><span class="line">no drug vs. drug == <span class="number">0</span>    <span class="number">8.284</span>      <span class="number">3.209</span>   <span class="number">2.581</span>    <span class="number">0.012</span> *</span><br><span class="line">---</span><br><span class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line">(Adjusted p values reported -- single-step method)</span><br></pre></td></tr></table></figure>
<p>The contrast <code>c(3, -1, -1, -1)</code> specifies a comparison of the first group with the average of the other three. The hypothesis is tested with a t-statistics, which is significant at the $p&lt;0.05$ level.</p>
<p>Therefore, we can conclude that the no-drug group has a higher birth weight than drug conditions.</p>
<h5 id="Assessing-test-assumptions"><a href="#Assessing-test-assumptions" class="headerlink" title="Assessing test assumptions"></a>Assessing test assumptions</h5><p>In this case, it is assumed that the regression slope for predicting birth weight from gestation time is the same in each of four treatment groups. A test for the homogeneity of regression slopes can be obtained by including a <code>gestation*dose</code> interaction term in ANCOVA model.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit2 &lt;- aov(weight ~ gesttime*dose, data=litter)</span><br><span class="line">summary(fit2)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">              Df Sum Sq Mean Sq <span class="literal">F</span> value  Pr(&gt;<span class="literal">F</span>)</span><br><span class="line">gesttime       <span class="number">1</span>  <span class="number">134.3</span>  <span class="number">134.30</span>   <span class="number">8.289</span> <span class="number">0.00537</span> **</span><br><span class="line">dose           <span class="number">3</span>  <span class="number">137.1</span>   <span class="number">45.71</span>   <span class="number">2.821</span> <span class="number">0.04556</span> *</span><br><span class="line">gesttime:dose  <span class="number">3</span>   <span class="number">81.9</span>   <span class="number">27.29</span>   <span class="number">1.684</span> <span class="number">0.17889</span></span><br><span class="line">Residuals     <span class="number">66</span> <span class="number">1069.4</span>   <span class="number">16.20</span></span><br><span class="line">---</span><br><span class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>The interaction is nonsignificant, supporting the assumption of equality of slopes. That’s to say, the relationship between gestation and birth weight does not depend on the level of dose variable.</p>
<h5 id="Visualizing-the-results"><a href="#Visualizing-the-results" class="headerlink" title="Visualizing the results"></a>Visualizing the results</h5><p>The <code>ancova()</code> function in the <code>HH</code> package provides a plot of the relationship between the dependent variable, the covariate, and the factor.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(HH)</span><br><span class="line">ancova(weight ~ gesttime + dose, data=litter)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistics/project4/one-way.svg" width="400" height="300"><br></div>

<p>Here we can see that the regression lines for predicting birth weight from gestation time are parallel in each group but have differetn intercepts. As gestation time increases, birth weight increases. Additionally, we can see that 0-dose group has the largest intercept and the 5-dose group has the lowest intercept.</p>
<p>Now we use the statement <code>ancova(weight ~ gesttime*dose)</code> instead to generate a plot that allows both the slopes and intercepts to vary by group.</p>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistics/project4/one-way2.svg" width="400" height="300"><br></div>

<h4 id="Two-way-factorial-ANOVA"><a href="#Two-way-factorial-ANOVA" class="headerlink" title="Two-way factorial ANOVA"></a>Two-way factorial ANOVA</h4><p>This example uses the <code>ToothGrowth</code> dataset in the base installation to demonstrate a two-way between-groups ANOVA. 60 guinea pigs are randomly assigned to receive one of three levels of ascorbic acid ($0.5$, $1$, or $2$ mg) and one of two delivery methods (orange juice or Vitamin C), under the restriction that each treatment combination has 10 guinea pigs. The dependent variable is tooth length.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">attach</span>(ToothGrowth)</span><br><span class="line">table(supp, dose)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    dose</span><br><span class="line">supp <span class="number">0.5</span>  <span class="number">1</span>  <span class="number">2</span></span><br><span class="line">  OJ  <span class="number">10</span> <span class="number">10</span> <span class="number">10</span></span><br><span class="line">  VC  <span class="number">10</span> <span class="number">10</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>The <code>table</code> statement indicates that we have a balanced design (equal sample sizes in each cell of the design), and the next two <code>aggregate</code> statements provide the cell means and standard deviations.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aggregate(len, by=list(supp, dose), FUN=mean)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  Group.1 Group.2     x</span><br><span class="line"><span class="number">1</span>      OJ     <span class="number">0.5</span> <span class="number">13.23</span></span><br><span class="line"><span class="number">2</span>      VC     <span class="number">0.5</span>  <span class="number">7.98</span></span><br><span class="line"><span class="number">3</span>      OJ     <span class="number">1.0</span> <span class="number">22.70</span></span><br><span class="line"><span class="number">4</span>      VC     <span class="number">1.0</span> <span class="number">16.77</span></span><br><span class="line"><span class="number">5</span>      OJ     <span class="number">2.0</span> <span class="number">26.06</span></span><br><span class="line"><span class="number">6</span>      VC     <span class="number">2.0</span> <span class="number">26.14</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aggregate(len, by=list(supp, dose), FUN=sd)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  Group.1 Group.2        x</span><br><span class="line"><span class="number">1</span>      OJ     <span class="number">0.5</span> <span class="number">4.459709</span></span><br><span class="line"><span class="number">2</span>      VC     <span class="number">0.5</span> <span class="number">2.746634</span></span><br><span class="line"><span class="number">3</span>      OJ       <span class="number">1</span> <span class="number">3.910953</span></span><br><span class="line"><span class="number">4</span>      VC       <span class="number">1</span> <span class="number">2.515309</span></span><br><span class="line"><span class="number">5</span>      OJ       <span class="number">2</span> <span class="number">2.655058</span></span><br><span class="line"><span class="number">6</span>      VC       <span class="number">2</span> <span class="number">4.797731</span></span><br></pre></td></tr></table></figure>
<p>The below ANOVA table provided by the <code>summary()</code> function indicates that both main effects (<code>supp</code> and <code>dose</code>) and the interaction between these factors are significant.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dose &lt;- factor(dose)</span><br><span class="line">fit &lt;- aov(len ~ supp*dose)</span><br><span class="line">summary(fit)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">            Df Sum Sq Mean Sq <span class="literal">F</span> value   Pr(&gt;<span class="literal">F</span>)</span><br><span class="line">supp         <span class="number">1</span>  <span class="number">205.4</span>   <span class="number">205.4</span>  <span class="number">15.572</span> <span class="number">0.000231</span> ***</span><br><span class="line">dose         <span class="number">2</span> <span class="number">2426.4</span>  <span class="number">1213.2</span>  <span class="number">92.000</span>  &lt; <span class="number">2e-16</span> ***</span><br><span class="line">supp:dose    <span class="number">2</span>  <span class="number">108.3</span>    <span class="number">54.2</span>   <span class="number">4.107</span> <span class="number">0.021860</span> *</span><br><span class="line">Residuals   <span class="number">54</span>  <span class="number">712.1</span>    <span class="number">13.2</span></span><br><span class="line">---</span><br><span class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>Furthermore, we can use the <code>interaction2wt()</code> function in the <code>HH</code> package to produce a plot of both main effects and two-way interactions for any factorial design of any order.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(HH)</span><br><span class="line">interaction2wt(len ~ supp*dose)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistics/project4/two-way.svg" width="400" height="300"><br></div>

<p>The above graph indicates that tooth growth increases with the dose of ascorbic acid for both orange juice and Vitamin C. For the $0.5$ and $1$ mg doses, orange juice produced more tooth growth than Vitamin C. For $2$ mg of ascorbic acid, both delivery methods produced identical growth.</p>
<hr>
<p><em>Kai Liu, wrote on 2017/12/14</em></p>
<p><em>Student ID: 116071910015</em></p>
<p><em>Mail: liu1995@sjtu.edu.cn</em></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">r</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">statistic</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="../../2017/12/15/Project-4-of-Statistics/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Project-3-of-Statistics" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="../../2017/12/01/Project-3-of-Statistics/">Project 3 of Statistics.md</a>
    </h1>
  

        
        <a href="../../2017/12/01/Project-3-of-Statistics/" class="archive-article-date">
  	<time datetime="2017-12-01T12:39:50.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-12-01</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Homework-5"><a href="#Homework-5" class="headerlink" title="Homework 5"></a>Homework 5</h2><h3 id="13-13"><a href="#13-13" class="headerlink" title="13.13"></a>13.13</h3><p>The gamma probability density function is</p>
<p>$$<br>f(y,r,\lambda) = \frac{\lambda^r}{\Gamma(r)} e^{-\lambda y} y^{r-1}, \quad\text{for } y,\lambda\geq 0<br>$$</p>
<p>Show that the gamma is a member of the exponential family.</p>
<p><em>Proof:</em></p>
<p>Since</p>
<p>$$<br>\begin{align<em>}<br>f(y,r,\lambda) &amp;= \exp\lbrace r\log\lambda - \log\Gamma(\lambda) - \lambda y + (r-1)\log y \rbrace \<br>&amp;= \exp\lbrace \underbrace{(\frac{\lambda}{r} y - \log\frac{\lambda}{r})/(-\frac1r)}<em>{[\theta y - b(\theta)]/a(\phi)} + \underbrace{(r-1)\log y - \log\Gamma(r) + r\log r}</em>{h(y,\phi)} \rbrace<br>\end{align</em>}<br>$$</p>
<p>Set $\theta = \dfrac{\lambda}{r}$, $\phi = r$, we can derive that $b(\theta) = \log(\theta)$, $a(\phi) = -\dfrac1r$</p>
<p>$$<br>h(y,\phi) = (\phi-1)\log y - \log\Gamma(\phi) + \phi\log\phi<br>$$</p>
<p>Thus<br>$$<br>\begin{align<em>}<br>&amp;E(y) = \frac{\mathrm{d} b(\theta)}{\mathrm{d} b(\theta)} = \frac{1}{\theta} = \frac{r}{\lambda} \<br>&amp;\mathrm{Var}(y) = \frac{\mathrm{d}^2 b(\theta)}{\mathrm{d}\theta^2} \cdot a(\phi) = \frac{r}{\lambda^2}<br>\end{align</em>}<br>$$</p>
<h3 id="13-14"><a href="#13-14" class="headerlink" title="13.14"></a>13.14</h3><p>The exponential porbabilty density function is</p>
<p>$$<br>f(y,\lambda) = \lambda e^{-\lambda y}, \quad\text{for } y,\lambda\geq 0<br>$$</p>
<p>Show that the exponential distribution is a member of the exponential family.</p>
<p><em>Proof:</em></p>
<p>Notice the exponential distribution is a special case of gamma distribution.</p>
<p>$$<br>f(y, \lambda) = \exp(-\lambda y + \log\lambda)<br>$$</p>
<p>Set $\theta = -\lambda$, $b(\theta) = -\log\lambda = -\log(-\theta)$, with respect to $\phi = 1$, $a(\phi) = 1$ and $h(y,\phi)=0$</p>
<p>Thus, similar result can be derived</p>
<p>$$<br>\begin{align<em>}<br>&amp;E(y) = \frac{\mathrm{d}b(\theta)}{\mathrm{d}\theta} = \frac{1}{\lambda} \<br>&amp;\mathrm{Var}(y) = \frac{\mathrm{d}^2 b(\theta)}{\mathrm{d}\theta^2}\cdot1 = \frac{1}{\lambda^2}<br>\end{align</em>}<br>$$</p>
<p>which indicates the distribution to be a member of NEF.</p>
<h3 id="13-15"><a href="#13-15" class="headerlink" title="13.15"></a>13.15</h3><p>The negative binomial probabilty mass function is</p>
<p>$$<br>f(y,\pi,\alpha) = \binom{y+\alpha-1}{\alpha-1} \pi^{\alpha}(1-\pi)^y \quad\text{for } y=0,1,\ldots,\alpha&gt;0 \text{ and } 0\leq\pi\leq 1<br>$$</p>
<p>Show that the negative binomial is a memeber of the exponential family.</p>
<p><em>Proof:</em></p>
<p>$$<br>\begin{align<em>}<br>f(y,\pi,\alpha) &amp;= \binom{y+\alpha-1}{\alpha-1} \pi^{\alpha}(1-\pi)^y \<br>&amp;= \frac{\alpha}{y+\alpha} \binom{y+\alpha}{y}\pi^{\alpha}(1-\pi)^y \<br>\text{Set }n=y+\alpha\quad &amp;= (1-\frac{y}{n})\binom{n}{y}\pi^{n-y}(1-\pi)^y \<br>&amp;= \exp\Big{ (n-y)\log\pi+y\log(1-\pi)+\log (1-\frac{y}{n})\binom{n}{y} \Big} \<br>&amp;= \exp\Big{ \underbrace{\Big( \frac{y}{n}\log\frac{1-\pi}{\pi} + \log\pi \Big)}<em>{y\theta + b(\theta)}/\frac1n + \underbrace{\log (1-\frac{y}{n})\binom{n}{y}}</em>{h(y,\phi)} \Big}<br>\end{align</em>}<br>$$</p>
<p>Set<br>$$<br>\begin{align<em>}<br>&amp;\theta=\log\frac{1-\pi}{\pi} \<br>&amp;b(\theta)=-\log\pi = \log(1+e^{\theta})<br>\end{align</em>}<br>$$</p>
<p>with respect to $\phi=1$, $a(\phi)=\dfrac1n$, $h(y,\phi)=\log (1-\dfrac{y}{n})\binom{n}{y}$</p>
<p>Thus</p>
<p>$$<br>\begin{align<em>}<br>&amp;E(y) = \frac{\mathrm{d}b(\theta)}{\mathrm{d}\theta} = \frac{e^\theta}{1+e^\theta} = 1-\pi \<br>&amp;\mathrm{Var}(y) = \frac{\mathrm{d}^2 b(\theta)}{\mathrm{d}\theta^2}\cdot a(\phi) = \frac1n\cdot\frac{e^\theta}{(1+e^\theta)^2} = \frac1n\pi(1-\pi)<br>\end{align</em>}<br>$$</p>
<h3 id="13-16"><a href="#13-16" class="headerlink" title="13.16"></a>13.16</h3><p>The data in the table below are from an experiment designed to study the advance rate $y$ of a drill. The four design factors are $x_1$=load, $x_2$=flow, $x_3$=drilling speed, and $x_4$=type of drilling mud (the original experiment is described by Cuthbert Daniel in his 1976 book on industrial experimentation).</p>
<table width="400"><br>| Observation | $x_1$ | $x_2$ | $x_3$ | $x_4$ | Advance Rate, $y$ |<br>| ———– | —– | —– | —– | —– | —————– |<br>| 1           | -     | -     | -     | -     | 1.68              |<br>| 2           | +     | -     | -     | -     | 1.98              |<br>| 3           | -     | +     | -     | -     | 3.28              |<br>| 4           | +     | +     | -     | -     | 3.44              |<br>| 5           | -     | -     | +     | -     | 4.98              |<br>| 6           | +     | -     | +     | -     | 5.70              |<br>| 7           | -     | +     | +     | -     | 9.97              |<br>| 8           | +     | +     | +     | -     | 9.07              |<br>| 9           | -     | -     | -     | +     | 2.07              |<br>| 10          | +     | -     | -     | +     | 2.44              |<br>| 11          | -     | +     | -     | +     | 4.09              |<br>| 12          | +     | +     | -     | +     | 4.53              |<br>| 13          | -     | -     | +     | +     | 7.77              |<br>| 14          | +     | -     | +     | +     | 9.43              |<br>| 15          | -     | +     | +     | +     | 11.75             |<br>| 16          | +     | +     | +     | +     | 16.30             |<br></table>

<blockquote>
<p>Fit a generalized linear model to the advance rate response. Use a gamma response distribution and a log link, and include all four regressors in the linear predictor.</p>
</blockquote>
<p>First, we write all these data into a csv file named <code>drill</code> and import it into R dataframe.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- read.table(<span class="string">"/path/to/drill.csv"</span>, header = <span class="literal">TRUE</span>, sep = <span class="string">","</span>)</span><br></pre></td></tr></table></figure>
<p>To study the advance rate of a drill, we need to transform the columns into dichotomous factor called <code>load</code>, <code>flow</code>, <code>speed</code>, <code>type</code> with the following code.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">data$load[data$x1==<span class="string">"+"</span>] &lt;- <span class="number">1</span></span><br><span class="line">data$load[data$x1==<span class="string">"-"</span>] &lt;- <span class="number">0</span></span><br><span class="line"></span><br><span class="line">data$flow[data$x2==<span class="string">"+"</span>] &lt;- <span class="number">1</span></span><br><span class="line">data$flow[data$x2==<span class="string">"-"</span>] &lt;- <span class="number">0</span></span><br><span class="line"></span><br><span class="line">data$speed[data$x3==<span class="string">"+"</span>] &lt;- <span class="number">1</span></span><br><span class="line">data$speed[data$x3==<span class="string">"-"</span>] &lt;- <span class="number">0</span></span><br><span class="line"></span><br><span class="line">data$type[data$x4==<span class="string">"+"</span>] &lt;- <span class="number">1</span></span><br><span class="line">data$type[data$x4==<span class="string">"-"</span>] &lt;- <span class="number">0</span></span><br><span class="line"></span><br><span class="line">table(data$load)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> <span class="number">1</span></span><br><span class="line"><span class="number">8</span> <span class="number">8</span></span><br></pre></td></tr></table></figure>
<p>The dichotomous factor can now be used as the outcome variable in a regression model using gamma response distribution and a log link.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit.full &lt;- glm(y ~ load + flow + speed + type, data, family=Gamma(link = <span class="string">"log"</span>))</span><br><span class="line">summary(fit.full)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Call:</span><br><span class="line">glm(formula = y ~ load + flow + speed + type, family = Gamma(link = <span class="string">"log"</span>),</span><br><span class="line">    data = data)</span><br><span class="line"></span><br><span class="line">Deviance Residuals:</span><br><span class="line">      Min         1Q     Median         3Q        Max</span><br><span class="line">-<span class="number">0.162931</span>  -<span class="number">0.057552</span>   <span class="number">0.006942</span>   <span class="number">0.060239</span>   <span class="number">0.128465</span></span><br><span class="line"></span><br><span class="line">Coefficients:</span><br><span class="line">            Estimate Std. Error t value Pr(&gt;|t|)</span><br><span class="line">(Intercept)  <span class="number">0.50269</span>    <span class="number">0.05435</span>   <span class="number">9.250</span> <span class="number">1.60e-06</span> ***</span><br><span class="line">load         <span class="number">0.13126</span>    <span class="number">0.04861</span>   <span class="number">2.700</span>   <span class="number">0.0206</span> *</span><br><span class="line">flow         <span class="number">0.58123</span>    <span class="number">0.04861</span>  <span class="number">11.957</span> <span class="number">1.21e-07</span> ***</span><br><span class="line">speed        <span class="number">1.15728</span>    <span class="number">0.04861</span>  <span class="number">23.808</span> <span class="number">8.18e-11</span> ***</span><br><span class="line">type         <span class="number">0.32690</span>    <span class="number">0.04861</span>   <span class="number">6.725</span> <span class="number">3.26e-05</span> ***</span><br><span class="line">---</span><br><span class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">(Dispersion parameter <span class="keyword">for</span> Gamma family taken to be <span class="number">0.009451408</span>)</span><br><span class="line"></span><br><span class="line">    Null deviance: <span class="number">7.02517</span>  on <span class="number">15</span>  degrees of freedom</span><br><span class="line">Residual deviance: <span class="number">0.10527</span>  on <span class="number">11</span>  degrees of freedom</span><br><span class="line">AIC: <span class="number">28.17</span></span><br><span class="line"></span><br><span class="line">Number of Fisher Scoring iterations: <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>From the p-values for the regression coefficients (last column), we can see that <code>load</code>, <code>flow</code>, <code>speed</code> and <code>type</code> may make a significant contribution to the equation. Thus, we can reject the hypothesis that the parameters are $0$. That is to say, each regression coefficient in the model is statistically significant $(p&lt;0.5)$.</p>
<!-- b. Find the model deviance for the GLM from part a. Does this indicate that the model is satisfactory? -->
<p>Let’s take a look at the regression coefficients:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">coef(fit.full)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(Intercept)        load        flow       speed        type</span><br><span class="line">  <span class="number">0.5026869</span>   <span class="number">0.1312552</span>   <span class="number">0.5812258</span>   <span class="number">1.1572823</span>   <span class="number">0.3268990</span></span><br></pre></td></tr></table></figure>
<p>Since log(odds) are difficult to interpret, we can exponentiate them to put the result on an odds scale:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp(coef(fit.full))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(Intercept)        load        flow       speed        type</span><br><span class="line">   <span class="number">1.653157</span>    <span class="number">1.140259</span>    <span class="number">1.788229</span>    <span class="number">3.181276</span>    <span class="number">1.386661</span></span><br></pre></td></tr></table></figure>
<p>Now, we can see that the advance rate of a drill is increased by a factor of <code>1.140259</code> for one-unit increase in drill load (holding flow, speed and type constant). Similar increasing trend can be detected in other factors. Because the predictor variables can’t equal 0, the intercept isn’t meaningfull in this case.</p>
<p>Also, we can use the <code>confint()</code> function to obtain confident intervals for the coefficients.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp(confint(fit.full))</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">               <span class="number">2.5</span> %   <span class="number">97.5</span> %</span><br><span class="line">(Intercept) <span class="number">1.488639</span> <span class="number">1.839411</span></span><br><span class="line">load        <span class="number">1.036550</span> <span class="number">1.254344</span></span><br><span class="line">flow        <span class="number">1.625624</span> <span class="number">1.967101</span></span><br><span class="line">speed       <span class="number">2.891712</span> <span class="number">3.499836</span></span><br><span class="line">type        <span class="number">1.260412</span> <span class="number">1.525555</span></span><br></pre></td></tr></table></figure>
<p>97.5 percent confidence intervals fro each of the coefficients on an odds scale are printed above.</p>
<p>Finally, we use compare the residual deviance with the residual degrees of freedom to detect the overdispersion.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deviance(fit.full)/df.residual(fit.full)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">0.009570289</span></span><br></pre></td></tr></table></figure>
<p>which is far away from 1, suggesting the overdispersion.</p>
<p>Deviance can be draw by the command</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fit.full$deviance</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>] <span class="number">0.1052732</span></span><br></pre></td></tr></table></figure>
<h3 id="Bonus-Problems"><a href="#Bonus-Problems" class="headerlink" title="Bonus Problems"></a>Bonus Problems</h3><h4 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h4><blockquote>
<p>Prove that the deduction matrix of variance $\mathrm{Var}(\hat\beta^*<em>{q+1}) - \mathrm{Var}(\hat\beta</em>{q+1})$ is positive semidefinite.</p>
</blockquote>
<p>What we knew is that</p>
<p>$$<br>\begin{align<em>}<br>&amp;\mathrm{Var}(\hat\beta^</em>) = \sigma^2(X’X)^{-1} \<br>&amp;\mathrm{Var}(\hat\beta^<em><em>{q+1}) = \sigma^2(X</em>{q+1}’X_{q+1})^{-1}<br>\end{align</em>}<br>$$</p>
<p>where $X = \left( \begin{array}{c:c} X_{q+1} &amp; X_r \end{array}\right)$.</p>
<p>Consider the normal matrix</p>
<p>$$<br>X’X = \begin{pmatrix}<br>X<em>{q+1}’X</em>{q+1} &amp; X_{q+1}’X_r \<br>X<em>r’X</em>{q+1} &amp; X_r’X<em>r<br>\end{pmatrix} = \begin{pmatrix}<br>\Sigma</em>{11} &amp; \Sigma<em>{12} \<br>\Sigma</em>{21} &amp; \Sigma_{22}<br>\end{pmatrix}<br>$$</p>
<p>Inverse of this bolck matrix is already given as</p>
<blockquote>
<p>$$<br>\begin{pmatrix}<br>\Sigma<em>{11} &amp; \Sigma</em>{12} \<br>\Sigma<em>{21} &amp; \Sigma</em>{22} \<br>\end{pmatrix}^{-1} =\, \begin{pmatrix}<br>\Sigma<em>{11}^{-1}+\Sigma</em>{11}^{-1}\Sigma<em>{12}\Sigma</em>{22.1}^{-1}\Sigma<em>{21}\Sigma</em>{11}^{-1} &amp; -\Sigma<em>{11}^{-1}\Sigma</em>{12}\Sigma<em>{22.1}^{-1} \<br>-\Sigma</em>{22.1}^{-1}\Sigma<em>{21}\Sigma</em>{11}^{-1} &amp; \Sigma_{22.1}^{-1} \<br>\end{pmatrix}<br>$$</p>
<p>where<br>$$<br>\Sigma<em>{22.1}=\Sigma</em>{22}-\Sigma<em>{21}\Sigma</em>{11}^{-1}\Sigma_{12}<br>$$</p>
</blockquote>
<p>Thus, we say the first entry of the inverse matrix should be</p>
<p>$$<br>\Sigma<em>{11}^{-1}+\Sigma</em>{11}^{-1}\Sigma<em>{12}\Sigma</em>{22.1}^{-1}\Sigma<em>{21}\Sigma</em>{11}^{-1}<br>$$</p>
<p>Set $A = \Sigma<em>{11}^{-1}\Sigma</em>{12} = (X<em>{q+1}’X</em>{q+1})^{-1}\cdot(X_{q+1}’X_r)$ to be the alias matrix. Hence we have</p>
<p>$$<br>\mathrm{Var}(\hat\beta^*<em>{q+1}) - \mathrm{Var}(\hat\beta</em>{q+1}) = \sigma^2 A\big(X_r’X_r - X<em>r’X</em>{q+1}A\big)^{-1}\,A’<br>$$</p>
<p>which is obviously positive semidefinite.</p>
<h4 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h4><blockquote>
<p>Prove that</p>
<p>$$<br>F = \dfrac{SS_A/(a-1)}{SS<em>E/(n-a)} \sim F</em>{a-1, n-a}<br>$$</p>
<p>under the hypothesis $H_0$.</p>
</blockquote>
<p>What we learned is that</p>
<p>$$<br>\begin{align<em>}<br>SS<em>T &amp;= \sum</em>{i=1}^a \sum_{j=1}^{n<em>i} (y</em>{ij} - \bar y)^2 \<br>&amp;= \sum<em>{i=1}^a \sum</em>{j=1}^{n<em>i} (y</em>{ij} - \bar y<em>{i\cdot} + \bar y</em>{i\cdot} - \bar y)^2 \<br>&amp;= \underbrace{\sum<em>{i=1}^a \sum</em>{j=1}^{n<em>i} (y</em>{ij} - \bar y<em>{i\cdot})^2}</em>{SS<em>E} + \underbrace{\sum</em>{i=1}^a \sum_{j=1}^{n<em>i} (\bar y</em>{i\cdot} - \bar y)^2}_{SS_A}<br>\end{align</em>}<br>$$</p>
<p>For clarity, we give the coresponding matrix form:</p>
<p>$$<br>\begin{align<em>}<br>SS<em>T &amp;= y’(I-\frac1n \boldsymbol{1}\boldsymbol{1}’)y \<br>&amp;= y’(I - A + A - \frac1n \boldsymbol{1}\boldsymbol{1}’)y \<br>&amp;= \underbrace{y’(I - A)y}</em>{SS<em>E} + \underbrace{y’(A - \frac1n \boldsymbol{1}\boldsymbol{1}’)y}</em>{SS_A}<br>\end{align</em>}<br>$$</p>
<p>where $A = \dfrac{1}{n<em>1}\boldsymbol{1}</em>{n<em>1}\boldsymbol{1}</em>{n_1}’ \oplus \cdots \oplus \dfrac{1}{n<em>a}\boldsymbol{1}</em>{n<em>a}\boldsymbol{1}</em>{n_a}’$</p>
<p>Since $\boldsymbol{1}_{n<em>i}’\boldsymbol{1}</em>{n_i} = n<em>i$, we know that $I</em>{n_i} - \dfrac{1}{n<em>i}\boldsymbol{1}</em>{n<em>i}\boldsymbol{1}</em>{n_i}’$ is a Household matrix, which is definitely symetric and idempotent. i.e.</p>
<p>$$<br>A’=A \qquad A^2 = A<br>$$</p>
<p>Next, we assume that $B=I-A$, $C=A-\dfrac1n\boldsymbol{1}\boldsymbol{1}’$</p>
<p>We claim that</p>
<p>$$<br>\begin{align<em>}<br>&amp;B’=B \qquad B^2 = B \<br>&amp;C’=C \qquad C^2 = C<br>\end{align</em>}<br>$$</p>
<p>with its rank</p>
<p>$$<br>\mathrm{rank}(B)=n-a \quad \mathrm{rank}(C)=a-1<br>$$</p>
<p>Thus, under the normal hyperthesis $Y\sim N(0,\sigma^2I)$, we have</p>
<p>$$<br>\begin{align<em>}<br>&amp;\frac{Y’BY}{\sigma^2} \sim \chi^2(n-a) \<br>&amp;\frac{Y’CY}{\sigma^2} \sim \chi^2(a-1)<br>\end{align</em>}<br>$$</p>
<p>together with</p>
<p>$$<br>\begin{align<em>}<br>BC &amp;= (I-A)(A-\frac1n\boldsymbol{1}\boldsymbol{1}’) \<br>&amp;= A-\frac1n\boldsymbol{1}\boldsymbol{1}’-A^2+\frac1n A\boldsymbol{1}\boldsymbol{1}’ \<br>&amp;= A-\frac1n\boldsymbol{1}\boldsymbol{1}’-A+\frac1n\boldsymbol{1}\boldsymbol{1}’ \<br>&amp;= 0<br>\end{align</em>}<br>$$</p>
<p>The last two equation follows from the fact that</p>
<p>$$<br>\begin{align<em>}<br>A \cdot \boldsymbol{1} &amp;= \big( \frac{1}{n<em>1}\boldsymbol{1}</em>{n<em>1}\boldsymbol{1}</em>{n_1}’ \oplus \cdots \oplus \frac{1}{n<em>a}\boldsymbol{1}</em>{n<em>a}\boldsymbol{1}</em>{n<em>a}’ \big) \cdot \big(\boldsymbol{1}</em>{n<em>1} \oplus \cdots \oplus \boldsymbol{1}</em>{n_a}\big) \<br>&amp;= \frac{1}{n<em>1}\boldsymbol{1}</em>{n<em>1}\boldsymbol{1}</em>{n<em>1}’\boldsymbol{1}</em>{n_1} \oplus \cdots \oplus \frac{1}{n<em>a}\boldsymbol{1}</em>{n<em>a}\boldsymbol{1}</em>{n<em>a}’\boldsymbol{1}</em>{n<em>a} \<br>&amp;= \boldsymbol{1}</em>{n<em>1} \oplus \cdots \oplus \boldsymbol{1}</em>{n_a} = \boldsymbol{1}<br>\end{align</em>}<br>$$</p>
<p>Hence, we know that $Y’(I-A)Y$ and $Y’(A-\dfrac1n\boldsymbol{1}\boldsymbol{1}’)Y$ are mutually independent, which indicates</p>
<p>$$<br>F=\frac{Y’CY/(a-1)}{Y’BY/(n-a)} = \frac{SS_A/(a-1)}{SS<em>E/(n-a)} \sim F</em>{a-1, n-a}<br>$$</p>
<p>Furthermore, we can derive two unbiased estimates.</p>
<p>$$<br>\begin{align<em>}<br>E(SS_E) &amp;= E\big(Y’(I-A)Y\big) \<br>&amp;= \mu’(I-A)\mu + \mathrm{tr}\big((I-A)\sigma^2I\big) \<br>&amp;= \mu’\mu - \mu’A\mu + \sigma^2(n-a) \<br>&amp;= \sigma^2(n-a)<br>\end{align</em>}<br>$$</p>
<p>The last equation is derived from the hypothesis.</p>
<p>Similarly,</p>
<p>$$<br>\begin{align<em>}<br>E(SS_A) &amp;= E\big(Y’(A-\frac1n\boldsymbol{1}\boldsymbol{1}’)Y\big) \<br>&amp;= \mu’(A-\frac1n\boldsymbol{1}\boldsymbol{1}’)\mu + \mathrm{tr}\big((A-\frac1n\boldsymbol{1}\boldsymbol{1}’)\sigma^2I\big) \<br>&amp;= \mu’\mu - \mu’A\mu + \sigma^2(a-1) \<br>&amp;= \sigma^2(a-1)<br>\end{align</em>}<br>$$</p>
<p>That’s to say</p>
<p>$$<br>E\big(SS_E/(n-a)\big) = E\big(SS_A/(a-1)\big) = \sigma^2<br>$$</p>
<hr>
<p><em>Kai Liu, wrote on 2017/11/28</em></p>
<p><em>Student ID: 116071910015</em></p>
<p><em>Mail: liu1995@sjtu.edu.cn</em></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">r</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">statistic</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="../../2017/12/01/Project-3-of-Statistics/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-julia基于GLM包的线性回归" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="../../2017/11/29/julia基于GLM包的线性回归/">julia基于GLM包的线性回归</a>
    </h1>
  

        
        <a href="../../2017/11/29/julia基于GLM包的线性回归/" class="archive-article-date">
  	<time datetime="2017-11-29T13:49:51.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-11-29</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本文利用GLM包进行简单线性回归分析，同时对模型检验以及置信区间作图。</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> GLM,DataFrames</span><br></pre></td></tr></table></figure>
<p>先随机生成一组数据用于回归分析。</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置截距</span></span><br><span class="line">α = <span class="number">100</span></span><br><span class="line"><span class="comment"># 设置系数</span></span><br><span class="line">β = <span class="number">5</span></span><br><span class="line"><span class="comment"># 设置随机数个数</span></span><br><span class="line">n = <span class="number">50</span></span><br><span class="line"><span class="comment"># 设置误差项</span></span><br><span class="line">ε = rand(Normal(),n) * <span class="number">11</span></span><br><span class="line"><span class="comment"># 生成数据</span></span><br><span class="line">x = randn(n)*<span class="number">3</span></span><br><span class="line">y = α + β * x + ε</span><br><span class="line">dataForRegression = DataFrame(x = x, y = y)</span><br></pre></td></tr></table></figure>
<table class="data-frame"><thead><tr><th></th><th>x</th><th>y</th></tr></thead><tbody><tr><th>1</th><td>-0.2945844765867794</td><td>95.47303779965895</td></tr><tr><th>2</th><td>-1.3440842917796316</td><td>100.32164951469537</td></tr><tr><th>3</th><td>1.3037018863265355</td><td>109.57629236830104</td></tr><tr><th>4</th><td>4.012507916775679</td><td>106.46933242509654</td></tr><tr><th>5</th><td>-1.7321051747524616</td><td>89.55844065579969</td></tr><tr><th>6</th><td>-1.4253325394154235</td><td>92.72629790575935</td></tr><tr><th>7</th><td>-0.9042631229720477</td><td>87.93522916305417</td></tr><tr><th>8</th><td>3.4865202058421714</td><td>127.92951823278281</td></tr><tr><th>9</th><td>-2.134433785764415</td><td>94.20802706899649</td></tr><tr><th>10</th><td>3.322020816866826</td><td>118.04216195389577</td></tr><tr><th>11</th><td>2.203086430462482</td><td>105.55320230669415</td></tr><tr><th>12</th><td>-5.281962503754427</td><td>82.8888784146054</td></tr><tr><th>13</th><td>2.001897730730764</td><td>108.02467262087006</td></tr><tr><th>14</th><td>-2.7543838829327565</td><td>88.76348948674855</td></tr><tr><th>15</th><td>6.101614682211077</td><td>128.6239736717972</td></tr><tr><th>16</th><td>0.6888033886810481</td><td>111.17457991815601</td></tr><tr><th>17</th><td>0.7010819245192449</td><td>107.39681268065465</td></tr><tr><th>18</th><td>3.1116548996809783</td><td>113.4549225848041</td></tr><tr><th>19</th><td>-1.8511960189357837</td><td>83.79388935398916</td></tr><tr><th>20</th><td>-0.962664244723129</td><td>91.41543924802386</td></tr><tr><th>21</th><td>0.5608348467513868</td><td>90.8605217368299</td></tr><tr><th>22</th><td>2.1522594774515786</td><td>93.8105103626811</td></tr><tr><th>23</th><td>-0.31022032825520746</td><td>101.53069848453823</td></tr><tr><th>24</th><td>1.6256993827235733</td><td>104.12765249398367</td></tr><tr><th>25</th><td>3.3214081526457813</td><td>118.46644563889394</td></tr><tr><th>26</th><td>0.43501963025212675</td><td>95.810320259296</td></tr><tr><th>27</th><td>2.59876092609342</td><td>121.9741328977443</td></tr><tr><th>28</th><td>-1.0290269848902651</td><td>113.72423797098067</td></tr><tr><th>29</th><td>-0.21404769863190354</td><td>92.43405156194733</td></tr><tr><th>30</th><td>3.5537714568100016</td><td>99.06513391626848</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td></tr></tbody></table>



<p>使用<code>lm</code>函数进行线性回归分析：</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mod = lm(<span class="meta">@formula</span>(y ~ x), dataForRegression)</span><br></pre></td></tr></table></figure>
<pre><code>DataFrames.DataFrameRegressionModel{GLM.LinearModel{GLM.LmResp{Array{Float64,1}},GLM.DensePredChol{Float64,Base.LinAlg.Cholesky{Float64,Array{Float64,2}}}},Array{Float64,2}}

Formula: y ~ 1 + x

Coefficients:
             Estimate Std.Error t value Pr(&gt;|t|)
(Intercept)   99.8365   1.42361 70.1292   &lt;1e-49
x             5.19724  0.457037 11.3716   &lt;1e-14
</code></pre><p>另外一种等价的写法是：</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mod = fit(LinearModel, <span class="meta">@formula</span>(y ~ x), dataForRegression)</span><br></pre></td></tr></table></figure>
<pre><code>DataFrames.DataFrameRegressionModel{GLM.LinearModel{GLM.LmResp{Array{Float64,1}},GLM.DensePredChol{Float64,Base.LinAlg.Cholesky{Float64,Array{Float64,2}}}},Array{Float64,2}}

Formula: y ~ 1 + x

Coefficients:
             Estimate Std.Error t value Pr(&gt;|t|)
(Intercept)   99.8365   1.42361 70.1292   &lt;1e-49
x             5.19724  0.457037 11.3716   &lt;1e-14
</code></pre><p>故知回归系数为<code>5.19724</code>，截距为<code>99.8365</code>，所以最优拟合直线为 $y = 99.8365 + 5.19724x$。同时给出了标准差、t检验和p值等结果。</p>
<p>接下来对假设回归系数是 $0$ 进行FF检验。</p>
<p>原假设 $H_0: \beta = 0$，备选假设 $H_1: \beta\neq 0$</p>
<p>构造回归系数为 $0$ 的模型：</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nullmod = lm(<span class="meta">@formula</span>(y ~ <span class="number">1</span>), dataForRegression)</span><br></pre></td></tr></table></figure>
<pre><code>DataFrames.DataFrameRegressionModel{GLM.LinearModel{GLM.LmResp{Array{Float64,1}},GLM.DensePredChol{Float64,Base.LinAlg.Cholesky{Float64,Array{Float64,2}}}},Array{Float64,2}}

Formula: y ~ +1

Coefficients:
             Estimate Std.Error t value Pr(&gt;|t|)
(Intercept)   104.526   2.59199 40.3264   &lt;1e-38
</code></pre><p>假设回归系数为 $0$，则截距为 $y$ 的平均数。</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">isapprox(coef(nullmod)[<span class="number">1</span>], mean(dataForRegression[:y]))</span><br></pre></td></tr></table></figure>
<pre><code>true
</code></pre><p>GLM的<code>ftest</code>函数提供了回归模型的FF检验。</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftest(mod.model, nullmod.model)</span><br></pre></td></tr></table></figure>
<pre><code>        Res. DOF DOF ΔDOF        SSR        ΔSSR      R²    ΔR²       F*  p(&gt;F)
Model 1       48   3       4455.8890              0.7293
Model 2       49   2   -1 16460.1689 -12004.2799 -0.0000 0.7293 129.3132 &lt;1e-14
</code></pre><p>在此例中，$p&lt;0.05$，差异显著，拒绝 $\beta = 0$ 的假设，回归系数显著不为0，说明了回归方程有较高的有效性。而 $R^2=0.7293$ 也说明了随机变量 $x$ 与 $y$ 之间有相对高的关联程度。</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> RCall</span><br><span class="line"><span class="string">R"summary(lm(<span class="subst">$(dataForRegression[:x])</span> ~ <span class="subst">$(dataForRegression[:y])</span>))"</span></span><br></pre></td></tr></table></figure>
<pre><code>WARNING: Method definition ==(Base.Nullable{S}, Base.Nullable{T}) in module Base at nullable.jl:238 overwritten in module NullableArrays at /Users/kay/.julia/v0.6/NullableArrays/src/operators.jl:99.





RCall.RObject{RCall.VecSxp}

Call:
lm(formula = `#JL`$`(dataForRegression[:x])` ~ `#JL`$`(dataForRegression[:y])`)

Residuals:
    Min      1Q  Median      3Q     Max
-3.2220 -0.9915 -0.1898  0.7734  3.6579

Coefficients:
                                 Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                     -13.76511    1.30911  -10.52 4.77e-14 ***
`#JL`$`(dataForRegression[:y])`   0.14032    0.01234   11.37 3.19e-15 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.583 on 48 degrees of freedom
Multiple R-squared:  0.7293,    Adjusted R-squared:  0.7237
F-statistic: 129.3 on 1 and 48 DF,  p-value: 3.195e-15
</code></pre><p>以上是R的输出结果，除了小数点精度外，结果完全相同。</p>
<p>下面对回归结果做可视化。</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基本数据作图</span></span><br><span class="line"><span class="keyword">using</span> Gadfly</span><br><span class="line">plot(layer(dataForRegression,</span><br><span class="line">        x = :x,</span><br><span class="line">        y = :y,</span><br><span class="line">        Geom.point,),</span><br><span class="line">    layer(dataForRegression,</span><br><span class="line">        x = :x,</span><br><span class="line">        y = :y,</span><br><span class="line">        Geom.smooth(method = :lm),</span><br><span class="line">        color = [<span class="string">colorant"purple"</span>])</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/julia/GLM/output_17_0.svg"><br></div>

<p>函数<code>predict</code>返回的是回归值。残差定义为回归值与观测值之差。</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 残差点图</span></span><br><span class="line">resid = dataForRegression[:y] - predict(mod)</span><br><span class="line">plot(x = predict(mod),</span><br><span class="line">    y = resid,</span><br><span class="line">    Geom.point,</span><br><span class="line">    Guide.xlabel(<span class="string">"predict(mod)"</span>),</span><br><span class="line">    Guide.ylabel(<span class="string">"resid"</span>))</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/julia/GLM/output_19_0.svg"><br></div>

<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 残差线段图</span></span><br><span class="line">plot(dataForRegression, x = <span class="string">"x"</span>,</span><br><span class="line">    y = <span class="string">"y"</span>,</span><br><span class="line">    xend = <span class="string">"x"</span>,</span><br><span class="line">    yend = predict(mod),</span><br><span class="line">    Geom.segment)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/julia/GLM/output_20_0.svg"><br></div>

<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过Q-Q图的线性程度来检验残差的正态性。</span></span><br><span class="line">plot(x = Normal(), y = resid, Stat.qq, Geom.point,)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/julia/GLM/output_21_0.svg"><br></div>

<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制置信区间</span></span><br><span class="line">mod_predict_confidence = predict(mod,</span><br><span class="line">    hcat(ones(nrow(dataForRegression)), collect(dataForRegression[:,<span class="number">1</span>])),</span><br><span class="line">    :confint)</span><br><span class="line"></span><br><span class="line">plot(layer(dataForRegression,</span><br><span class="line">        x = <span class="string">"x"</span>,</span><br><span class="line">        y = <span class="string">"y"</span>,</span><br><span class="line">        Geom.point,</span><br><span class="line">        intercept = [coef(mod)[<span class="number">1</span>]],</span><br><span class="line">        slope = [coef(mod)[<span class="number">2</span>]],</span><br><span class="line">        Geom.abline),</span><br><span class="line">    layer(x = dataForRegression[:x],</span><br><span class="line">        y = mod_predict_confidence[:,<span class="number">2</span>],</span><br><span class="line">        Geom.point, Theme(default_color = <span class="string">"purple"</span>)),</span><br><span class="line">    layer(x = dataForRegression[:x],</span><br><span class="line">        y = mod_predict_confidence[:,<span class="number">3</span>],</span><br><span class="line">        Geom.point, Theme(default_color = <span class="string">"purple"</span>))</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/julia/GLM/output_22_0.svg"><br></div>



      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">julia</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="../../2017/11/29/julia基于GLM包的线性回归/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Project-2-of-Statistics" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="../../2017/11/17/Project-2-of-Statistics/">Project 2 of Statistics.md</a>
    </h1>
  

        
        <a href="../../2017/11/17/Project-2-of-Statistics/" class="archive-article-date">
  	<time datetime="2017-11-17T08:38:31.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-11-17</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h3><p>本次大作业按章节依次展示了岭估计、主成分估计、逐步回归和带示性变量的回归分析。</p>
<p>主要使用 <code>dplyr</code> 和 <code>readxl</code> 包导入数据并获得数据框视图；利用 <code>MASS</code> 和 <code>car</code> 包作岭迹图、主成分估计和逐步回归分析； <code>dummies</code> 包提供了将示性变量转换为特殊矩阵的可能；<code>bootstrap</code> 包帮助我们实现了 $k$ 重交叉验证。</p>
<p>所有文献和数据集均可在文末的参考文献链接中下载获得。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(dplyr)</span><br><span class="line"><span class="keyword">library</span>(readxl)</span><br><span class="line"><span class="keyword">library</span>(MASS)</span><br><span class="line"><span class="keyword">library</span>(car)</span><br><span class="line"><span class="keyword">library</span>(dummies)</span><br><span class="line"><span class="keyword">library</span>(bootstrap)</span><br></pre></td></tr></table></figure>
<h3 id="岭估计"><a href="#岭估计" class="headerlink" title="岭估计"></a>岭估计</h3><p>对《线性模型与回归分析》(王松桂)书习题3.19数据进行回归分析，十次试验得到的观测数据如下</p>
<table>
<thead>
<tr>
<th>$y$</th>
<th>16.3</th>
<th>16.8</th>
<th>19.2</th>
<th>18.0</th>
<th>19.5</th>
<th>20.9</th>
<th>21.1</th>
<th>20.9</th>
<th>20.3</th>
<th>22.0</th>
</tr>
</thead>
<tbody>
<tr>
<td>$X_1$</td>
<td>1.1</td>
<td>1.4</td>
<td>1.7</td>
<td>1.7</td>
<td>1.8</td>
<td>1.8</td>
<td>1.9</td>
<td>2.0</td>
<td>2.3</td>
<td>2.4</td>
</tr>
<tr>
<td>$X_2$</td>
<td>1.1</td>
<td>1.5</td>
<td>1.8</td>
<td>1.7</td>
<td>1.9</td>
<td>1.8</td>
<td>1.8</td>
<td>2.1</td>
<td>2.4</td>
<td>2.5</td>
</tr>
</tbody>
</table>
<p>首先导入数据并获得预览：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test &lt;- tbl_df(read_excel(<span class="string">"/path/to/test.xlsx"</span>))</span><br><span class="line"></span><br><span class="line">str(test)</span><br></pre></td></tr></table></figure>
<pre><code>Classes ‘tbl_df’, ‘tbl’ and &apos;data.frame&apos;:    10 obs. of  3 variables:
 $ y : num  16.3 16.8 19.2 18 19.5 20.9 21.1 20.9 20.3 22
 $ x1: num  1.1 1.4 1.7 1.7 1.8 1.8 1.9 2 2.3 2.4
 $ x2: num  1.1 1.5 1.8 1.7 1.9 1.8 1.8 2.1 2.4 2.5
</code></pre><p>下面假设数据满足线性模型:</p>
<p>$$<br>y=\beta_0 + \beta_1 x_1+ \beta_2 x_2 + e<br>$$</p>
<p>其中误差 $e$ 满足 Gauss-Markov 假设，最小二乘法估计参数 $\beta = (\beta_0, \beta_1, \beta_2)$.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">md1 &lt;- lm(y ~ x1 + x2, test)</span><br><span class="line"></span><br><span class="line">summary(md1)</span><br><span class="line"></span><br><span class="line">vif(md1)</span><br></pre></td></tr></table></figure>
<pre><code>Call:
lm(formula = y ~ x1 + x2, data = test)

Residuals:
    Min      1Q  Median      3Q     Max
-1.3107 -0.3727  0.1168  0.5054  1.1176

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   11.292      1.463   7.719 0.000114 ***
x1            11.307      4.719   2.396 0.047740 *
x2            -6.591      4.436  -1.486 0.180941
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9072 on 7 degrees of freedom
Multiple R-squared:  0.8267,    Adjusted R-squared:  0.7772
F-statistic:  16.7 on 2 and 7 DF,  p-value: 0.002167
</code></pre><dl class="dl-horizontal"><br>    <dt>x1</dt><br>        <dd>35.9628643396901</dd><br>    <dt>x2</dt><br>        <dd>35.9628643396901</dd><br></dl>



<p>由上可知预测变量 $x$ 的方差膨胀因子均大于30, 数据存在较严重的共线性, 于是考虑使用岭估计确定线形模型中的系数.</p>
<p>下面规定岭参数在 $(0,1)$ 中, 以 $0.1$ 为步长作出岭迹图：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">md2 &lt;- lm.ridge(y ~ x1 + x2, test, lambda = seq(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0.1</span>))</span><br><span class="line"></span><br><span class="line">plot(md2)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/project2/output_8_0.png" width="50%"><br></div>


<p>从图中发现当岭参数 $k=4$ 时, $\hat{\beta}(k)$的图像趋于平稳, 故选择</p>
<p>$$<br>\hat{\beta(4)}=(11.86099 ,\  4.480425, \ -0.25298675)<br>$$</p>
<h3 id="主成分估计"><a href="#主成分估计" class="headerlink" title="主成分估计"></a>主成分估计</h3><p>对《线性模型与回归分析》(王松桂)习题3.20数据进行回归分析。导入数据集 <code>commodity</code>:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">commodity &lt;- tbl_df(read_excel(<span class="string">"/path/to/commodity.xlsx"</span>))</span><br><span class="line"></span><br><span class="line">str(commodity)</span><br></pre></td></tr></table></figure>
<pre><code>Classes ‘tbl_df’, ‘tbl’ and &apos;data.frame&apos;:    10 obs. of  5 variables:
 $ y : num  8.4 9.6 10.4 11.4 12.2 14.2 15.8 17.9 19.6 20.8
 $ x1: num  82.9 88 99.9 105.3 117.7 ...
 $ x2: num  92 93 96 94 100 101 105 112 112 112
 $ x3: num  17.1 21.3 25.1 29 34 40 44 49 51 53
 $ x4: num  94 96 97 97 100 101 104 109 111 111
</code></pre><p>假设数据满足线性模型:</p>
<p>$$<br>y=\beta_0 + \beta_1 x_1+ \beta_2 x_2  +x_3 + x_4+ e<br>$$</p>
<p>误差 $e$ 满足Gauss - Markov 假设.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">md1 &lt;- lm(y ~ x1 + x2 + x3 + x4, commodity)</span><br><span class="line"></span><br><span class="line">summary(md1)</span><br><span class="line"></span><br><span class="line">vif(md1)</span><br></pre></td></tr></table></figure>
<pre><code>Call:
lm(formula = y ~ x1 + x2 + x3 + x4, data = commodity)

Residuals:
        1         2         3         4         5         6         7         8
 0.024803  0.079476  0.012381 -0.007025 -0.288345  0.216090 -0.142085  0.158360
        9        10
-0.135964  0.082310

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -17.66768    5.94360  -2.973  0.03107 *
x1            0.09006    0.02095   4.298  0.00773 **
x2           -0.23132    0.07132  -3.243  0.02287 *
x3            0.01806    0.03907   0.462  0.66328
x4            0.42075    0.11847   3.552  0.01636 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2037 on 5 degrees of freedom
Multiple R-squared:  0.9988,    Adjusted R-squared:  0.9978
F-statistic:  1021 on 4 and 5 DF,  p-value: 1.827e-07
</code></pre><dl class="dl-horizontal"><br>    <dt>x1</dt><br>        <dd>126.280159677426</dd><br>    <dt>x2</dt><br>        <dd>72.827434063754</dd><br>    <dt>x3</dt><br>        <dd>55.4395006902401</dd><br>    <dt>x4</dt><br>        <dd>125.122528952804</dd><br></dl>



<p>使用最小二乘法估计参数 $\beta$ , 发现回归系数 $\beta_3$ 不显著不为0，并且预测变量 $x$ 的方差膨胀因子均大于30, 数据存在较严重的共线性,考虑使用主成分回归估计参数.</p>
<p>使用样本的相关矩阵进行主成分分析：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pca &lt;- princomp(~ x1 + x2 + x3 + x4, commodity, cor=<span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line">summary(pca, loading=<span class="literal">TRUE</span>)</span><br><span class="line"></span><br><span class="line">pre &lt;- predict(pca)</span><br><span class="line"></span><br><span class="line">pre</span><br></pre></td></tr></table></figure>
<pre><code>Importance of components:
                          Comp.1      Comp.2     Comp.3       Comp.4
Standard deviation     1.9859037 0.199906992 0.11218966 0.0603085506
Proportion of Variance 0.9859534 0.009990701 0.00314663 0.0009092803
Cumulative Proportion  0.9859534 0.995944090 0.99909072 1.0000000000

Loadings:
   Comp.1 Comp.2 Comp.3 Comp.4
x1 -0.502 -0.237  0.579 -0.598
x2 -0.500  0.493 -0.610 -0.367
x3 -0.498 -0.707 -0.368  0.342
x4 -0.501  0.449  0.396  0.626
</code></pre><table><br><thead><tr><th></th><th scope="col">Comp.1</th><th scope="col">Comp.2</th><th scope="col">Comp.3</th><th scope="col">Comp.4</th></tr></thead><br><tbody><br>    <tr><th scope="row">1</th><td> 2.74300221 </td><td> 0.21717213 </td><td> 0.04664610 </td><td>-0.092431543</td></tr><br>    <tr><th scope="row">2</th><td> 2.26912529 </td><td> 0.15180493 </td><td> 0.05701818 </td><td> 0.094266513</td></tr><br>    <tr><th scope="row">3</th><td> 1.66536864 </td><td> 0.11683915 </td><td>-0.03013748 </td><td>-0.045923725</td></tr><br>    <tr><th scope="row">4</th><td> 1.55844739 </td><td>-0.27262184 </td><td> 0.10173123 </td><td> 0.064513216</td></tr><br>    <tr><th scope="row">5</th><td> 0.53961155 </td><td>-0.04080947 </td><td>-0.12051901 </td><td> 0.011795871</td></tr><br>    <tr><th scope="row">6</th><td>-0.04403012 </td><td>-0.33989164 </td><td>-0.09182299 </td><td> 0.003917754</td></tr><br>    <tr><th scope="row">7</th><td>-0.96230840 </td><td>-0.21126360 </td><td>-0.04524573 </td><td>-0.064368428</td></tr><br>    <tr><th scope="row">8</th><td>-2.22802489 </td><td> 0.22379838 </td><td>-0.19645929 </td><td> 0.020173666</td></tr><br>    <tr><th scope="row">9</th><td>-2.65380615 </td><td> 0.17110117 </td><td> 0.08143164 </td><td> 0.067009629</td></tr><br>    <tr><th scope="row">10</th><td>-2.88738552 </td><td>-0.01612921 </td><td> 0.19735735 </td><td>-0.058952953</td></tr><br></tbody><br></table>



<p>由上可得第一主成分的方差贡献率达到 $98.59534\%$，且第一主成分为：</p>
<p>$$<br>Z_1 = -0.502x_1 -0.500x_2 - 0.498x_3 - 0.501x_4<br>$$</p>
<p>下面使用第一主成分进行回归：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">commodity$z1 &lt;- pre[, <span class="number">1</span>]</span><br><span class="line">md2 &lt;- lm(y ~ z1, commodity)</span><br><span class="line">summary(md2)</span><br></pre></td></tr></table></figure>
<pre><code>Call:
lm(formula = y ~ z1, data = commodity)

Residuals:
     Min       1Q   Median       3Q      Max
-0.72237 -0.20946  0.05154  0.21032  0.81856

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 14.03000    0.16615   84.44 4.32e-13 ***
z1          -2.06119    0.08367  -24.64 7.87e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.5254 on 8 degrees of freedom
Multiple R-squared:  0.987,    Adjusted R-squared:  0.9854
F-statistic: 606.9 on 1 and 8 DF,  p-value: 7.873e-09
</code></pre><p>得到：</p>
<p>$$<br>y = 14.0300 - 2.06119 * Z_1<br>$$</p>
<p>最后我们仍需将变量 $Z_1$ 还原：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Phi &lt;- loadings(pca)</span><br><span class="line">xm &lt;- pca$center</span><br><span class="line">xs &lt;- pca$scale</span><br><span class="line">tem &lt;- md2$coefficients</span><br><span class="line">beta &lt;- tem[<span class="number">2</span>] * Phi[, <span class="number">1</span>] / xs</span><br><span class="line">cons &lt;- tem[<span class="number">1</span>] - beta %*% xm</span><br><span class="line">beta &lt;- c(cons, beta)</span><br><span class="line">beta</span><br></pre></td></tr></table></figure>
<dl class="dl-horizontal"><br>    <dt>1</dt><br>        <dd>-23.7777186112137</dd><br>    <dt>x1</dt><br>        <dd>0.0299264271458343</dd><br>    <dt>x2</dt><br>        <dd>0.133651577042884</dd><br>    <dt>x3</dt><br>        <dd>0.0836115587386088</dd><br>    <dt>x4</dt><br>        <dd>0.169651874372033</dd><br></dl>



<p>得到回归方程：</p>
<p>$$<br>y = -23.7777 + 0.0299 <em> x_1 + 0.1337 </em> x_2 + 0.08361 <em> x_3 + 0.1697 </em> x_4<br>$$</p>
<h3 id="逐步回归"><a href="#逐步回归" class="headerlink" title="逐步回归"></a>逐步回归</h3><p>对《线性模型与回归分析》(王松桂)习题5.7数据做逐步回归分析.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- tbl_df(read_excel(<span class="string">"/path/to/data.xlsx"</span>))</span><br><span class="line"></span><br><span class="line">str(data)</span><br></pre></td></tr></table></figure>
<pre><code>Classes ‘tbl_df’, ‘tbl’ and &apos;data.frame&apos;:    29 obs. of  6 variables:
 $ y : num  272 264 239 231 252 ...
 $ x1: num  783 748 684 828 860 ...
 $ x2: num  33.5 36.5 34.7 33.1 35.8 ...
 $ x3: num  40.5 36.2 37.3 35.5 33.7 ...
 $ x4: num  16.7 16.5 17.7 17.5 16.4 ...
 $ x5: num  13.2 14.1 15.7 10.5 11 ...
</code></pre><p>先对数据集做<strong>向后</strong>逐步回归：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">md1 &lt;- lm(y ~ x1 + x2 + x3 + x4 + x5, data=data)</span><br><span class="line"></span><br><span class="line">stepAIC(md1, direction=<span class="string">"backward"</span>)</span><br></pre></td></tr></table></figure>
<pre><code>Start:  AIC=176
y ~ x1 + x2 + x3 + x4 + x5

       Df Sum of Sq     RSS    AIC
- x3    1      35.1  8323.5 174.13
- x2    1     114.0  8402.4 174.40
- x5    1     411.8  8700.1 175.41
&lt;none&gt;               8288.4 176.00
- x1    1     723.8  9012.2 176.43
- x4    1    5074.5 13362.9 187.85

Step:  AIC=174.13
y ~ x1 + x2 + x4 + x5

       Df Sum of Sq     RSS    AIC
- x2    1     217.2  8540.7 172.87
&lt;none&gt;               8323.5 174.13
- x1    1    1009.8  9333.3 175.45
- x5    1    1267.3  9590.9 176.24
- x4    1    5136.6 13460.1 186.06

Step:  AIC=172.87
y ~ x1 + x4 + x5

       Df Sum of Sq     RSS    AIC
&lt;none&gt;               8540.7 172.87
- x5    1    1365.8  9906.5 175.18
- x1    1    1605.5 10146.2 175.87
- x4    1    4929.7 13470.4 184.09




Call:
lm(formula = y ~ x1 + x4 + x5, data = data)

Coefficients:
(Intercept)           x1           x4           x5
   447.3340       0.1273     -21.8362       5.1049
</code></pre><p>再对数据集做向前逐步回归：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">md2 &lt;- lm(y ~ <span class="number">1</span>, data=data)</span><br><span class="line"></span><br><span class="line">stepAIC(md2, direction=<span class="string">"forward"</span>, scope=<span class="string">"~ x1 + x2 + x3 + x4 + x5"</span>)</span><br></pre></td></tr></table></figure>
<pre><code>Start:  AIC=193.65
y ~ 1

       Df Sum of Sq   RSS    AIC
+ x4    1   10612.7 10892 175.93
+ x1    1    8030.1 13475 182.10
+ x5    1    2563.9 18941 191.97
&lt;none&gt;              21505 193.65
+ x2    1     245.0 21260 195.32
+ x3    1       1.8 21503 195.65

Step:  AIC=175.93
y ~ x4

       Df Sum of Sq     RSS    AIC
+ x3    1   1656.22  9235.8 173.14
+ x1    1    985.56  9906.5 175.18
+ x2    1    779.98 10112.1 175.77
+ x5    1    745.86 10146.2 175.87
&lt;none&gt;              10892.0 175.93

Step:  AIC=173.14
y ~ x4 + x3

       Df Sum of Sq    RSS    AIC
&lt;none&gt;              9235.8 173.14
+ x1    1    505.14 8730.7 173.51
+ x2    1    143.80 9092.0 174.69
+ x5    1     14.91 9220.9 175.10




Call:
lm(formula = y ~ x4 + x3, data = data)

Coefficients:
(Intercept)           x4           x3
    491.523      -24.663        4.675
</code></pre><p>发现两种方向的结果并<strong>不一致</strong>。</p>
<p>下面对数据进行划分: 前15个样本作为训练数据, 后14个样本作为测试数据，根据AIC准则和RSS准则综合判断如何选择经逐步回归后得到的线性方程.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">datatrain &lt;- data[<span class="number">1</span>:<span class="number">15</span>, ]</span><br><span class="line">datatest &lt;- data[<span class="number">16</span>:<span class="number">29</span>, ]</span><br><span class="line"></span><br><span class="line">md1 &lt;- lm(y ~ <span class="number">1</span>, datatrain)</span><br><span class="line">md2 &lt;- step(md1, direction = <span class="string">"both"</span>, scope = <span class="string">"~ x1 + x2 + x3 + x4 + x5"</span>)</span><br><span class="line"></span><br><span class="line">summary(md2)</span><br></pre></td></tr></table></figure>
<pre><code>Start:  AIC=79.88
y ~ 1

       Df Sum of Sq    RSS    AIC
+ x4    1   1107.48 1589.4 73.946
+ x3    1    666.73 2030.1 77.617
+ x5    1    397.59 2299.3 79.485
+ x1    1    385.77 2311.1 79.561
&lt;none&gt;              2696.9 79.877
+ x2    1    104.83 2592.0 81.282

Step:  AIC=73.95
y ~ x4

       Df Sum of Sq     RSS    AIC
+ x3    1   1182.99  406.40 55.489
+ x5    1    835.24  754.14 64.763
+ x2    1    295.31 1294.07 72.862
&lt;none&gt;              1589.39 73.946
+ x1    1      1.30 1588.09 75.934
- x4    1   1107.48 2696.87 79.877

Step:  AIC=55.49
y ~ x4 + x3

       Df Sum of Sq     RSS    AIC
+ x1    1     70.01  336.39 54.653
&lt;none&gt;               406.40 55.489
+ x5    1     42.58  363.82 55.829
+ x2    1      2.93  403.47 57.381
- x3    1   1182.99 1589.39 73.946
- x4    1   1623.74 2030.14 77.617

Step:  AIC=54.65
y ~ x4 + x3 + x1

       Df Sum of Sq     RSS    AIC
+ x5    1    116.20  220.18 50.296
+ x2    1     42.17  294.21 54.644
&lt;none&gt;               336.39 54.653
- x1    1     70.01  406.40 55.489
- x4    1    881.47 1217.86 71.952
- x3    1   1251.70 1588.09 75.934

Step:  AIC=50.3
y ~ x4 + x3 + x1 + x5

       Df Sum of Sq     RSS    AIC
&lt;none&gt;               220.18 50.296
+ x2    1     13.40  206.78 51.354
- x5    1    116.20  336.39 54.653
- x1    1    143.64  363.82 55.829
- x3    1    317.12  537.30 61.678
- x4    1    790.37 1010.56 71.153




Call:
lm(formula = y ~ x4 + x3 + x1 + x5, data = datatrain)

Residuals:
    Min      1Q  Median      3Q     Max
-6.1147 -2.7790 -0.4392  3.2326  6.8494

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 324.64019   67.10578   4.838 0.000684 ***
x4          -17.84038    2.97769  -5.991 0.000134 ***
x3            3.62457    0.95507   3.795 0.003514 **
x1            0.07047    0.02759   2.554 0.028659 *
x5            2.99391    1.30323   2.297 0.044459 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.692 on 10 degrees of freedom
Multiple R-squared:  0.9184,    Adjusted R-squared:  0.8857
F-statistic: 28.12 on 4 and 10 DF,  p-value: 2.028e-05
</code></pre><p>由上可以发现：</p>
<p>首先, 引入 $x_4$ 后,方程的AIC将降低, 并且引入后的RSS最小,故考虑引入 $x_4$；</p>
<p>接下来, 引入 $x_3$ 会继续降低方程的AIC, 且引入 $x_3$ 对应的RSS最小；</p>
<p>继续地，以此判断准则分别引入 $x_1$ 和 $x_5$, 依据AIC准则,方程达到最优。</p>
<p>$$<br>y = 324.64019 + 0.07047 <em> x1 + 3.62457 </em> x3 - 17.84038 <em> x4 + 2.99391 </em> x5<br>$$</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">R &lt;- summary(md2)$r.square</span><br><span class="line">MSE &lt;- sum(residuals(md2)^<span class="number">2</span>)/<span class="number">7</span></span><br><span class="line"></span><br><span class="line">yp &lt;- predict(md2, datatest)</span><br><span class="line">yf &lt;- datatest$y</span><br><span class="line"></span><br><span class="line">Rp &lt;- <span class="number">1</span> - sum((yf-yp)^<span class="number">2</span>)/sum((yf-mean(yf))^<span class="number">2</span>)</span><br><span class="line">MSEp &lt;- sum((yf-yp)^<span class="number">2</span>)/<span class="number">7</span></span><br><span class="line"></span><br><span class="line">cat(<span class="string">"Original R-Square ="</span>, R, <span class="string">"\n"</span>)</span><br><span class="line">cat(<span class="string">"cv Rp-Square ="</span>, Rp, <span class="string">"\n"</span>)</span><br><span class="line"></span><br><span class="line">cat(<span class="string">"Original MSE ="</span>, MSE, <span class="string">"\n"</span>)</span><br><span class="line">cat(<span class="string">"cv MSEp ="</span>, MSEp, <span class="string">"\n"</span>)</span><br></pre></td></tr></table></figure>
<pre><code>Original R-Square = 0.9183561
cv Rp-Square = 0.4209326
Original MSE = 31.4547
cv MSEp = 1362.036
</code></pre><p>对比原方程的 $R^2 = 91.84\%$, $MSE=27.52287$ 使用测试数据进行交叉验证得到的 $R^2<em>{pre} = 42.09\%$, $MSE</em>{pre} = 1362.036$.</p>
<p>$R^2$ 下降很多, 说明若用该方程进行预测, 预测结果不可靠.</p>
<h3 id="带示性的线性回归模型"><a href="#带示性的线性回归模型" class="headerlink" title="带示性的线性回归模型"></a>带示性的线性回归模型</h3><p>使用讲义上的2014年全国教育数据进行回归分析:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">edu &lt;- tbl_df(read_excel(<span class="string">"/path/to/education.xlsx"</span>))</span><br><span class="line"></span><br><span class="line">head(edu, n=<span class="number">8</span>)</span><br></pre></td></tr></table></figure>
<table><br><thead><tr><th scope="col">y</th><th scope="col">x1</th><th scope="col">x2</th><th scope="col">jbh</th></tr></thead><br><tbody><br>    <tr><td>5082.47 </td><td>44488.57</td><td>14119   </td><td>1       </td></tr><br>    <tr><td>4170.25 </td><td>28832.29</td><td>13544   </td><td>1       </td></tr><br>    <tr><td>1470.97 </td><td>16647.40</td><td>18461   </td><td>3       </td></tr><br>    <tr><td>1928.79 </td><td>16538.32</td><td>18415   </td><td>3       </td></tr><br>    <tr><td>2552.41 </td><td>20559.34</td><td>15207   </td><td>2       </td></tr><br>    <tr><td>1981.45 </td><td>22820.15</td><td>14277   </td><td>2       </td></tr><br>    <tr><td>1945.20 </td><td>17520.39</td><td>13930   </td><td>2       </td></tr><br>    <tr><td>1638.09 </td><td>17404.39</td><td>12597   </td><td>2       </td></tr><br></tbody><br></table>




<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">edu$jbh &lt;- factor(edu$jbh)</span><br><span class="line"></span><br><span class="line">md &lt;- lm(y ~ x1 + x2 + jbh, data=edu)</span><br><span class="line"></span><br><span class="line">influencePlot(md, id.method=<span class="string">"identity"</span>, main=<span class="string">"Influence Plot"</span>, sub=<span class="string">"Circle size is proportional to Cook's"</span>)</span><br></pre></td></tr></table></figure>
<table><br><thead><tr><th></th><th scope="col">StudRes</th><th scope="col">Hat</th><th scope="col">CookD</th></tr></thead><br><tbody><br>    <tr><th scope="row">9</th><td>-0.7881532</td><td>0.4759338 </td><td>0.09546883</td></tr><br>    <tr><th scope="row">26</th><td> 4.8251309</td><td>0.1874467 </td><td>0.47330170</td></tr><br></tbody><br></table>

<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/project2/output_37_1.png" width="50%"><br></div>

<p>由上图，我们需要剔除异常点西藏省对应的数据.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">edu &lt;- edu[-<span class="number">26</span>,]</span><br></pre></td></tr></table></figure>
<p>原数据中对人均可支配收入 <code>jbh</code> 进行了分组, 我们针对分组做适当简化: 将原数据中第一组作为高收入组 <code>h</code>; 第二组和第三组作为中等收入组 <code>m</code>, 第四组作为低收入组 <code>l</code>.</p>
<p>简化后的分组有四个水平, 故引入三个示性变量:</p>
<p>$$<br>x_3 = \begin{cases}<br>1 \quad jbh=1 \<br>0 \quad \text{else} \<br>\end{cases} \qquad x_4 = \begin{cases}<br>1 \quad jbh=2  \<br>0 \quad \text{else} \<br>\end{cases} \qquad x_5 = \begin{cases}<br>1 \quad jbh=3  \<br>0 \quad \text{else} \<br>\end{cases}<br>$$</p>
<p>据此我们可将数据框 <code>edu</code> 做如下变换</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jbh &lt;- dummy(edu$jbh)  <span class="comment"># convert the dummies into a sparse matrix</span></span><br><span class="line">edu.new &lt;- data.frame(edu$y, edu$x1, edu$x2, jbh)  <span class="comment"># update the dateframe</span></span><br><span class="line">names(edu.new) &lt;- c(<span class="string">"y"</span>, <span class="string">"x1"</span>, <span class="string">"x2"</span>, <span class="string">"x3"</span>, <span class="string">"x4"</span>, <span class="string">"x5"</span>, <span class="string">"x6"</span>) <span class="comment"># rename the columns</span></span><br><span class="line"></span><br><span class="line">head(edu.new, n=<span class="number">8</span>)</span><br></pre></td></tr></table></figure>
<table><br><thead><tr><th scope="col">y</th><th scope="col">x1</th><th scope="col">x2</th><th scope="col">x3</th><th scope="col">x4</th><th scope="col">x5</th><th scope="col">x6</th></tr></thead><br><tbody><br>    <tr><td>5082.47 </td><td>44488.57</td><td>14119   </td><td>1       </td><td>0       </td><td>0       </td><td>0       </td></tr><br>    <tr><td>4170.25 </td><td>28832.29</td><td>13544   </td><td>1       </td><td>0       </td><td>0       </td><td>0       </td></tr><br>    <tr><td>1470.97 </td><td>16647.40</td><td>18461   </td><td>0       </td><td>0       </td><td>1       </td><td>0       </td></tr><br>    <tr><td>1928.79 </td><td>16538.32</td><td>18415   </td><td>0       </td><td>0       </td><td>1       </td><td>0       </td></tr><br>    <tr><td>2552.41 </td><td>20559.34</td><td>15207   </td><td>0       </td><td>1       </td><td>0       </td><td>0       </td></tr><br>    <tr><td>1981.45 </td><td>22820.15</td><td>14277   </td><td>0       </td><td>1       </td><td>0       </td><td>0       </td></tr><br>    <tr><td>1945.20 </td><td>17520.39</td><td>13930   </td><td>0       </td><td>1       </td><td>0       </td><td>0       </td></tr><br>    <tr><td>1638.09 </td><td>17404.39</td><td>12597   </td><td>0       </td><td>1       </td><td>0       </td><td>0       </td></tr><br>    <tr><td>4077.58 </td><td>45965.83</td><td>11719   </td><td>1       </td><td>0       </td><td>0       </td><td>0       </td></tr><br>    <tr><td>2613.18 </td><td>27172.77</td><td>16619   </td><td>1       </td><td>0       </td><td>0       </td><td>0       </td></tr><br></tbody><br></table>



<p>新的 <code>edu.new</code> 中已将哑变量 <code>x3</code> 转化为相应矩阵，可以假设此数据满足线性模型:</p>
<p>$$<br>y=\beta_0 + \beta_1\, x_1+ \beta_2\, x_2  + \beta_3\, x_3 + \beta_4\, x_4 + \beta_5\, x_5 + e<br>$$</p>
<p>误差 $e$ 满足 Gauss-Markov 假设. 使用最小二乘法估计参数 $\beta$.</p>
<p>下面对模型进行交叉验证，将样本分为 $k$ 个子样本，轮流将 $k-1$ 个子样本组合作为训练集，另外 $1$ 个子样本作为保留集。这样获得的 $k$ 个预测方程，记录了 $k$ 个保留样本的预测表现结果，然后求其均值。</p>
<p>利用 <code>bootstrap</code> 包中的 <code>crossval()</code> 函数实现如下交叉验证函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># construct the k fold cross validation function</span></span><br><span class="line">shrinkage &lt;- <span class="keyword">function</span>(fit, k=<span class="number">3</span>) &#123;</span><br><span class="line"></span><br><span class="line">  theta.fit &lt;- <span class="keyword">function</span>(x, y) &#123;lsfit(x, y)&#125;</span><br><span class="line">  theta.predict &lt;- <span class="keyword">function</span>(fit, x) &#123;cbind(<span class="number">1</span>, x) %*% fit$coef&#125;</span><br><span class="line"></span><br><span class="line">  x &lt;- fit$model[, <span class="number">2</span>:ncol(fit$model)]</span><br><span class="line">  y &lt;- fit$model[, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">  results &lt;- crossval(x, y, theta.fit, theta.predict, ngroup = k)</span><br><span class="line">  r2 &lt;- cor(y, fit$fitted.values)^<span class="number">2</span></span><br><span class="line">  r2cv &lt;- cor(y, results$cv.fit)^<span class="number">2</span></span><br><span class="line">  cat(<span class="string">"Original R-square ="</span>, r2, <span class="string">"\n"</span>)</span><br><span class="line">  cat(k, <span class="string">"Fold Cross-Validated R-square ="</span>, r2cv, <span class="string">"\n"</span>)</span><br><span class="line">  cat(<span class="string">"R-square Change ="</span>, r2 - r2cv, <span class="string">"\n"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对 <code>new.data</code> 所有预测变量进行回归，然后再用 <code>shrinkage()</code> 函数做 $3$ 重交叉验证：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">md.new &lt;- lm(y ~ x1 + x2 + x3 + x4 + x5, data=edu.new)</span><br><span class="line"></span><br><span class="line">shrinkage(md.new)</span><br></pre></td></tr></table></figure>
<pre><code>Original R-square = 0.7147451
3 Fold Cross-Validated R-square = 0.4983459
R-square Change = 0.2163992
</code></pre><p>可以看到，基于初始样本的 $R$ 平方为 <code>0.7147451</code>，对新数据更好的方差解释率估计是交叉验证后的 $R$ 平方 <code>0.4686895</code>，$R$ 平方减少量 <code>0.2163992</code> 较小，说明预测变量模型泛化能力较好，预测较为精准。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summary(md.new)</span><br></pre></td></tr></table></figure>
<pre><code>Call:
lm(formula = y ~ x1 + x2 + x3 + x4 + x5, data = edu.new)

Residuals:
   Min     1Q Median     3Q    Max
-520.1 -271.8 -198.1  259.4 1176.5

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  858.93181 1012.19824   0.849 0.404499
x1             0.09523    0.02400   3.967 0.000572 ***
x2             0.01520    0.03799   0.400 0.692716
x3          -816.78300  498.04009  -1.640 0.114050
x4          -873.96293  312.85124  -2.794 0.010079 *
x5          -776.99506  280.13906  -2.774 0.010556 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 490.3 on 24 degrees of freedom
Multiple R-squared:  0.7147,    Adjusted R-squared:  0.6553
F-statistic: 12.03 on 5 and 24 DF,  p-value: 6.658e-06
</code></pre><p>故可得带哑变量的线性模型回归方程：</p>
<p>$$<br>y = 858.93181 + 0.09523 <em> x1 + 0.01520 </em> x2 - 816.78300 <em> x3 - 873.96293 </em> x4 - 776.99506 * x5<br>$$</p>
<p>由上可知，<strong>人均可支配收入最高省份</strong>相比<strong>人均可支配收入最低省份</strong>在<strong>人均教育费用</strong>上会减少约 <code>816.78</code> 元的投入。 <strong>人均收入稍高的省份</strong>相比减少 <code>873.96</code> 元人均教育经费投入，再稍低的相比减少 <code>776.99</code> 元的人均教育经费投入。最低收入的作为参考指标，视为不减少。</p>
<h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><ol>
<li>R in action Data Analysis and Graphics with R (Second Edition)</li>
<li>线性模型引论（王松桂、史建红等）</li>
<li>线性统计模型（王松桂、陈敏等）</li>
<li>数据集地址：<a href="http://oye4atjxc.bkt.clouddn.com/statistic/project2/data.zip" target="_blank" rel="noopener">http://oye4atjxc.bkt.clouddn.com/statistic/project2/data.zip</a></li>
</ol>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">r</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">statistics</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="../../2017/11/17/Project-2-of-Statistics/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Assignment-2-of-Advanced-Computational-Method" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="../../2017/11/14/Assignment-2-of-Advanced-Computational-Method/">Assignment 2 of Advanced Computational Method</a>
    </h1>
  

        
        <a href="../../2017/11/14/Assignment-2-of-Advanced-Computational-Method/" class="archive-article-date">
  	<time datetime="2017-11-13T16:01:20.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-11-14</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Homework-3"><a href="#Homework-3" class="headerlink" title="Homework 3"></a>Homework 3</h2><p>The Metropolis–Hastings algorithm works by generating a sequence of sample values in such a way that, as more and more sample values are produced, the distribution of values more closely approximates the desired distribution, $P(x)$. These sample values are produced iteratively, with the distribution of the next sample being dependent only on the current sample value (thus making the sequence of samples into a Markov chain). Specifically, at each iteration, the algorithm picks a candidate for the next sample value based on the current sample value. Then, with some probability, the candidate is either accepted (in which case the candidate value is used in the next iteration) or rejected (in which case the candidate value is discarded, and current value is reused in the next iteration)−the probability of acceptance is determined by comparing the values of the function $f(x)$ of the current and candidate sample values with respect to the desired distribution $P(x)$.</p>
<h3 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h3><blockquote>
<p>Draw samples from the distribution $p(x, y) = \mathrm{e}^{-(x-1)^2-100(y-x)^2}$</p>
<ol>
<li>use RW-MH, use different step size and compare the performance;</li>
<li>use IS with different proposals of your choice and compare the performance.</li>
<li>use adaptive MCMC and compare the performance with standard RW-MH.</li>
</ol>
</blockquote>
<p>For the purpose of implementation, the Metropolis algorithm, a special case of the Metropolis–Hastings algorithm where the proposal function is symmetric, is described below.</p>
<p><strong>Metropolis algorithm (symmetric proposal distribution)</strong></p>
<p>Let $f(x)$ be a function that is proportional to the desired probability distribution $P(x)$ (a.k.a. a target distribution).</p>
<ol>
<li><p>Initialization: Choose an arbitrary point x0 to be the first sample, and choose an arbitrary probability density $g(x\mid y)$ that suggests a candidate for the next sample value x, given the previous sample value y. For the Metropolis algorithm, $g$ must be symmetric; in other words, it must satisfy $q(x\mid y)=q(y\mid x)$. A usual choice is to let $q(x\mid y)$ be a Gaussian distribution centered at $y$, so that points closer to $y$ are more likely to be visited next—making the sequence of samples into a random walk. The function $g$ is referred to as the <em>proposal density</em> or <em>jumping distribution</em>.</p>
</li>
<li><p>For each iteration $t$:</p>
</li>
</ol>
<ul>
<li><strong>Generate</strong> : Generate a candidate x for the next sample by picking from the distribution $q(x’|x_{t})$.</li>
<li><strong>Calculate</strong> : Calculate the acceptance ratio $\alpha =p(x)/p(x<em>{t})$, which will be used to decide whether to accept or reject the candidate. Because $f$ is proportional to the density of $P$, we have that $\alpha =p(x’)/p(x</em>{t})=P(x’)/P(x_{t})$</li>
<li><strong>Accept</strong> or <strong>Reject</strong> :<ul>
<li>Generate a uniform random number $u$ on $[0,1]$.</li>
<li>If $u\leq \alpha$ <em>accept</em> the candidate by setting $x_{t+1}=x’$</li>
<li>If $u&gt;\alpha$ <em>reject</em> the candidate and set $x<em>{t+1}=x</em>{t}$, instead.</li>
</ul>
</li>
</ul>
<p><strong>The Metropolis-Hastings Algorithm</strong> (MH)</p>
<pre><code>1. initialize at $X^0$
2. for $i = 0$ to $n-1$
</code></pre><ul>
<li>sample $y\sim q(\cdot \mid X^i)$</li>
<li>sample $u\sim U[0,1]$</li>
<li>$a(X^i, y)=\min\lbrace 1, \frac{p(y)}{p(X^{i})}\frac{q(X^i \mid y)}{p(y \mid X^i)}\rbrace$</li>
<li>accept/reject the proposed $y$ according to probability $a(X,y)$</li>
<li>if $u\leq a$ set $X^{i+1} = X$<br>   else $X^{i+1} = X^{i}$</li>
</ul>
<h4 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h4><p>First, let’s take a look at the target distribution. Here, we present a 3D plot by <code>R</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- seq(-<span class="number">2</span>, <span class="number">2</span>, length=<span class="number">100</span>)</span><br><span class="line">y &lt;- x</span><br><span class="line">f &lt;- <span class="keyword">function</span>(x, y)&#123;exp(-(x-<span class="number">1</span>)^<span class="number">2</span> - <span class="number">100</span>*(y - x)^<span class="number">2</span>)&#125;</span><br><span class="line">z &lt;- outer(x, y, f)</span><br><span class="line">persp(x, y, z, shade=<span class="number">0.1</span>, col=<span class="string">"white"</span>, ticktype=<span class="string">"detailed"</span>, xlab=<span class="string">"x"</span>, ylab=<span class="string">"y"</span>, zlab=<span class="string">"rosenbrock"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment2/rosenbrock.svg" width="50%"></p>
<p>The picture shown above is shaped like banana as is taught to be.</p>
<p>Next, we follow the Metropolis-Hastings Algorithm and give a simple implement.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define arguments: target distribution</span></span><br><span class="line">rosenbrock &lt;- <span class="keyword">function</span>(x)    <span class="comment"># x is a vector</span></span><br><span class="line">&#123;</span><br><span class="line">    exp(-(x[<span class="number">1</span>]-<span class="number">1</span>)^<span class="number">2</span> - <span class="number">100</span>*(x[<span class="number">2</span>] - x[<span class="number">1</span>])^<span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define the sampling function</span></span><br><span class="line">rwMetro &lt;- <span class="keyword">function</span>(target, N, x, step, burnin=<span class="number">1000</span>)</span><br><span class="line">&#123;</span><br><span class="line">    cov &lt;- step*diag(<span class="number">2</span>)</span><br><span class="line">    samples &lt;- x</span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">2</span>:(burnin+N))</span><br><span class="line">    &#123;</span><br><span class="line">        prop &lt;- mvrnorm(n = <span class="number">1</span>, x, cov)</span><br><span class="line">        <span class="keyword">if</span> (runif(<span class="number">1</span>) &lt; min(<span class="number">1</span>, target(prop)/target(x)))</span><br><span class="line">            x &lt;- prop</span><br><span class="line">        samples &lt;- rbind(samples,x)</span><br><span class="line">    &#125;</span><br><span class="line">    samples[(burnin+<span class="number">1</span>):(N+burnin),]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The above forms a rosenbrock function for general usage and construct a sampling function with considerate arguments. For example, the <code>burnin</code> period is typically necessary, where an initial number of samples (e.g. the first default $1000$ or so) are thrown away, since the initial samples may follow a very different distribution, especially if the starting point is in a region of low density.</p>
<p>Hence, we can draw samples by calling the function.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rwMetro.samples &lt;- rwMetro(rosenbrock, 10000, c(0,0), 1)</span><br></pre></td></tr></table></figure>
<p>Here, <code>rwMetro.samples</code> contains <code>10000</code> rows of samples with 2 columns. Continually, we want to evaluate the performance of this sampling method. Correlations should be a key of parameter choosing. For example, here we set step size $\delta$ to be $1$ and plot the autocorrelation function below:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acf(rwMetro.samples, lag.max=<span class="number">100</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment2/rwMetro.svg" width="60%"></p>
<p>As is shown in the picture, the self-correlation (diagonal part) decays when the effective sample size equals $100$[^size], which somehow indicates the Markov chain eventually converges to the desired distribution,</p>
<p>[^size]: here we set $100$ to be the default number of effectively independent samples.</p>
<p>Simply change the <code>step</code> parameter in function calling/sampling, we can obtain different shows of autocorrelation functions, which decays faster implies a more independent sampling.</p>
<p>Based on this criterion, we can do repetition test and comparison work in RStudio. An optimal step size is selected to be quite near $1$[^exp].</p>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment2/rwMetro_best.svg" width="60%"></p>
<p>[^exp]: the result is not quite stable, but we find $\delta\in[0.9,1]$ is adequate.</p>
<h4 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h4><p>However, Metropolis–Hastings and other MCMC algorithms have a number of disadvantages. For example, the samples are correlated. This means that if we want a set of independent samples, we have to throw away the majority of samples.</p>
<p>Hence, independence sampler is necessary in some practical use. The thought comes like below:</p>
<p>Set</p>
<p>$$<br>\begin{split}<br>&amp; p(y\mid X) = p(y) \<br>&amp; a(X, y) = \frac{p(y)}{p(X)} \frac{q(X\mid y)}{p(y\mid X)} = 1 \<br>\end{split}<br>$$</p>
<p>which implies us:</p>
<p>$$<br>q(Y\mid X) = q(y) \approx p(y)<br>$$</p>
<p>that means $q(y)$ is a fixed distribution which is independent on $X$</p>
<p>Thus, we can construct a global proposal $q(y)$ which is independent on $X$. In this way,</p>
<p>$$<br>a(X^i, y) = \frac{p(X^i)}{p(y)} \frac{q(y \mid X^i)}{p(X^i\mid y)} = \frac{q(y \mid X^i)}{p(y)}<br>$$</p>
<p>Noticed that the rosenbrock function is symmetric on vector $(1,1)$, we can propose a new normal distribution centered at $(1,1)$, i.e. $q(y)$ is the PDF of $N(\begin{pmatrix} 1\ 1\ \end{pmatrix}, \delta^2)$.</p>
<p>Thus, we modify the RW-MH function and give an independence sampler named <code>isSampler</code>.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">isSampler &lt;- <span class="keyword">function</span>(target, N, x, step, burnin=<span class="number">1000</span>)</span><br><span class="line">&#123;</span><br><span class="line">    cov &lt;- step*diag(<span class="number">2</span>)</span><br><span class="line">    samples &lt;- x</span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">2</span>:(burnin+N))</span><br><span class="line">    &#123;</span><br><span class="line">        prop &lt;- mvrnorm(n = <span class="number">1</span>, c(<span class="number">1</span>,<span class="number">1</span>), cov)</span><br><span class="line">        <span class="keyword">if</span> (runif(<span class="number">1</span>) &lt; min(<span class="number">1</span>, target(prop)/target(x)))</span><br><span class="line">            x &lt;- prop</span><br><span class="line">        samples &lt;- rbind(samples,x)</span><br><span class="line">    &#125;</span><br><span class="line">    samples[(burnin+<span class="number">1</span>):(N+burnin),]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Directly call the new function, we will receive a set of independent samples with an image of correlation function.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">is.samples &lt;- isSampler(rosenbrock, <span class="number">10000</span>, c(<span class="number">0</span>,<span class="number">0</span>), <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">acf(is.samples, lag.max=<span class="number">100</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment2/isSampler.svg" width="60%"></p>
<p>Similarily, we can change the <code>step</code> parameter to get different proposals. Repeated works have been done to get the optimal distribution $N(0,0.1)$, the corresponding autocorrelation function shapes like below:</p>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment2/isSampler_best.svg" width="60%"></p>
<h4 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h4><p><strong>Adaptive MCMC Algorithm</strong></p>
<ol>
<li>draw a set of $N$ samples from the target distribution with standard RW-MH method.</li>
<li>estimate the sample covariance of the samples.</li>
<li>update the covariance matrix[^cov] of the proposal with the computed sample covariance.</li>
<li>draw a set of samples from the updated proposal.</li>
</ol>
<p>[^cov]: the updated covariance matrix needs to be positive.</p>
<p>Here, we set $\varepsilon \sim N(0, \Sigma)$ where $\Sigma$ is the updated covariance matrix:</p>
<p>$$<br>\mathrm{Cov}(X) = \frac{1}{N}\sum(X^i - \bar X^N)(X^i - \bar X^N)’ + \delta I \quad,\quad \bar X^N = \frac{1}{N}\sum_{i=1}^{N} X^i<br>$$</p>
<p>Thus, we can derive the following adaptive MCMC sampler:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">adaptiveMCMC &lt;- <span class="keyword">function</span>(target, N, x, step, burnin=<span class="number">1000</span>)</span><br><span class="line">&#123;</span><br><span class="line">  cov &lt;- step*diag(<span class="number">2</span>)</span><br><span class="line">  samples &lt;- x</span><br><span class="line">  <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">2</span>:(burnin+N))</span><br><span class="line">  &#123;</span><br><span class="line">    prop &lt;- mvrnorm(n = <span class="number">1</span>, x, cov)</span><br><span class="line">    <span class="keyword">if</span> (runif(<span class="number">1</span>) &lt; min(<span class="number">1</span>, target(prop)/target(x)))</span><br><span class="line">      x &lt;- prop</span><br><span class="line">    samples &lt;- rbind(samples,x)</span><br><span class="line">    cov &lt;- cov(samples) + step*diag(<span class="number">2</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  samples[(burnin+<span class="number">1</span>):(N+burnin),]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adaptive.samples &lt;- adaptiveMCMC(rosenbrock, <span class="number">10000</span>, c(<span class="number">0</span>,<span class="number">0</span>), <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">acf(adaptive.samples, lag.max=<span class="number">100</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment2/adaptiveMCMC.svg" width="60%"></p>
<p>Tedious works have been done to obtain the optimal step size $\delta=0.5$ in the way <code>adaptiveMCMC</code> performs.</p>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment2/ada_best.svg" width="60%"></p>
<p>The self-correlations decay rapidly within $60$ lags and tend to converge after that.</p>
<p>Compared with standard RW-MH method, an obvious improvement can be seen in performing adaptive MCMC method. Also, we find that the optimal result is more stable in <code>adaptiveMCMC</code> than in <code>rwMetro</code>.</p>
<p>Finally, let’s have a look at samples generated by these three methods.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Display the samples</span></span><br><span class="line">par(mfrow=c(<span class="number">2</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">plot(rwMetro.samples[,<span class="number">1</span>], rwMetro.samples[,<span class="number">2</span>], xlim=c(-<span class="number">1.5</span>,<span class="number">1.5</span>),ylim=c(-<span class="number">1.5</span>,<span class="number">1.5</span>), main=<span class="string">'MH Samples'</span>,xlab=<span class="string">'x'</span>, ylab=<span class="string">'y'</span>, pch=<span class="string">'.'</span>)</span><br><span class="line"></span><br><span class="line">plot(is.samples[,<span class="number">1</span>], is.samples[,<span class="number">2</span>], xlim=c(-<span class="number">1.5</span>,<span class="number">1.5</span>),ylim=c(-<span class="number">1.5</span>,<span class="number">1.5</span>), main=<span class="string">'IS Samples'</span>,xlab=<span class="string">'x'</span>, ylab=<span class="string">'y'</span>, pch=<span class="string">'.'</span>)</span><br><span class="line"></span><br><span class="line">plot(adaptive.samples[,<span class="number">1</span>], adaptive.samples[,<span class="number">2</span>], xlim=c(-<span class="number">1.5</span>,<span class="number">1.5</span>),ylim=c(-<span class="number">1.5</span>,<span class="number">1.5</span>), main=<span class="string">'MCMC Samples'</span>,xlab=<span class="string">'x'</span>, ylab=<span class="string">'y'</span>, pch=<span class="string">'.'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment2/samples.svg" width="60%"></p>
<p>Compared with the target distribution, we find that the <code>adaptiveMCMC</code> samples are best simulated and <code>rwMetro</code> seems to be fairly standard, while the <code>isSampler</code>, in a way, tends to be extreme.</p>
<p>Furthermore, we can test our optimal result using the generated samples. For example, samples generate from <code>adaptiveMCMC</code> method can be used to plot the density curve and make comparison with our optimal proposal $q(y)\sim N(1,0.5)$</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- adaptive.samples[,<span class="number">1</span>]</span><br><span class="line">y &lt;- adaptive.samples[,<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">par(mfrow=c(<span class="number">2</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">hist(x, xlab=<span class="string">"x"</span>, main=<span class="string">"Distribution of Samples"</span>)</span><br><span class="line"></span><br><span class="line">plot(density(x), col=<span class="string">"red"</span>, lwd=<span class="number">1.5</span>)</span><br><span class="line">curve(dnorm(x, mean=<span class="number">1</span>, sd=sqrt(<span class="number">0.5</span>)), add=<span class="literal">TRUE</span>, col=<span class="string">"blue"</span>, lwd=<span class="number">1.5</span>)</span><br><span class="line"></span><br><span class="line">hist(x, xlab=<span class="string">"y"</span>, main=<span class="string">"Distribution of Samples"</span>)</span><br><span class="line"></span><br><span class="line">plot(density(y), col=<span class="string">"red"</span>, lwd=<span class="number">1.5</span>)</span><br><span class="line">curve(dnorm(x, mean=<span class="number">1</span>, sd=sqrt(<span class="number">0.5</span>)), add=<span class="literal">TRUE</span>, col=<span class="string">"blue"</span>, lwd=<span class="number">1.5</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment2/density.svg" width="60%"></p>
<p>It can be seen that the proposed distribution fits well, which make our result more persuative.</p>
<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>Most simple rejection sampling methods suffer from the “curse of dimensionality”, where the probability of rejection increases exponentially as a function of the number of dimensions. But Metropolis–Hastings, along with other MCMC methods, <strong>do not</strong> have this problem to such a degree. Thus they are often the only solutions available when the number of dimensions of the distribution to be sampled is high.</p>
<p>In multivariate distributions, the classic Metropolis–Hastings algorithm as described above involves choosing a new multi-dimensional sample point. When the number of dimensions is high, finding the right proposed distribution to use can be difficult, as the different individual dimensions behave in very different ways, and the step size must be “just right” for all dimensions at once to avoid excessively slow mixing. An alternative approach that often works better in such situations, known as <em>Gibbs sampling</em>, involves choosing a new sample for each dimension separately from the others, rather than choosing a sample for all dimensions at once. Various algorithms can be used to choose these individual samples, depending on the exact form of the multivariate distribution such as the adaptive rejection Metropolis sampling algorithm.</p>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ol>
<li><a href="https://arxiv.org/pdf/1504.01896.pdf" target="_blank" rel="noopener">The Metropolis-Hastings algorithm Christian P. Robert (U. Paris-Dauphine PSL &amp; U. Warwick)</a></li>
<li><a href="https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm#Step-by-step_instructions" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm#Step-by-step_instructions</a></li>
<li><a href="http://blog.csdn.net/abcjennifer/article/details/25908495" target="_blank" rel="noopener">http://blog.csdn.net/abcjennifer/article/details/25908495</a></li>
<li><a href="https://theoreticalecology.wordpress.com/2010/09/17/metropolis-hastings-mcmc-in-r/" target="_blank" rel="noopener">https://theoreticalecology.wordpress.com/2010/09/17/metropolis-hastings-mcmc-in-r/</a></li>
</ol>
<hr>
<p><em>Kai Liu, wrote on 2017/11/13</em></p>
<p><em>Student ID: 116071910015</em></p>
<p><em>Mail: liu1995@sjtu.edu.cn</em></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">r</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">statistics</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">computational method</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="../../2017/11/14/Assignment-2-of-Advanced-Computational-Method/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Project-1-of-Statistics" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="../../2017/11/03/Project-1-of-Statistics/">Project 1 of Statistics.md</a>
    </h1>
  

        
        <a href="../../2017/11/03/Project-1-of-Statistics/" class="archive-article-date">
  	<time datetime="2017-11-03T12:36:27.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-11-03</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="一、准备阶段"><a href="#一、准备阶段" class="headerlink" title="一、准备阶段"></a>一、准备阶段</h2><p>本次实验主要考虑影响大倪体重各体型指标的因素。我们的数据收集了112组大鲵的体重(weight)、全长(tl)、体长(bl)、头长(hl)、体高(h)、体宽(w)、尾柄长(cl)和肠长(sl)。</p>
<p>利用统计软件R来实现，其中用到的包有<code>readxl</code>, <code>dplyr</code>, <code>ggplot2</code>, <code>car</code>。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(readxl)</span><br><span class="line"><span class="keyword">library</span>(dplyr)</span><br><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line"><span class="keyword">library</span>(car)</span><br></pre></td></tr></table></figure>
<p>首先，利用<code>read_excel</code>语句导入数据为新的数据框，并利用<code>str()</code>函数展示一下大致的数据结构。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = tbl_df(read_excel(<span class="string">"/path/to/data.xls"</span>))</span><br><span class="line">str(df)</span><br></pre></td></tr></table></figure>
<pre><code>Classes ‘tbl_df’, ‘tbl’ and &apos;data.frame&apos;:    112 obs. of  8 variables:
 $ weight: num  2.3 2.4 2.5 2.7 2.8 3 3.2 3.4 3.5 3.6 ...
 $ tl    : num  5.7 5.73 5.9 6.12 6.2 ...
 $ bl    : num  4.9 4.53 4.65 4.85 5.1 5 5.1 6.25 5.25 5.2 ...
 $ hl    : num  1.6 1.63 1.85 1.7 1.75 1.73 1.7 2.08 1.9 1.8 ...
 $ h     : num  0.9 0.93 1.05 1.05 1 1.1 1 1.28 1.05 1.1 ...
 $ w     : num  1 1.1 1 1.1 1.1 1.13 1.1 1.43 1.2 1.2 ...
 $ cl    : num  1.2 1.12 1.2 1.1 1.3 1.27 1.1 1.32 1.35 1.4 ...
 $ sl    : num  4.7 4.3 4.7 4.6 4.2 5 5 6.3 5.75 3.9 ...
</code></pre><p>下面对影响体重的体型指标做多元线性回归。</p>
<h2 id="二、多元线性回归"><a href="#二、多元线性回归" class="headerlink" title="二、多元线性回归"></a>二、多元线性回归</h2><h3 id="1-检测二变量关系"><a href="#1-检测二变量关系" class="headerlink" title="1. 检测二变量关系"></a>1. 检测二变量关系</h3><p>首先，检查一下变量间的相关性。可以利用<code>car</code>包中<code>scatterplotMatrix()</code>函数生成散点图矩阵</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scatterplotMatrix(df, spread=<span class="literal">FALSE</span>, smoother.args=list(lty=<span class="number">2</span>), main=<span class="string">"Scatter Plot Matrix"</span>)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/hw3/output_8_0.png"><br></div>


<p>从图中可以看到，大鲵体重随着体长、身长、头长、高度、宽度，尾长和肠长的增加而增加，可能有线性关系。</p>
<h3 id="2-多元线性回归及显著性检验"><a href="#2-多元线性回归及显著性检验" class="headerlink" title="2. 多元线性回归及显著性检验"></a>2. 多元线性回归及显著性检验</h3><p>下面使用<code>lm()</code>函数拟合多元线性回归模型：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mod1 &lt;- lm(weight ~ tl + bl + hl + h + w + cl + sl, data=df)</span><br><span class="line">summary(mod1)</span><br></pre></td></tr></table></figure>
<pre><code>Call:
lm(formula = weight ~ tl + bl + hl + h + w + cl + sl, data = df)

Residuals:
     Min       1Q   Median       3Q      Max
-10.2719  -3.2688  -0.1753   2.2389  27.0821

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -31.0098     2.8396 -10.920  &lt; 2e-16 ***
tl            5.0452     1.6941   2.978 0.003609 **
bl           -8.0840     2.2201  -3.641 0.000425 ***
hl            3.1704     3.1763   0.998 0.320529
h             3.4869     2.0005   1.743 0.084289 .
w            26.1356     4.0578   6.441 3.75e-09 ***
cl            2.4080     3.2128   0.750 0.455246
sl           -0.8519     0.3111  -2.739 0.007262 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.867 on 104 degrees of freedom
Multiple R-squared:  0.8862,    Adjusted R-squared:  0.8785
F-statistic: 115.7 on 7 and 104 DF,  p-value: &lt; 2.2e-16
</code></pre><p>上表的最后一行表示自由度为 $7, 104$ 的F统计量取值为 $115.7$，在给定水平 $\alpha = 0.05$ 下， 算出的F统计量大于 $F<em>{7,104}(0.05)$ 的概率 $P(F</em>{7,104}(0.05)&gt;F)$  小于 $2.2\times 10^{-16}$，所以拒绝原假设，认为回归方程是显著的。</p>
<p>同时，注意到最后一列头长<code>hl</code>和尾柄长<code>cl</code>的回归系数对应的p值大于 $0.025$，认为头长和尾柄长对体重的影响不显著，因而可以将其从回归方程中剔除。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vars &lt;- names(df) %<span class="keyword">in</span>% c(<span class="string">"cl"</span>, <span class="string">"hl"</span>)</span><br><span class="line">newdf &lt;- df[!vars]</span><br><span class="line">newdf</span><br></pre></td></tr></table></figure>
<table><br><thead><tr><th scope="col">weight</th><th scope="col">tl</th><th scope="col">bl</th><th scope="col">h</th><th scope="col">w</th><th scope="col">sl</th></tr></thead><br><tbody><br>    <tr><td>2.3  </td><td>5.700</td><td>4.90 </td><td>0.90 </td><td>1.00 </td><td>4.70 </td></tr><br>    <tr><td>2.4  </td><td>5.730</td><td>4.53 </td><td>0.93 </td><td>1.10 </td><td>4.30 </td></tr><br>    <tr><td>2.5  </td><td>5.900</td><td>4.65 </td><td>1.05 </td><td>1.00 </td><td>4.70 </td></tr><br>    <tr><td>2.7  </td><td>6.125</td><td>4.85 </td><td>1.05 </td><td>1.10 </td><td>4.60 </td></tr><br>    <tr><td>2.8  </td><td>6.200</td><td>5.10 </td><td>1.00 </td><td>1.10 </td><td>4.20 </td></tr><br>    <tr><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr><br>    <tr><td> 49.6</td><td>14.90</td><td>12.70</td><td>2.50 </td><td>3.40 </td><td>11.80</td></tr><br>    <tr><td> 55.8</td><td>15.80</td><td>13.10</td><td>3.01 </td><td>3.30 </td><td> 9.70</td></tr><br>    <tr><td> 64.2</td><td>15.90</td><td>12.30</td><td>2.60 </td><td>3.50 </td><td>15.50</td></tr><br>    <tr><td> 64.9</td><td>15.10</td><td>12.50</td><td>2.30 </td><td>3.60 </td><td>13.90</td></tr><br>    <tr><td>101.2</td><td>18.40</td><td>15.20</td><td>3.30 </td><td>4.30 </td><td>14.20</td></tr><br></tbody><br></table>



<p>将体重<code>weight</code>对剩余的回归自变量重新做回归，然后再做显著性检验。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mod2 &lt;- lm(weight ~ tl + bl + w + sl, data=newdf)</span><br><span class="line">summary(mod2)</span><br></pre></td></tr></table></figure>
<pre><code>Call:
lm(formula = weight ~ tl + bl + w + sl, data = newdf)

Residuals:
     Min       1Q   Median       3Q      Max
-10.1155  -3.2318  -0.5772   2.5155  27.6941

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -28.8822     2.4665 -11.710  &lt; 2e-16 ***
tl            5.8369     1.6683   3.499 0.000683 ***
bl           -7.6708     2.1310  -3.600 0.000484 ***
w            28.8123     3.8875   7.411 3.07e-11 ***
sl           -0.8667     0.3059  -2.833 0.005514 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.908 on 107 degrees of freedom
Multiple R-squared:  0.8809,    Adjusted R-squared:  0.8764
F-statistic: 197.8 on 4 and 107 DF,  p-value: &lt; 2.2e-16
</code></pre><p>观测新表对应的 $p$ 值可知，回归方程是显著的，剩余的回归系数均显著不为0。其中回归系数含义为：一个预测变量增加一个单位，其他预测变量保持不变时，因变量将要增加的数量。如宽度<code>w</code>的回归系数为 $28.8123$，表示体长、身长等其他因素不变时，宽度每上升 $1\%$，体重将会上升 $28.8123\%$</p>
<p>总体来看，所有的预测变量解释了体重影响因素88.09%的方差,体重<code>w</code>总变动的 $88.09\%$ 可以由该经验回归方程解释。</p>
<h3 id="3-回归诊断"><a href="#3-回归诊断" class="headerlink" title="3. 回归诊断"></a>3. 回归诊断</h3><h4 id="3-1-Gauss-Markov-假设"><a href="#3-1-Gauss-Markov-假设" class="headerlink" title="3.1 Gauss Markov 假设"></a>3.1 Gauss Markov 假设</h4><p>首先考虑是否满足 $E(e)=0$，我们通过绘制学生化残差图来检验：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sresid &lt;- rstudent(mod2)</span><br><span class="line">fweight &lt;- fitted(mod2)</span><br><span class="line">myplot &lt;- ggplot(newdf, aes(fweight, sresid)) + geom_point()</span><br><span class="line">myplot &lt;- myplot + ggtitle(<span class="string">"Studentized residual vs. fitted weight"</span>)</span><br><span class="line">myplot &lt;- myplot + labs(x = <span class="string">"fitted weight"</span>) + labs(y = <span class="string">"studentized residual"</span>)</span><br><span class="line">myplot</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/hw3/output_17_1.png" width="60%/"><br></div>


<p>从上图可以看出，$(\hat w_i, r_i)$ 大致落在宽度为6的水平带 $|r_i|\leq 3$ 区域内，学生化残差 $r_i$ 是否服从标准正态分布可以通过绘制学生化残差的频率分布直方图和 Q-Q 图来进一步分析:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">hist(sresid, freq=<span class="literal">FALSE</span>, xlab=<span class="string">"Studentized Residual"</span>, main=<span class="string">"Distribution of Errors"</span>)</span><br><span class="line">curve(dnorm(x, mean=mean(sresid), sd=sd(sresid)), add=<span class="literal">TRUE</span>, col=<span class="string">"blue"</span>, lwd=<span class="number">2</span>)</span><br><span class="line">legend(<span class="string">"topright"</span>, legend=<span class="string">"Normal Curve"</span>, lty=<span class="number">1</span>, col=<span class="string">"blue"</span>, cex=<span class="number">.7</span>)</span><br><span class="line"></span><br><span class="line">qqPlot(mod2, labels=row.names(newdf), id.method=<span class="string">"identify"</span>, simulate=<span class="literal">TRUE</span>, main=<span class="string">"Q-Q Plot"</span>)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/hw3/output_19_0.png"><br></div>


<p>可以看出，除一个明显的离群点(112组数据)，Q-Q图近似于一条截距为0，斜率为1的直线，因此误差很好地服从了正态分布。</p>
<p>下面进行误差的独立性检验，使用<code>car</code>包提供的<code>Durbin-Watson</code>检验函数，能够检测误差的序列相关性。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">durbinWatsonTest(mod2)</span><br></pre></td></tr></table></figure>
<pre><code>lag Autocorrelation D-W Statistic p-value
  1       0.4479978     0.7615764       0
Alternative hypothesis: rho != 0
</code></pre><p>$p&lt;0.05$ 显著，说明误差之间不独立，有相关性。</p>
<p>下面考虑同方差性，利用<code>car</code>包提供的<code>ncvTest()</code>函数生成一个检验，零假设为误差方差不变，备择假设为误差方差随拟合值水平变化而变化。若检验显著，则说明存在异方差性。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ncvTest(mod2)</span><br></pre></td></tr></table></figure>
<pre><code>Non-constant Variance Score Test
Variance formula: ~ fitted.values
Chisquare = 117.0427    Df = 1     p = 2.809471e-27
</code></pre><p>$p&lt;0.05$显著，拒绝同方差假设。我们还可以通过分布水平图(非水平趋势)验证这一点：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spreadLevelPlot(mod2)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/hw3/output_26_2.png" width="60%/"><br></div>


<p>综上，该模型不满足Gauss Markov假设。</p>
<h4 id="3-2-异常点检验"><a href="#3-2-异常点检验" class="headerlink" title="3.2 异常点检验"></a>3.2 异常点检验</h4><p>由上面的残差图可以看出，最后一组数据的残差较其他数据的残差大很多，因此该数据为<em>异常点</em>。由于异常点的检验是一个复杂的问题，我们不能确定异常点的个数，因此不能进一步处理。</p>
<p>高杠杆值的观测点可以通过<em>帽子统计量</em>判断，对于此处的数据集，帽子均值为$p/n=5/112$，其中 $p$是模型估计的参数数目(包含截距项)，$n$ 是样本量。一般来说，观测点的帽子值大于帽子均值的2或3倍，就可以认定为高杠杆值点。下面画出帽子值的分布：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hat.plot &lt;- <span class="keyword">function</span> (mod2) &#123;</span><br><span class="line">    p &lt;- length(coefficients(mod2))</span><br><span class="line">    n &lt;- length(fitted(mod2))</span><br><span class="line">    plot(hatvalues(mod2), main = <span class="string">"Index Plot of Hat Values"</span>)</span><br><span class="line">    abline(h=c(<span class="number">2</span>,<span class="number">3</span>)*p/n, col=<span class="string">"red"</span>, lty=<span class="number">2</span>)</span><br><span class="line">    identify(<span class="number">1</span>:n, hatvalues(mod2), names(hatvalues(mod2)))</span><br><span class="line">&#125;</span><br><span class="line">hat.plot(mod2)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/hw3/output_30_1.png" width="60%/"><br></div>


<p>此图中可以看出有四个高杠杆值点。</p>
<p>下面根据Cook距离检测强影响点，考虑Cook’s D值大于 $4/(n-k-1)$，其中 $n$ 为样本量大小，$k$ 是预测变量数目。可通过如下代码绘制Cook’s D图形：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cutoff &lt;- <span class="number">4</span>/(nrow(newdf)-length(mod2$coefficients)-<span class="number">2</span>)</span><br><span class="line">plot(mod2, which=<span class="number">4</span>, cook.levels=cutoff)</span><br><span class="line">abline(h=cutoff, lty=<span class="number">2</span>, col=<span class="string">"red"</span>)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/hw3/output_32_0.png" width="60%/"><br></div>

<p>通过图形可以判断第 $24, 110$ 组数据是强影响点（第112组为异常点），若删除强影响点，将会导致回归模型的截距项和斜率发生显著变化。</p>
<p>其实，利用<code>car</code>包中的<code>influencePlot()</code>函数，可以将离群点，高杠杆值点和强影响点的信息整合到一副图形中：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">influencePlot(mod2, id.method=<span class="string">"identity"</span>, main=<span class="string">"Influence Plot"</span>, sub=<span class="string">"Circle size is proportional to Cook's"</span>)</span><br></pre></td></tr></table></figure>
<table><br><thead><tr><th></th><th scope="col">StudRes</th><th scope="col">Hat</th><th scope="col">CookD</th></tr></thead><br><tbody><br>    <tr><th scope="row">24</th><td>-1.635591</td><td>0.3859345</td><td>0.3310792</td></tr><br>    <tr><th scope="row">112</th><td> 8.156196</td><td>0.2284171</td><td>2.4427929</td></tr><br></tbody><br></table>



<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/hw3/output_34_1.png" width="80%/"><br></div>


<h2 id="三、结论"><a href="#三、结论" class="headerlink" title="三、结论"></a>三、结论</h2><p>经验线性回归模型</p>
<p>$$<br>weight = -28.8822 + 5.8369<em>tl + -7.6708</em>bl + 28.8123<em>w + -0.8667</em>sl<br>$$</p>
<p>虽然可以解释体重总变动的 $88.09\%$，但是不满足Gauss Markov假设，仍待改善。</p>
<h2 id="四、参考文献"><a href="#四、参考文献" class="headerlink" title="四、参考文献"></a>四、参考文献</h2><ol>
<li>R in action Data Analysis and Graphics with R (Second Edition)</li>
<li>线性模型引论（王松桂、史建红等）</li>
<li>线性统计模型 (王松桂、陈敏等编</li>
<li>数据集地址：<a href="http://leanote.com/api/file/getAttach?fileId=59fbe27cab644137db000a2b" target="_blank" rel="noopener">http://leanote.com/api/file/getAttach?fileId=59fbe27cab644137db000a2b</a></li>
</ol>
<div style="page-break-after: always;"></div>

<h2 id="Homework-3"><a href="#Homework-3" class="headerlink" title="Homework 3"></a>Homework 3</h2><h3 id="3-16"><a href="#3-16" class="headerlink" title="3.16"></a>3.16</h3><p><strong>Box-Cox变换与加权最小二乘</strong></p>
<p>(1)</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tree = tbl_df(read.csv(<span class="string">"~/tree.csv"</span>))</span><br><span class="line">mod3 &lt;- lm(Y ~ X1 + X2, data=tree)</span><br><span class="line">summary(mod3)</span><br></pre></td></tr></table></figure>
<pre><code>Call:
lm(formula = Y ~ X1 + X2, data = tree)

Residuals:
    Min      1Q  Median      3Q     Max
-6.4065 -2.6493 -0.2876  2.2003  8.4847

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -57.9877     8.6382  -6.713 2.75e-07 ***
X1            4.7082     0.2643  17.816  &lt; 2e-16 ***
X2            0.3393     0.1302   2.607   0.0145 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 3.882 on 28 degrees of freedom
Multiple R-squared:  0.948,    Adjusted R-squared:  0.9442
F-statistic:   255 on 2 and 28 DF,  p-value: &lt; 2.2e-16
</code></pre><p>由上表，$X2$ 的回归系数不显著，故剔除后重新回归：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mod4 &lt;- lm(Y ~ X1, data=tree)</span><br><span class="line">summary(mod4)</span><br></pre></td></tr></table></figure>
<pre><code>Call:
lm(formula = Y ~ X1, data = tree)

Residuals:
   Min     1Q Median     3Q    Max
-8.065 -3.107  0.152  3.495  9.587

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -36.9435     3.3651  -10.98 7.62e-12 ***
X1            5.0659     0.2474   20.48  &lt; 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.252 on 29 degrees of freedom
Multiple R-squared:  0.9353,    Adjusted R-squared:  0.9331
F-statistic: 419.4 on 1 and 29 DF,  p-value: &lt; 2.2e-16
</code></pre><p>得到经验线性回归方程</p>
<p>$$<br>Y = -36.9435 + 5.0659*X1<br>$$</p>
<p>下面作出残差图：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sresid &lt;- rstudent(mod4)</span><br><span class="line">fweight &lt;- fitted(mod4)</span><br><span class="line">plot3_16 &lt;- ggplot(tree, aes(Y, sresid)) + geom_point()</span><br><span class="line">plot3_16 &lt;- plot3_16 + ggtitle(<span class="string">"Studentized residual vs. fitted Y"</span>)</span><br><span class="line">plot3_16 &lt;- plot3_16 + labs(x = <span class="string">"fitted Y"</span>) + labs(y = <span class="string">"studentized residual"</span>)</span><br><span class="line">plot3_16</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/hw3/output_42_1.png" width="60%/"><br></div>


<p>残差和拟合值的关系大致呈现喇叭形，说明拟合值与残差不相互独立，不满足 Gauss Markov 假设，故进行 Box-Cox 变换：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(MASS)</span><br><span class="line">boxcox(mod4)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/hw3/output_44_1.png" width="60%/"><br></div>


<p>可以由上图看出最优变换参数 $\lambda$ 在 $0$ 附近，进一步做计算找出 $\lambda$ 的最优值：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summary(powerTransform(mod4))</span><br></pre></td></tr></table></figure>
<pre><code>bcPower Transformation to Normality
   Est.Power Std.Err. Wald Lower Bound Wald Upper Bound
Y1    0.3791   0.1216           0.1408           0.6175

Likelihood ratio tests about transformation parameters
                            LRT df         pval
LR test, lambda = (0)  8.362665  1 3.830084e-03
LR test, lambda = (1) 21.004754  1 4.581452e-06
</code></pre><p>得到最优变换参数为<code>0.3791</code></p>
<p>(2)</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">newY &lt;- (tree$Y^(<span class="number">0.3791</span>)-<span class="number">1</span>)/<span class="number">0.3791</span></span><br><span class="line">newtree &lt;- cbind(tree, newY)</span><br><span class="line">mod5 &lt;- lm(newY ~ X1 + X2, data=newtree)</span><br><span class="line">summary(mod5)</span><br></pre></td></tr></table></figure>
<pre><code>Call:
lm(formula = newY ~ X1 + X2, data = newtree)

Residuals:
     Min       1Q   Median       3Q      Max
-0.57136 -0.17434 -0.02026  0.24693  0.45782

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -4.17273    0.64775  -6.442 5.62e-07 ***
X1           0.53242    0.01982  26.868  &lt; 2e-16 ***
X2           0.04975    0.00976   5.098 2.12e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2911 on 28 degrees of freedom
Multiple R-squared:  0.9775,    Adjusted R-squared:  0.9759
F-statistic: 609.4 on 2 and 28 DF,  p-value: &lt; 2.2e-16
</code></pre><p>经过Box-Cox变换后的经验回归方程仍显著，且能解释<code>Y</code>的变化的 $97.75\%$。</p>
<p>下面作残差图，检验Gauss Markov假设：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sresid &lt;- rstudent(mod5)</span><br><span class="line">fittedY &lt;- fitted(mod5)</span><br><span class="line">newplot3_16 &lt;- ggplot(newtree, aes(fittedY, sresid)) + geom_point()</span><br><span class="line">newplot3_16 &lt;- newplot3_16 + ggtitle(<span class="string">"Studentized residual vs. fitted Y"</span>)</span><br><span class="line">newplot3_16 &lt;- newplot3_16 + labs(x = <span class="string">"fitted Y"</span>) + labs(y = <span class="string">"studentized residual"</span>)</span><br><span class="line">newplot3_16</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/hw3/output_50_1.png" width="60%/"><br></div>


<p>进一步作正态性检验,作如下学生化残差分布图和Q-Q图：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">hist(sresid, freq=<span class="literal">FALSE</span>, xlab=<span class="string">"Studentized Residual"</span>, main=<span class="string">"Distribution of Errors"</span>)</span><br><span class="line">curve(dnorm(x, mean=mean(sresid), sd=sd(sresid)), add=<span class="literal">TRUE</span>, col=<span class="string">"blue"</span>, lwd=<span class="number">2</span>)</span><br><span class="line">legend(<span class="string">"topleft"</span>, legend=<span class="string">"Normal Curve"</span>, lty=<span class="number">1</span>, col=<span class="string">"blue"</span>, cex=<span class="number">.7</span>)</span><br><span class="line"></span><br><span class="line">qqPlot(mod5, labels=row.names(newtree), id.method=<span class="string">"identify"</span>, simulate=<span class="literal">TRUE</span>, main=<span class="string">"Q-Q Plot"</span>)</span><br></pre></td></tr></table></figure>
<div align="center"><br><img src="http://oye4atjxc.bkt.clouddn.com/statistic/hw3/output_52_0.png"><br></div>


<p>可以看出经过Box-Cox变换后，经验回归模型相比原模型有明显改善。</p>
<p>(3)</p>
<p>下面我们继续对数据集<code>tree</code>做加权最小二乘回归，编写如下<code>wls</code>函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">wls &lt;- <span class="keyword">function</span>(linear_mod, iterations = <span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">  X &lt;- model.matrix(linear_mod)   <span class="comment"># design matrix</span></span><br><span class="line">  H &lt;- solve(t(X) %*% X) %*% t(X) <span class="comment"># hat matrix</span></span><br><span class="line">  Y &lt;- linear_mod$model[,<span class="number">1</span>]       <span class="comment"># Y observed</span></span><br><span class="line">  size &lt;- nrow(linear_mod$model)  <span class="comment"># block dimensions</span></span><br><span class="line">  beta_ols &lt;- H %*% Y             <span class="comment"># The estimated coefficients using ols</span></span><br><span class="line">  resid &lt;- residuals(linear_mod)</span><br><span class="line">  sigma &lt;- diag(size) * as.vector(abs(resid)^<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">  beta_wls &lt;- solve(t(X) %*% solve(sigma) %*% X) %*% t(X) %*% solve(sigma) %*% Y</span><br><span class="line">  <span class="comment"># the estimated coefficients with weight least squares method (1st iteration)</span></span><br><span class="line"></span><br><span class="line">  beta_list &lt;- list(beta_ols, beta_wls)</span><br><span class="line"></span><br><span class="line">  i &lt;- <span class="number">3</span></span><br><span class="line">  <span class="keyword">while</span>(i &lt;= iterations)&#123;</span><br><span class="line"></span><br><span class="line">    Y_hat &lt;- X %*% beta_wls</span><br><span class="line"></span><br><span class="line">    resid &lt;- Y - Y_hat</span><br><span class="line"></span><br><span class="line">    W_hat &lt;- diag(size) * as.vector(abs(resid)^<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(abs(min(eigen(W_hat)$values)) &lt; <span class="number">1e-15</span>)&#123;<span class="keyword">break</span>&#125;</span><br><span class="line">    <span class="comment"># stops when the estimated covariance matrix (W.hat) becomes singular</span></span><br><span class="line"></span><br><span class="line">    beta_wls &lt;- solve(t(X) %*% solve(W_hat) %*% X) %*% t(X) %*% solve(W_hat) %*% Y</span><br><span class="line"></span><br><span class="line">    beta_list[[i]] &lt;- beta_wls</span><br><span class="line">    i &lt;- i+<span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>(beta_list)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>直接调用函数<code>wls(mod3)</code>可以给出如下结果：</p>
<ol><br>    <li><table><br><tbody><br>    <tr><th scope="row">(Intercept)</th><td>-57.9876589</td></tr><br>    <tr><th scope="row">X1</th><td>  4.7081605</td></tr><br>    <tr><th scope="row">X2</th><td>  0.3392512</td></tr><br></tbody><br></table><br></li><br>    <li><table><br><tbody><br>    <tr><th scope="row">(Intercept)</th><td>-58.6005437</td></tr><br>    <tr><th scope="row">X1</th><td>  4.7738483</td></tr><br>    <tr><th scope="row">X2</th><td>  0.3364717</td></tr><br></tbody><br></table><br></li><br></ol>


<p>从而，加权最小二乘模型为</p>
<p>$$<br>Y = -58.600543 + 4.7738483<em>X1 + 0.3364717</em>X2<br>$$</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">r</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">statistics</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="../../2017/11/03/Project-1-of-Statistics/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Assignment-1-of-Advanced-Computational-Method" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="../../2017/10/30/Assignment-1-of-Advanced-Computational-Method/">Assignment 1 of Advanced Computational Method</a>
    </h1>
  

        
        <a href="../../2017/10/30/Assignment-1-of-Advanced-Computational-Method/" class="archive-article-date">
  	<time datetime="2017-10-30T15:59:42.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-10-30</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Homework-1"><a href="#Homework-1" class="headerlink" title="Homework 1"></a>Homework 1</h2><p><strong>Monte Carlo method</strong> is a method to compute the expectation of a random variable.</p>
<p>The basic steps follow like this:</p>
<ol>
<li><p>draw random samples ${x_1, x_2, \cdots, x_n}$ according to $p(x)$.</p>
</li>
<li><p>derive the <em>monte carlo estimator</em> of $E(f)$ from</p>
</li>
</ol>
<p>$$<br>\hat{f}<em>{\text{mc}}=\frac{1}{n}\sum</em>{i=1}^n f(x_i)<br>$$</p>
<h3 id="Problem-1"><a href="#Problem-1" class="headerlink" title="Problem 1"></a>Problem 1</h3><blockquote>
<p>Suppose $x_1, x<em>2, \cdots, x</em>{10}$ satisfy independent identical distributions i.e. $x_i\sim N(0,1)\quad i=1,2,\cdots,10$</p>
<p>Set $f(x)=\sum_{i=1}^{10}x_i^2$, use <em>Monte Carlo method</em> to compute $E[f(x)]$.</p>
<p>Compare your results with the exact value.</p>
</blockquote>
<p><strong>Solution</strong>:</p>
<p>From basic statistics, we can deduce that<br>$$<br>\begin{align<em>}<br>Ef(x)&amp;=E\sum_{i=1}^{10}x_i^2=10\,Ex_i^2\<br>&amp;=10\,[Dx_i+(Ex_i)^2]\<br>&amp;=10\times(1+0)\<br>&amp;=10<br>\end{align</em>}<br>$$</p>
<p>Thus, the exact value of $E[f(x)]$ equals 10.</p>
<p>Continuely, we derive a Monte Carlo method for evaluating $E[f(x)]$</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Distributions</span><br><span class="line"><span class="meta">@everywhere</span> <span class="keyword">function</span> MC_mean(N::<span class="built_in">Int</span>)</span><br><span class="line">    <span class="comment"># N = number of Monto Carlo points</span></span><br><span class="line"></span><br><span class="line">    x = rand(Normal(<span class="number">0</span>, <span class="number">1</span>), N); <span class="comment"># draw random samples</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span> * mean(x.^<span class="number">2</span>) <span class="comment"># return the Monte Carlo estimator of f</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">MC_mean(<span class="number">10</span>^<span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">9.98580160514502</span></span><br></pre></td></tr></table></figure>
<p>A billion Monte Carlo steps yields an even better estimate:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MC_mean(<span class="number">10</span>^<span class="number">9</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">10.000288570895224</span></span><br></pre></td></tr></table></figure>
<p>Now, let’s take a brief look at the time cost.</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@elapsed</span> MC_mean(<span class="number">10</span>^<span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0.013395715</span></span><br></pre></td></tr></table></figure>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@elapsed</span> MC_mean(<span class="number">10</span>^<span class="number">9</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">50.939757386</span></span><br></pre></td></tr></table></figure>
<p>When it comes to Monte Carlo simulation, our goal is to get good data as fast as possible. For now, let’s look at how to speed up our code. First of all, we can easily notice the time cost grows out of all proportion. The calculation for 1 million Monte Carlo cost is over 1000 times faster than the billion’s.</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="meta">@elapsed</span> MC_mean(<span class="number">10</span>^<span class="number">9</span>))/(<span class="meta">@elapsed</span> MC_mean(<span class="number">10</span>^<span class="number">6</span>))</span><br></pre></td></tr></table></figure>
<pre><code>1286.3957285556933
</code></pre><p>Of course, we can do better than this. In preparation for these calculations, let us introduce a <strong>parallel computation</strong> for Monte Carlo simulation. We build a function that takes <code>MC_mean</code> and evenly splits the jobs to our processors:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> parallel_calc(f::<span class="built_in">Function</span>, N::<span class="built_in">Int</span>, proc::<span class="built_in">Int</span>=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># f = some predefined function</span></span><br><span class="line">    <span class="comment"># N = number of Monte Carlo steps</span></span><br><span class="line">    <span class="comment"># proc = number of additional processors, preset to four</span></span><br><span class="line"></span><br><span class="line">    n = round(<span class="built_in">Int</span>, N/proc); <span class="comment"># split the number of Monte Carlo steps equally between processors</span></span><br><span class="line"></span><br><span class="line">    proc_sum = <span class="meta">@parallel</span> (+) <span class="keyword">for</span> i=<span class="number">1</span>:proc <span class="comment"># loop through the processors and distribute jobs</span></span><br><span class="line">        f(n)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> proc_sum / proc <span class="comment"># return the average of the parallel jobs</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<pre><code>parallel_calc (generic function with 2 methods)
</code></pre><p>Now, we can quickly and efficiently calculate a billion MC samples:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@elapsed</span> parallel_calc(MC_mean, <span class="number">10</span>^<span class="number">9</span>)</span><br></pre></td></tr></table></figure>
<pre><code>21.05725137
</code></pre><p>There is also an easier way to see the speed up of parallel processing by plotting the elapsed time. Below, we define a simple code to plot the elapsed times of <code>MC_mean</code>(in blue) and parallel (in red) vs. the number of MC samplings:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> PyPlot</span><br><span class="line">PyPlot.svg(<span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> mean_time_plotter(N::<span class="built_in">Int</span>)</span><br><span class="line">    n = <span class="built_in">Int64</span>(N/<span class="number">10</span>) <span class="comment"># ensure that you only plot 10 points</span></span><br><span class="line"></span><br><span class="line">    plot(collect(<span class="number">1</span>:n:N),[<span class="meta">@elapsed</span> MC_mean(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">10</span>:n:N], linestyle=<span class="string">"--"</span>, marker=<span class="string">"."</span>, color=<span class="string">"blue"</span>, label=<span class="string">"Single Processor"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># the above plots mean for 10 values of MC steps from 10 to N vs. the number of MC steps</span></span><br><span class="line"></span><br><span class="line">    plot(collect(<span class="number">1</span>:n:N),[<span class="meta">@elapsed</span> parallel_calc(MC_mean,i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">10</span>:n:N], linestyle=<span class="string">"--"</span>, marker=<span class="string">"."</span>, color=<span class="string">"red"</span>, label=<span class="string">"Parallel Processor"</span>)</span><br><span class="line"></span><br><span class="line">    title(<span class="string">"Comparison of Parallel vs. Single Processor MC Efficiency"</span>) <span class="comment"># make title and labels</span></span><br><span class="line">    ylabel(<span class="string">"Elapsed Time (sec)"</span>)</span><br><span class="line">    xlabel(<span class="string">"# of random points"</span>)</span><br><span class="line"></span><br><span class="line">    legend(bbox_to_anchor=(<span class="number">1.05</span>, <span class="number">1</span>), loc=<span class="number">2</span>, borderaxespad=<span class="number">0.</span>) <span class="comment"># anchor the legend</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<pre><code>mean_time_plotter (generic function with 1 method)
</code></pre><figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mean_time_plotter(<span class="number">10</span>^<span class="number">9</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment1/output_15_0.svg"></p>
<pre><code>PyObject &lt;matplotlib.legend.Legend object at 0x132777510&gt;
</code></pre><p>We can see that the elapsed time of simulation is approximately equal around 0.7 billion MC samplings, after which parallel processing begins to win in favor of the single processor. This trend is continued when we look at a billion MC samples.</p>
<p>Now, we turn to present this MC data and visualize the error. To do this, let’s write a simple program to plot the output of parallel vs. the number of Monte Carlo samplings. Because we already know what the mean is, let’s also plot the accepted value as a straight line in red. Finally, let’s also calculate the percent error and display it in the title. The format used here will be useful in later code where we have to compare with some exact analytical value. The following tedious codes (if I remember to present) are quite similar to each other.</p>
<p>However, one thing unfortunate is that the parallel efficiency does <strong>not</strong> high within one billion samples. In proper case, for example, we need fast result,  single processor is fairly enough.</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> MC_mean_plotter(f::<span class="built_in">Function</span>, N::<span class="built_in">Int</span>, m::<span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line">    n = <span class="built_in">Int64</span>(N/m) <span class="comment"># define the step size between points to plot</span></span><br><span class="line"></span><br><span class="line">    mean_list = [parallel_calc(f,i) <span class="keyword">for</span> i <span class="keyword">in</span> n:n:N] <span class="comment"># generate list of mean values from parallel for i MC steps</span></span><br><span class="line"></span><br><span class="line">    plot(collect(n:n:N), mean_list, linestyle=<span class="string">"--"</span>, marker=<span class="string">"."</span>,</span><br><span class="line">        color=<span class="string">"blue"</span>, label=string(<span class="string">L"MC Estimator: "</span>, round(mean_list[<span class="keyword">end</span>],<span class="number">6</span>)))</span><br><span class="line">    <span class="comment"># in the above, we plot the MC estimate of 10 vs. the number of MC steps</span></span><br><span class="line"></span><br><span class="line">    axhline(y=<span class="number">10</span>, linestyle=<span class="string">"-"</span>, color=<span class="string">"red"</span>, label=string(<span class="string">"Exact Value: "</span>, <span class="number">10</span>))</span><br><span class="line">    <span class="comment"># in the above, we plot a horizontal line at the 10 value</span></span><br><span class="line"></span><br><span class="line">    per_error = <span class="number">100</span>*abs((mean_list[<span class="keyword">end</span>]-<span class="number">10</span>)/(mean_list[<span class="keyword">end</span>])) <span class="comment"># calculate percent error from mean_list</span></span><br><span class="line"></span><br><span class="line">    title(string(<span class="string">L"Monte Carlo Estimation of $10$--within "</span>, round(per_error,<span class="number">5</span>), <span class="string">"%"</span>)) <span class="comment"># make titles and labels</span></span><br><span class="line">    ylabel(<span class="string">"Estimation of 10"</span>)</span><br><span class="line">    xlabel(<span class="string">"# of random points"</span>)</span><br><span class="line"></span><br><span class="line">    legend(bbox_to_anchor=(<span class="number">1.05</span>,<span class="number">1</span>), loc=<span class="number">2</span>, borderaxespad=<span class="number">0.</span>) <span class="comment"># make legend</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<pre><code>MC_mean_plotter (generic function with 1 method)
</code></pre><p>To get a nice plot, we take a maximum of a million Monte Carlo samples and plot a total of a hundred points:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MC_mean_plotter(MC_mean, <span class="number">10</span>^<span class="number">9</span>, <span class="number">100</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment1/output_19_0.svg"></p>
<pre><code>PyObject &lt;matplotlib.legend.Legend object at 0x1326e2cd0&gt;
</code></pre><p>Although we appear to obtain a reasonable value for 10(below 0.00421%!), it is difficult to see how well the data is converging. Therefore, let’s build a new function that calculates a list of $M$ Monte Carlo estimates of 10 at a given value of $N$. From this list, we can obtain the average and standard deviation:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> stat_calc(f::<span class="built_in">Function</span>, N::<span class="built_in">Int</span>, M::<span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># f = some general function</span></span><br><span class="line"><span class="comment"># N = number of Monte Carlo steps</span></span><br><span class="line"><span class="comment"># M = number of times to repeat a single MC step to for statistical analysis</span></span><br><span class="line"></span><br><span class="line">    avg_list = [parallel_calc(f,N) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="number">1</span>:M] <span class="comment"># create list of MC data of length M</span></span><br><span class="line"></span><br><span class="line">    avg = sum(avg_list)/M <span class="comment"># calculate average of MC data</span></span><br><span class="line"></span><br><span class="line">    stdev = std(avg_list) <span class="comment"># calculate standard deviation of MC data</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> avg, stdev</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<pre><code>stat_calc (generic function with 1 method)
</code></pre><p>Now, we can modify <code>MC_mean_plotter</code> to include error bars to better visualize the convergence of our data:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> MC_errorbar(f::<span class="built_in">Function</span>, N::<span class="built_in">Int</span>, m::<span class="built_in">Int</span>, M::<span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># f = some general function</span></span><br><span class="line"><span class="comment"># N = number of Monte Carlo steps</span></span><br><span class="line"><span class="comment"># m = number of points to plot</span></span><br><span class="line"><span class="comment"># M = number of times to repeat a single MC step to for statistical analysis</span></span><br><span class="line"></span><br><span class="line">    n = <span class="built_in">Int64</span>(N/m) <span class="comment"># define the step size between points to plot</span></span><br><span class="line"></span><br><span class="line">    stat_list = [stat_calc(f,i,M) <span class="keyword">for</span> i <span class="keyword">in</span> n:n:N] <span class="comment"># make a list of averages and standard deviations from stat_calc</span></span><br><span class="line">    avg_list = [stat_list[i][<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>:m] <span class="comment"># create list of averages</span></span><br><span class="line">    stdev_list = [stat_list[i][<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>:m] <span class="comment"># create list of standard deviations</span></span><br><span class="line"></span><br><span class="line">    errorbar(collect(n:n:N), avg_list, yerr=stdev_list, linestyle=<span class="string">"--"</span>, marker=<span class="string">"."</span>,</span><br><span class="line">        color=<span class="string">"blue"</span>, label=string(<span class="string">"MC Estimate: "</span>, round(avg_list[<span class="keyword">end</span>], <span class="number">6</span>)))</span><br><span class="line">    <span class="comment"># in the above, we plot the averages vs. MC step size with error bars of the standard deviation</span></span><br><span class="line"></span><br><span class="line">    axhline(y=<span class="number">10</span>, linestyle=<span class="string">"-"</span>, color=<span class="string">"red"</span>, label=string(<span class="string">"Exact Value: "</span>, <span class="number">10</span>))</span><br><span class="line">    <span class="comment"># in the above, we plot a horizontal line at the 10 value</span></span><br><span class="line"></span><br><span class="line">    per_error = <span class="number">100</span>*abs((avg_list[<span class="keyword">end</span>]-<span class="number">10</span>)/(avg_list[<span class="keyword">end</span>])) <span class="comment"># calculate percent error</span></span><br><span class="line"></span><br><span class="line">    title(string(<span class="string">L"Monte Carlo Estimation of $10$--within "</span>, round(per_error,<span class="number">5</span>), <span class="string">"%"</span>)) <span class="comment"># make titles and labels</span></span><br><span class="line">    ylabel(<span class="string">"Estimation of 10"</span>)</span><br><span class="line">    xlabel(<span class="string">"# of random points"</span>)</span><br><span class="line"></span><br><span class="line">    legend(bbox_to_anchor=(<span class="number">1.05</span>,<span class="number">1</span>), loc=<span class="number">2</span>, borderaxespad=<span class="number">0.</span>) <span class="comment"># make legend</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<pre><code>MC_errorbar (generic function with 1 method)
</code></pre><p>With <code>MC_mean_plot</code>, we can easily generalize the program in future modification.</p>
<p>Now, we plot a hundred values of MC samples with a maximum of a billion, with each set of samples performed fifteen times for statistical analysis. The resulting data shows a clear convergence of error.</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MC_errorbar(MC_mean, <span class="number">10</span>^<span class="number">6</span>, <span class="number">100</span>, <span class="number">15</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment1/output_25_0.svg"></p>
<pre><code>PyObject &lt;matplotlib.legend.Legend object at 0x1262c3fd0&gt;
</code></pre><p>We can test our result by looking at the convergence of the standard deviation with increasing sample size. Recall the Monte Carlo estimation of the integral of some general function $f(x)$</p>
<p>$$<br>\int<em>a^b f(x)dx = \frac{b-a}{N}\sum</em>{i=0}^{N-1}E(f(x_i))<br>$$</p>
<p>The st.dev. squared can easily be calculated:</p>
<p>$$<br>\sigma<em>{int}^2 = \frac{b-a}{N^2}\left( \sum</em>{i=0}^{N-1}E(f(x_i)) \right)<br>$$</p>
<p>If the random variables $x_i$ are uncorrelated, we can easily simplify the above further:</p>
<p>$$<br>\begin{split}<br>\sigma<em>{int}^2 &amp;= \frac{b-a}{N^2}\sum</em>{i=0}^{N-1}\sigma^2(E(f(x_i))) \<br>&amp;= \frac{b-a}{N}\sigma^2(E(f(x)))<br>\end{split}<br>$$</p>
<p>Therefore, we find that the st.dev. goes as the inverse of the square of the sample size:</p>
<p>$$<br>\sigma_{int}\propto\frac{1}{\sqrt{N}}<br>$$</p>
<p>To test this result, we plot the numerically calculated st.dev. alongside $1/\sqrt{N}$</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> MC_errorbar_visual(f::<span class="built_in">Function</span>, N::<span class="built_in">Int</span>, m::<span class="built_in">Int</span>, M::<span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># f = some general function</span></span><br><span class="line"><span class="comment"># N = number of Monte Carlo steps</span></span><br><span class="line"><span class="comment"># m = number of points to plot</span></span><br><span class="line"><span class="comment"># M = number of times to repeat a single MC step to for statistical analysis</span></span><br><span class="line"></span><br><span class="line">    n = <span class="built_in">Int64</span>(N/m) <span class="comment"># define the step size between points to plot</span></span><br><span class="line"></span><br><span class="line">    stat_list = [stat_calc(f,i,M) <span class="keyword">for</span> i <span class="keyword">in</span> n:n:N] <span class="comment"># make a list of averages and standard deviations from stat_calc</span></span><br><span class="line">    stdev_list = [stat_list[i][<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>:m] <span class="comment"># create list of standard deviations</span></span><br><span class="line"></span><br><span class="line">    plot(collect(n:n:N), stdev_list, linestyle=<span class="string">"--"</span>, marker=<span class="string">"."</span>, color=<span class="string">"blue"</span>) <span class="comment"># plot the list of st.dev from MC data</span></span><br><span class="line"></span><br><span class="line">    plot(collect(n:n:N), [<span class="number">1</span>/i^(<span class="number">1</span>/<span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> n:n:N], linestyle=<span class="string">"--"</span>, color=<span class="string">"red"</span>) <span class="comment"># plot the prediction for the st.dev</span></span><br><span class="line"></span><br><span class="line">    title(string(<span class="string">"Convergence of Error bars in MC Data"</span>)) <span class="comment"># make titles and labels</span></span><br><span class="line">    ylabel(<span class="string">"Standard Deviation"</span>)</span><br><span class="line">    xlabel(<span class="string">"# of random points"</span>)</span><br><span class="line"></span><br><span class="line">    legend(bbox_to_anchor=(<span class="number">1.05</span>,<span class="number">1</span>), loc=<span class="number">2</span>, borderaxespad=<span class="number">0.</span>) <span class="comment"># make legend</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<pre><code>MC_errorbar_visual (generic function with 1 method)
</code></pre><p>Running a maximum of a million samples in steps of a hundred, we find roughly the expected behavior, with each sample repeated fifteen times for statistical analysis.</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MC_errorbar_visual(MC_mean, <span class="number">10</span>^<span class="number">6</span>, <span class="number">100</span>, <span class="number">15</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment1/output_29_0.svg"></p>
<h3 id="Problem-2"><a href="#Problem-2" class="headerlink" title="Problem 2"></a>Problem 2</h3><p>Here we want to estimate the probability of a point location, i.e. $P[x\in\Omega]$</p>
<p>we have already learned that</p>
<p>$$<br>P[x\in\Omega] = \int_{\Omega}p(x)\,dx=\int I(x)p(x)\,dx = E_p[I]<br>$$</p>
<p>Now, set $\Omega: (x_1-5)^2+(x_2-5)^2\leq 1 $ , $p(x)$ to be the PDF (probability density function) of a binormal distribution i.e. $x_1, x_2 \sim N(0,1)$</p>
<blockquote>
<p>Use Importance Sampling method (<strong>choose best IS distribution</strong> $q(x)$) to get the best result.</p>
</blockquote>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/region.svg" style="zoom:65%"></p>
<p>The <strong>importance sampling method</strong> comes from a single idea like this</p>
<p>$$<br>\begin{align<em>}<br>P[x\in\Omega]&amp;= E_p[I]\<br>&amp;= \int I(x)p(x)\,dx \<br>&amp;= \int I(x)\frac{p(x)}{q(x)}\cdot q(x)\,dx = \int I(x)w(x)\cdot q(x)\,dx\<br>&amp;= E_q[I\cdot w]<br>\end{align</em>}<br>$$</p>
<p>Thus</p>
<p>$$<br>\hat{I}<em>\text{IS} = \frac1n \sum</em>{i=1}^n I(x_i)w(x_i) \qquad x_i\in q(x)<br>$$</p>
<p>where</p>
<p>$\hat{I}_\text{IS}: $ IS estimator ;      $q(x): $ IS distribution ;     $w(x) :$ IS weight ;</p>
<p>Assume that $q(x)$ is the PDF of a binormal distribution i.e. $q\sim N({\mu_1,\mu_2},1)$</p>
<p>the problem should be solve in following steps:</p>
<ol>
<li>choose samples according to $q(x)$ ;</li>
<li>use these samples to get the value of weight function $w(x)$ ;</li>
<li>apply monte carlo method to the calculation of $E[I\cdot w]$ ;</li>
<li>compare our result with the exact probability and filter the parameters ;</li>
</ol>
<p>To get the best result, the fourth step is always needed.</p>
<p>Actually, we can directly calculate the exact probability</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="keyword">Integrate</span>[</span><br><span class="line">  <span class="keyword">PDF</span>[<span class="keyword">BinormalDistribution</span>[&#123;0, 0&#125;, &#123;1, 1&#125;, <span class="number">0</span>], &#123;x, y&#125;], &#123;x, 4, 6&#125;, &#123;y,</span><br><span class="line">    5 - Sqrt[1 - (x - 5)^2], 5 + Sqrt[1 - (x - 5)^2]&#125;] // <span class="keyword">N</span></span><br></pre></td></tr></table></figure>
<p>which gives</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2.23465</span>*<span class="number">10</span>^<span class="number">-10</span></span><br></pre></td></tr></table></figure>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Distributions</span><br><span class="line"><span class="meta">@everywhere</span> <span class="keyword">function</span> MC_prob(μ<span class="number">1</span>::<span class="built_in">Float64</span>, μ<span class="number">2</span>::<span class="built_in">Float64</span>, N::<span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># N = number of Monto Carlo points</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># step 1. set initial values and draw random samples</span></span><br><span class="line">    r = -<span class="number">1</span></span><br><span class="line">    <span class="literal">I</span> = zeros(N,<span class="number">1</span>)</span><br><span class="line">    x = rand(Normal(μ<span class="number">1</span>, <span class="number">1</span>), N)</span><br><span class="line">    y = rand(Normal(μ<span class="number">2</span>, <span class="number">1</span>), N)</span><br><span class="line"></span><br><span class="line"><span class="comment"># step 2. use these samples to get function values I, p, q, w</span></span><br><span class="line">    g = -(x-<span class="number">5</span>).^<span class="number">2</span>-(y-<span class="number">5</span>).^<span class="number">2</span></span><br><span class="line">    <span class="comment">## construct the indicator function</span></span><br><span class="line">    <span class="keyword">for</span> i=<span class="number">1</span>:<span class="number">1</span>:N</span><br><span class="line">        <span class="keyword">if</span> g[i] &gt; r</span><br><span class="line">            <span class="literal">I</span>[i] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="literal">I</span>[i] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    p = <span class="number">1</span>/(<span class="number">2</span>*<span class="literal">π</span>) * exp.(-<span class="number">1</span>/<span class="number">2</span> * (x.^<span class="number">2</span> + y.^<span class="number">2</span>))</span><br><span class="line">    q = <span class="number">1</span>/(<span class="number">2</span>*<span class="literal">π</span>) * exp.(-<span class="number">1</span>/<span class="number">2</span> * ((x-<span class="number">5</span>).^<span class="number">2</span> + (y-<span class="number">5</span>).^<span class="number">2</span>))</span><br><span class="line">    w = p./q</span><br><span class="line"></span><br><span class="line"><span class="comment"># step 3. apply Monte Carlo to calculate the expectation</span></span><br><span class="line">    <span class="keyword">return</span> mean(<span class="literal">I</span>.*w)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>A natural thought is to set $\mu1=\mu2=5$, $N=10^5$, but the simulated probability seems to be flawed:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MC_prob(<span class="number">5.0</span>, <span class="number">5.0</span>, <span class="number">10</span>^<span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<pre><code>2.2415303094407912e-10
</code></pre><p>Indicated by the parameter choosing rules, we can set $\mu1=\mu2$ and make a simple plot of errors on the specific line $y=x$.</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> PyPlot</span><br><span class="line">PyPlot.svg(<span class="literal">true</span>)</span><br><span class="line"><span class="keyword">function</span> error_plotter(N::<span class="built_in">Int</span>)</span><br><span class="line">    plot(collect(<span class="number">1.0</span>:<span class="number">0.1</span>:<span class="number">5.0</span>), [MC_prob(i,i,N) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1.0</span>:<span class="number">0.1</span>:<span class="number">5.0</span>],</span><br><span class="line">    linestyle=<span class="string">"--"</span>, marker=<span class="string">"."</span>, color=<span class="string">"blue"</span>, label=<span class="string">"Single Processor"</span>)</span><br><span class="line"></span><br><span class="line">    axhline(y=<span class="number">2.23465e-10</span>, linestyle=<span class="string">"-"</span>, color=<span class="string">"red"</span>, label=string(<span class="string">"Exact Value: "</span>, <span class="number">2.23465e-10</span>))</span><br><span class="line"></span><br><span class="line">    title(string(<span class="string">"Monte Carlo Estimation of probability"</span>))</span><br><span class="line">    ylabel(<span class="string">"Estimation of prob"</span>)</span><br><span class="line">    xlabel(<span class="string">"μ1=μ2"</span>)</span><br><span class="line"></span><br><span class="line">    legend(bbox_to_anchor=(<span class="number">1.05</span>, <span class="number">1</span>), loc=<span class="number">2</span>, borderaxespad=<span class="number">0.</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<pre><code>error_plotter (generic function with 1 method)
</code></pre><figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error_plotter(<span class="number">10</span>^<span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment1/output_36_0.svg"></p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PyObject &lt;matplotlib.legend.Legend object at <span class="number">0x123259fd0</span>&gt;</span><br></pre></td></tr></table></figure>
<p>As shown in the plot, $\mu1=\mu2=3.9$ is the best choice, though it is not always perfect.</p>
<p>For fixed parameters, we can do parallel calculation by setting a new function:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> fixed_MC_prob(N::<span class="built_in">Int</span>)</span><br><span class="line">    MC_prob(<span class="number">3.9</span>, <span class="number">3.9</span>, N)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<pre><code>fixed_MC_prob (generic function with 1 method)
</code></pre><figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fixed_MC_prob(<span class="number">10</span>^<span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2.3208602460224826e-10</span></span><br></pre></td></tr></table></figure>
<p>Recall the <code>parallel_calc</code> function before, it will be much more convenient to get the result in large number simulations by running:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parallel_calc(fixed_MC_prob, <span class="number">10</span>^<span class="number">9</span>)</span><br></pre></td></tr></table></figure>
<p>Also, we can obtain the elapsed time in the similar way with <code>mean_time_plotter</code>. (and not explained here)</p>
<h2 id="Homework-2"><a href="#Homework-2" class="headerlink" title="Homework 2"></a>Homework 2</h2><h3 id="Problem-3"><a href="#Problem-3" class="headerlink" title="Problem 3"></a>Problem 3</h3><blockquote>
<p>Redo Problem 2 by Cross Entropy method. Find the best distribution $q(x)$ to get the persuasive result.</p>
</blockquote>
<p><strong>CE Method for rare probability estimation</strong></p>
<p>Consider a rare probability</p>
<p>$$<br>P(x\in\Omega) \ll 1 \quad\Omega={x\mid g(x)&gt;r }<br>$$</p>
<p>While applying CE method to solve the optimization problem</p>
<p>$$<br>\max<em>{q’\in Q}\frac1n \sum</em>{i=1}^nf(x_i)\ln q’(x_i)u<br>$$</p>
<p>we can easily find that $x_i\sim q\approx p$</p>
<p>Thus, $I(x_i)=0$ almost for all $x_i$. Obviously, it does nothing to our work.</p>
<p>Pratically, we usually use the variant of CE method i.e.</p>
<p><strong>Multilevel / Multistage CE Method</strong></p>
<p>Denote</p>
<p>$$<br>I_r(x)=\begin{cases}<br>1 &amp; g(x)&gt;r\<br>0 &amp; g(x)&lt;r<br>\end{cases}<br>$$</p>
<p>First we do sampling work, then choose $r$ according to the samples. Thus, we can fetch the specific number of $g(x)$ satisfying $g(x)&lt; r$</p>
<p>$$<br>g(x_1)\leq g(x_2)\cdots\leq g(x_n)<br>$$</p>
<p>Set $0&lt; \rho\leq 1$ to be the confidence coefficient, define that the $(1-\rho)$-th quantile of a r.v. $y$ is the $r$ satisfying that</p>
<p>$$<br>P[y\geq r] \geq \rho, \quad P[y\leq r]\leq 1-\rho<br>$$</p>
<p>Hence, we can derive an estimation of $r$</p>
<p>$$<br>r=y[(1-\rho)N]<br>$$</p>
<p>if ${y_i}$ is ordered assendingly $y_i=g(x_i)$</p>
<p>The basic algorithm goes like below:</p>
<p><strong>Algorithom</strong></p>
<ol>
<li>let $q=p$</li>
<li>draw samples from $q:{ x_1,\cdot,x_n }$</li>
<li>compute $\hat{r} = (1-\rho)$-th quantile of ${g(x<em>i)}</em>{i=1}^n$ if $\hat{r}&gt;r$, let $\hat{r}=r$</li>
<li>solve $\max<em>{q’\in Q}\frac1n \sum</em>{i=1}^nI_{\hat{r}}(x_i)\ln q’(x_i)w(x_i)$; let $q=q’$</li>
<li>if $\hat{r}&lt;r$, return to step 2, otherwise proceed to step 6</li>
<li>estimate $\hat{P}=\frac1n \sum<em>{i=1}^n I</em>{r}(x_i)w(x_i)$ with $x_i\sim q(x)$</li>
</ol>
<p>As for Problem 2, the corresponding functions and parameters should be:</p>
<p>$$<br>p\sim N(0,I_2) \quad g(x)=-(x-5)^2-(y-5)^2 \quad r=-1<br>$$</p>
<p>For fixed variance $\Sigma=I_2$, we can directly give the optimal mean value in step 4 as taught in lecture 2:<br>$$<br>\mu=\frac{E_q[xIw]}{E_q[Iw]}<br>$$</p>
<p>Hence, it is sufficient enough to give an implement:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@everywhere</span> <span class="keyword">function</span> CE_prob(ρ::<span class="built_in">Float64</span>, N::<span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># step 1. set initial values</span></span><br><span class="line">μ<span class="number">1</span> = <span class="number">0</span></span><br><span class="line">μ<span class="number">2</span> = <span class="number">0</span></span><br><span class="line">iter = <span class="number">5000</span></span><br><span class="line">r = -<span class="number">1</span></span><br><span class="line">rhat = -<span class="number">10</span></span><br><span class="line">p = zeros(N,<span class="number">1</span>)</span><br><span class="line">q = zeros(N,<span class="number">1</span>)</span><br><span class="line">w = zeros(N,<span class="number">1</span>)</span><br><span class="line"><span class="literal">I</span> = zeros(N,<span class="number">1</span>)</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># step 5. set loops for calculation</span></span><br><span class="line">    <span class="keyword">while</span> rhat &lt; r &amp;&amp; k &lt; iter</span><br><span class="line"><span class="comment"># step 2. draw random samples on two diff coordinates</span></span><br><span class="line">        x = rand(Normal(μ<span class="number">1</span>, <span class="number">1</span>), N)</span><br><span class="line">        y = rand(Normal(μ<span class="number">2</span>, <span class="number">1</span>), N)</span><br><span class="line"><span class="comment"># step 3.</span></span><br><span class="line">        <span class="comment">## sort the corresponding function value</span></span><br><span class="line">        g = -(x-<span class="number">5</span>).^<span class="number">2</span>-(y-<span class="number">5</span>).^<span class="number">2</span></span><br><span class="line">        orderg = sort(g)</span><br><span class="line">        <span class="comment">## comupte the quantile</span></span><br><span class="line">        ix = floor(<span class="built_in">Int</span>,(<span class="number">1</span>-ρ)*N)</span><br><span class="line">        rhat = orderg[ix]</span><br><span class="line">        <span class="comment">## set constraint to narrow the search area</span></span><br><span class="line">        <span class="keyword">if</span> rhat &gt; r</span><br><span class="line">            rhat = r</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"><span class="comment"># step 4.</span></span><br><span class="line">        <span class="comment">## derive the optimization problem</span></span><br><span class="line">        p = <span class="number">1</span>/(<span class="number">2</span>*<span class="literal">π</span>) * exp.(-<span class="number">1</span>/<span class="number">2</span> * (x.^<span class="number">2</span> + y.^<span class="number">2</span>))</span><br><span class="line">        q = <span class="number">1</span>/(<span class="number">2</span>*<span class="literal">π</span>) * exp.(-<span class="number">1</span>/<span class="number">2</span> * ((x-<span class="number">5</span>).^<span class="number">2</span> + (y-<span class="number">5</span>).^<span class="number">2</span>))</span><br><span class="line">        w = p./q</span><br><span class="line">        <span class="comment">## construct the indicator function, which implies the search region</span></span><br><span class="line">        <span class="keyword">for</span> i=<span class="number">1</span>:<span class="number">1</span>:N</span><br><span class="line">            <span class="keyword">if</span> g[i] &gt; rhat</span><br><span class="line">                <span class="literal">I</span>[i] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="literal">I</span>[i] = <span class="number">0</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">## update the sampling distribution</span></span><br><span class="line">        μ<span class="number">1</span> = mean(x .* <span class="literal">I</span> .* w)/mean(<span class="literal">I</span> .* w)</span><br><span class="line">        μ<span class="number">2</span> = mean(y .* <span class="literal">I</span> .* w)/mean(<span class="literal">I</span> .* w)</span><br><span class="line"></span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="comment"># step 6. apply Monte Carlo to calculate the prob</span></span><br><span class="line">    mean(<span class="literal">I</span>.*w) <span class="comment"># append μ1, μ2 to get the optimal value</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Let’s make single simulation by setting $\rho = 0.2$ and $N=10^6$, the probability is shown below.</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CE_prob(<span class="number">0.2</span>,<span class="number">10</span>^<span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2.9121974873535745e-10</span></span><br></pre></td></tr></table></figure>
<p>The result is fair enough, but may raise the question in parameter choice of $\rho$. Now, let’s consider the quantile effect by program below:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> PyPlot</span><br><span class="line">PyPlot.svg(<span class="literal">true</span>)</span><br><span class="line"><span class="keyword">function</span> quantile_effect(N::<span class="built_in">Int</span>)</span><br><span class="line">    plot(collect(<span class="number">0.1</span>:<span class="number">0.05</span>:<span class="number">0.9</span>), [CE_prob(i,N) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0.1</span>:<span class="number">0.05</span>:<span class="number">0.9</span>],</span><br><span class="line">    linestyle=<span class="string">"--"</span>, marker=<span class="string">"."</span>, color=<span class="string">"blue"</span>, label=<span class="string">"Single Processor"</span>)</span><br><span class="line"></span><br><span class="line">    axhline(y=<span class="number">2.23465e-10</span>, linestyle=<span class="string">"-"</span>, color=<span class="string">"red"</span>,</span><br><span class="line">            label=string(<span class="string">"Exact Value: "</span>, <span class="number">2.23465e-10</span>))</span><br><span class="line"></span><br><span class="line">    title(string(<span class="string">"Monte Carlo Estimation of probability"</span>))</span><br><span class="line">    ylabel(<span class="string">"Estimation of prob"</span>)</span><br><span class="line">    xlabel(<span class="string">"parameter: ρ"</span>)</span><br><span class="line"></span><br><span class="line">    legend(bbox_to_anchor=(<span class="number">1.05</span>, <span class="number">1</span>), loc=<span class="number">2</span>, borderaxespad=<span class="number">0.</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<pre><code>quantile_effect (generic function with 1 method)
</code></pre><figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">quantile_effect(<span class="number">10</span>^<span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://oye4atjxc.bkt.clouddn.com/advancedComputation/assignment1/output_50_0.svg"></p>
<pre><code>PyObject &lt;matplotlib.legend.Legend object at 0x136c6e050&gt;
</code></pre><p>As shown in the picture, it is resonable for us to choose $\rho$ in $[0,0.5]$. For clarity, here we set $\rho=0.2$</p>
<p>Rewrite the code in <code>CE_prob</code> by appending $\mu1, \mu2$ to the return command, we will obtain the corresponding distribution and probability:</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Distributions</span><br><span class="line"><span class="meta">@everywhere</span> <span class="keyword">function</span> CE(N::<span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># step 1. set initial values</span></span><br><span class="line">μ<span class="number">1</span> = <span class="number">0</span></span><br><span class="line">μ<span class="number">2</span> = <span class="number">0</span></span><br><span class="line">iter = <span class="number">5000</span></span><br><span class="line">ρ = <span class="number">0.2</span></span><br><span class="line">r = -<span class="number">1</span></span><br><span class="line">rhat = -<span class="number">10</span></span><br><span class="line">p = zeros(N,<span class="number">1</span>)</span><br><span class="line">q = zeros(N,<span class="number">1</span>)</span><br><span class="line">w = zeros(N,<span class="number">1</span>)</span><br><span class="line"><span class="literal">I</span> = zeros(N,<span class="number">1</span>)</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># step 5. set loops for calculation</span></span><br><span class="line">    <span class="keyword">while</span> rhat &lt; r &amp;&amp; k &lt; iter</span><br><span class="line"><span class="comment"># step 2. draw random samples on two diff coordinates</span></span><br><span class="line">        x = rand(Normal(μ<span class="number">1</span>, <span class="number">1</span>), N)</span><br><span class="line">        y = rand(Normal(μ<span class="number">2</span>, <span class="number">1</span>), N)</span><br><span class="line"><span class="comment"># step 3.</span></span><br><span class="line">        <span class="comment">## sort the corresponding function value</span></span><br><span class="line">        g = -(x-<span class="number">5</span>).^<span class="number">2</span>-(y-<span class="number">5</span>).^<span class="number">2</span></span><br><span class="line">        orderg = sort(g)</span><br><span class="line">        <span class="comment">## comupte the quantile</span></span><br><span class="line">        ix = floor(<span class="built_in">Int</span>,(<span class="number">1</span>-ρ)*N)</span><br><span class="line">        rhat = orderg[ix]</span><br><span class="line">        <span class="comment">## set constraint to narrow the search area</span></span><br><span class="line">        <span class="keyword">if</span> rhat &gt; r</span><br><span class="line">            rhat = r</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"><span class="comment"># step 4.</span></span><br><span class="line">        <span class="comment">## derive the optimization problem</span></span><br><span class="line">        p = <span class="number">1</span>/(<span class="number">2</span>*<span class="literal">π</span>) * exp.(-<span class="number">1</span>/<span class="number">2</span> * (x.^<span class="number">2</span> + y.^<span class="number">2</span>))</span><br><span class="line">        q = <span class="number">1</span>/(<span class="number">2</span>*<span class="literal">π</span>) * exp.(-<span class="number">1</span>/<span class="number">2</span> * ((x-<span class="number">5</span>).^<span class="number">2</span> + (y-<span class="number">5</span>).^<span class="number">2</span>))</span><br><span class="line">        w = p./q</span><br><span class="line">        <span class="comment">## construct the indicator function, which implies the search region</span></span><br><span class="line">        <span class="keyword">for</span> i=<span class="number">1</span>:<span class="number">1</span>:N</span><br><span class="line">            <span class="keyword">if</span> g[i] &gt; rhat</span><br><span class="line">                <span class="literal">I</span>[i] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="literal">I</span>[i] = <span class="number">0</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">## update the sampling distribution</span></span><br><span class="line">        μ<span class="number">1</span> = mean(x .* <span class="literal">I</span> .* w)/mean(<span class="literal">I</span> .* w)</span><br><span class="line">        μ<span class="number">2</span> = mean(y .* <span class="literal">I</span> .* w)/mean(<span class="literal">I</span> .* w)</span><br><span class="line"></span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="comment"># step 6. apply Monte Carlo to calculate the prob</span></span><br><span class="line">    μ<span class="number">1</span>, μ<span class="number">2</span>, mean(<span class="literal">I</span>.*w)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CE(<span class="number">10</span>^<span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<pre><code>(4.426701996662324, 4.423183271573601, 2.8762783318578916e-10)
</code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol>
<li>Blogs of Monte Carlo work in Github: <a href="http://onlookerliu.leanote.com/post/5c355c764900" target="_blank" rel="noopener">http://onlookerliu.leanote.com/post/5c355c764900</a></li>
<li>Gonçalo, Abecasis. “Monte Carlo Integration”, Biostatistics 615/815, Lecture 22: <a href="http://csg.sph.umich.edu/abecasis/class/2006/615.22.pdf" target="_blank" rel="noopener">http://csg.sph.umich.edu/abecasis/class/2006/615.22.pdf</a></li>
<li>Ho, Shirley. “Introduction to Monte Carlo”, Astro 542 at Princeton University: <a href="http://www.phys.ubbcluj.ro/~zneda/edu/mc/mcshort.pdf" target="_blank" rel="noopener">http://www.phys.ubbcluj.ro/~zneda/edu/mc/mcshort.pdf</a></li>
<li>Julia language guide: <a href="http://julia-cn.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">http://julia-cn.readthedocs.io/zh_CN/latest/</a></li>
</ol>
<hr>
<p><em>Kai Liu, wrote on 2017/10/28</em></p>
<p><em>Student ID: 116071910015</em></p>
<p><em>Mail: liu1995@sjtu.edu.cn</em></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">statistics</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">julia</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">computationa method</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="../../2017/10/30/Assignment-1-of-Advanced-Computational-Method/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="../2/">&laquo; Prev</a><a class="page-number" href="../../index.html">1</a><a class="page-number" href="../2/">2</a><span class="page-number current">3</span>
    </nav>
  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2018 Kai Liu
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>

本站总访问量 <span id="busuanzi_value_site_pv"></span> 次, 访客数 <span id="busuanzi_value_site_uv"></span> 人次, 本文总阅读量 <span id="busuanzi_value_page_pv"></span> 次

</footer>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


    </div>
    <script>
	var yiliaConfig = {
		mathjax: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: true
	}
</script>

<script>!function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var r={};n.m=t,n.c=r,n.p="./",n(0)}([function(t,n,r){r(195),t.exports=r(191)},function(t,n,r){var e=r(3),i=r(52),o=r(27),u=r(28),c=r(53),f="prototype",a=function(t,n,r){var s,l,h,v,p=t&a.F,d=t&a.G,y=t&a.S,g=t&a.P,b=t&a.B,m=d?e:y?e[n]||(e[n]={}):(e[n]||{})[f],x=d?i:i[n]||(i[n]={}),w=x[f]||(x[f]={});d&&(r=n);for(s in r)l=!p&&m&&void 0!==m[s],h=(l?m:r)[s],v=b&&l?c(h,e):g&&"function"==typeof h?c(Function.call,h):h,m&&u(m,s,h,t&a.U),x[s]!=h&&o(x,s,v),g&&w[s]!=h&&(w[s]=h)};e.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,n,r){var e=r(6);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,r){var e=r(126)("wks"),i=r(76),o=r(3).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n,r){var e=r(94),i=r(33);t.exports=function(t){return e(i(t))}},function(t,n,r){t.exports=!r(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(2),i=r(167),o=r(50),u=Object.defineProperty;n.f=r(10)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(14),i=r(22);t.exports=r(12)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(20),i=r(58),o=r(42),u=Object.defineProperty;n.f=r(12)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(40)("wks"),i=r(23),o=r(5).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n,r){var e=r(67),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){var e=r(46);t.exports=function(t){return Object(e(t))}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(63),i=r(34);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(21);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,r){var e=r(11),i=r(66);t.exports=r(10)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(3),i=r(27),o=r(24),u=r(76)("src"),c="toString",f=Function[c],a=(""+f).split(c);r(52).inspectSource=function(t){return f.call(t)},(t.exports=function(t,n,r,c){var f="function"==typeof r;f&&(o(r,"name")||i(r,"name",n)),t[n]!==r&&(f&&(o(r,u)||i(r,u,t[n]?""+t[n]:a.join(String(n)))),t===e?t[n]=r:c?t[n]?t[n]=r:i(t,n,r):(delete t[n],i(t,n,r)))})(Function.prototype,c,function(){return"function"==typeof this&&this[u]||f.call(this)})},function(t,n,r){var e=r(1),i=r(4),o=r(46),u=function(t,n,r,e){var i=String(o(t)),u="<"+n;return""!==r&&(u+=" "+r+'="'+String(e).replace(/"/g,"&quot;")+'"'),u+">"+i+"</"+n+">"};t.exports=function(t,n){var r={};r[t]=n(u),e(e.P+e.F*i(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",r)}},function(t,n,r){var e=r(115),i=r(46);t.exports=function(t){return e(i(t))}},function(t,n,r){var e=r(116),i=r(66),o=r(30),u=r(50),c=r(24),f=r(167),a=Object.getOwnPropertyDescriptor;n.f=r(10)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(24),i=r(17),o=r(145)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(14).f,i=r(8),o=r(15)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(40)("keys"),i=r(23);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(5),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n,r){var e=r(21);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(36),u=r(44),c=r(14).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){n.f=r(15)},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,r){var e=r(4);t.exports=function(t,n){return!!t&&e(function(){n?t.call(null,function(){},1):t.call(null)})}},function(t,n,r){var e=r(53),i=r(115),o=r(17),u=r(16),c=r(203);t.exports=function(t,n){var r=1==t,f=2==t,a=3==t,s=4==t,l=6==t,h=5==t||l,v=n||c;return function(n,c,p){for(var d,y,g=o(n),b=i(g),m=e(c,p,3),x=u(b.length),w=0,S=r?v(n,x):f?v(n,0):void 0;x>w;w++)if((h||w in b)&&(d=b[w],y=m(d,w,g),t))if(r)S[w]=y;else if(y)switch(t){case 3:return!0;case 5:return d;case 6:return w;case 2:S.push(d)}else if(s)return!1;return l?-1:a||s?s:S}}},function(t,n,r){var e=r(1),i=r(52),o=r(4);t.exports=function(t,n){var r=(i.Object||{})[t]||Object[t],u={};u[t]=n(r),e(e.S+e.F*o(function(){r(1)}),"Object",u)}},function(t,n,r){var e=r(6);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(91),u=r(13),c="prototype",f=function(t,n,r){var a,s,l,h=t&f.F,v=t&f.G,p=t&f.S,d=t&f.P,y=t&f.B,g=t&f.W,b=v?i:i[n]||(i[n]={}),m=b[c],x=v?e:p?e[n]:(e[n]||{})[c];v&&(r=n);for(a in r)(s=!h&&x&&void 0!==x[a])&&a in b||(l=s?x[a]:r[a],b[a]=v&&"function"!=typeof x[a]?r[a]:y&&s?o(l,e):g&&x[a]==l?function(t){var n=function(n,r,e){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,e)}return t.apply(this,arguments)};return n[c]=t[c],n}(l):d&&"function"==typeof l?o(Function.call,l):l,d&&((b.virtual||(b.virtual={}))[a]=l,t&f.R&&m&&!m[a]&&u(m,a,l)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,t.exports=f},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n,r){var e=r(26);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(183),i=r(1),o=r(126)("metadata"),u=o.store||(o.store=new(r(186))),c=function(t,n,r){var i=u.get(t);if(!i){if(!r)return;u.set(t,i=new e)}var o=i.get(n);if(!o){if(!r)return;i.set(n,o=new e)}return o},f=function(t,n,r){var e=c(n,r,!1);return void 0!==e&&e.has(t)},a=function(t,n,r){var e=c(n,r,!1);return void 0===e?void 0:e.get(t)},s=function(t,n,r,e){c(r,e,!0).set(t,n)},l=function(t,n){var r=c(t,n,!1),e=[];return r&&r.forEach(function(t,n){e.push(n)}),e},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},v=function(t){i(i.S,"Reflect",t)};t.exports={store:u,map:c,has:f,get:a,set:s,keys:l,key:h,exp:v}},function(t,n,r){"use strict";if(r(10)){var e=r(69),i=r(3),o=r(4),u=r(1),c=r(127),f=r(152),a=r(53),s=r(68),l=r(66),h=r(27),v=r(73),p=r(67),d=r(16),y=r(75),g=r(50),b=r(24),m=r(180),x=r(114),w=r(6),S=r(17),_=r(137),O=r(70),E=r(32),P=r(71).f,j=r(154),F=r(76),M=r(7),A=r(48),N=r(117),T=r(146),I=r(155),k=r(80),L=r(123),R=r(74),C=r(130),D=r(160),U=r(11),W=r(31),G=U.f,B=W.f,V=i.RangeError,z=i.TypeError,q=i.Uint8Array,K="ArrayBuffer",J="Shared"+K,Y="BYTES_PER_ELEMENT",H="prototype",$=Array[H],X=f.ArrayBuffer,Q=f.DataView,Z=A(0),tt=A(2),nt=A(3),rt=A(4),et=A(5),it=A(6),ot=N(!0),ut=N(!1),ct=I.values,ft=I.keys,at=I.entries,st=$.lastIndexOf,lt=$.reduce,ht=$.reduceRight,vt=$.join,pt=$.sort,dt=$.slice,yt=$.toString,gt=$.toLocaleString,bt=M("iterator"),mt=M("toStringTag"),xt=F("typed_constructor"),wt=F("def_constructor"),St=c.CONSTR,_t=c.TYPED,Ot=c.VIEW,Et="Wrong length!",Pt=A(1,function(t,n){return Tt(T(t,t[wt]),n)}),jt=o(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ft=!!q&&!!q[H].set&&o(function(){new q(1).set({})}),Mt=function(t,n){if(void 0===t)throw z(Et);var r=+t,e=d(t);if(n&&!m(r,e))throw V(Et);return e},At=function(t,n){var r=p(t);if(r<0||r%n)throw V("Wrong offset!");return r},Nt=function(t){if(w(t)&&_t in t)return t;throw z(t+" is not a typed array!")},Tt=function(t,n){if(!(w(t)&&xt in t))throw z("It is not a typed array constructor!");return new t(n)},It=function(t,n){return kt(T(t,t[wt]),n)},kt=function(t,n){for(var r=0,e=n.length,i=Tt(t,e);e>r;)i[r]=n[r++];return i},Lt=function(t,n,r){G(t,n,{get:function(){return this._d[r]}})},Rt=function(t){var n,r,e,i,o,u,c=S(t),f=arguments.length,s=f>1?arguments[1]:void 0,l=void 0!==s,h=j(c);if(void 0!=h&&!_(h)){for(u=h.call(c),e=[],n=0;!(o=u.next()).done;n++)e.push(o.value);c=e}for(l&&f>2&&(s=a(s,arguments[2],2)),n=0,r=d(c.length),i=Tt(this,r);r>n;n++)i[n]=l?s(c[n],n):c[n];return i},Ct=function(){for(var t=0,n=arguments.length,r=Tt(this,n);n>t;)r[t]=arguments[t++];return r},Dt=!!q&&o(function(){gt.call(new q(1))}),Ut=function(){return gt.apply(Dt?dt.call(Nt(this)):Nt(this),arguments)},Wt={copyWithin:function(t,n){return D.call(Nt(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function(t){return rt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return C.apply(Nt(this),arguments)},filter:function(t){return It(this,tt(Nt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return et(Nt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Nt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Z(Nt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ut(Nt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Nt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return vt.apply(Nt(this),arguments)},lastIndexOf:function(t){return st.apply(Nt(this),arguments)},map:function(t){return Pt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return lt.apply(Nt(this),arguments)},reduceRight:function(t){return ht.apply(Nt(this),arguments)},reverse:function(){for(var t,n=this,r=Nt(n).length,e=Math.floor(r/2),i=0;i<e;)t=n[i],n[i++]=n[--r],n[r]=t;return n},some:function(t){return nt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Nt(this),t)},subarray:function(t,n){var r=Nt(this),e=r.length,i=y(t,e);return new(T(r,r[wt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,d((void 0===n?e:y(n,e))-i))}},Gt=function(t,n){return It(this,dt.call(Nt(this),t,n))},Bt=function(t){Nt(this);var n=At(arguments[1],1),r=this.length,e=S(t),i=d(e.length),o=0;if(i+n>r)throw V(Et);for(;o<i;)this[n+o]=e[o++]},Vt={entries:function(){return at.call(Nt(this))},keys:function(){return ft.call(Nt(this))},values:function(){return ct.call(Nt(this))}},zt=function(t,n){return w(t)&&t[_t]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},qt=function(t,n){return zt(t,n=g(n,!0))?l(2,t[n]):B(t,n)},Kt=function(t,n,r){return!(zt(t,n=g(n,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?G(t,n,r):(t[n]=r.value,t)};St||(W.f=qt,U.f=Kt),u(u.S+u.F*!St,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Kt}),o(function(){yt.call({})})&&(yt=gt=function(){return vt.call(this)});var Jt=v({},Wt);v(Jt,Vt),h(Jt,bt,Vt.values),v(Jt,{slice:Gt,set:Bt,constructor:function(){},toString:yt,toLocaleString:Ut}),Lt(Jt,"buffer","b"),Lt(Jt,"byteOffset","o"),Lt(Jt,"byteLength","l"),Lt(Jt,"length","e"),G(Jt,mt,{get:function(){return this[_t]}}),t.exports=function(t,n,r,f){f=!!f;var a=t+(f?"Clamped":"")+"Array",l="Uint8Array"!=a,v="get"+t,p="set"+t,y=i[a],g=y||{},b=y&&E(y),m=!y||!c.ABV,S={},_=y&&y[H],j=function(t,r){var e=t._d;return e.v[v](r*n+e.o,jt)},F=function(t,r,e){var i=t._d;f&&(e=(e=Math.round(e))<0?0:e>255?255:255&e),i.v[p](r*n+i.o,e,jt)},M=function(t,n){G(t,n,{get:function(){return j(this,n)},set:function(t){return F(this,n,t)},enumerable:!0})};m?(y=r(function(t,r,e,i){s(t,y,a,"_d");var o,u,c,f,l=0,v=0;if(w(r)){if(!(r instanceof X||(f=x(r))==K||f==J))return _t in r?kt(y,r):Rt.call(y,r);o=r,v=At(e,n);var p=r.byteLength;if(void 0===i){if(p%n)throw V(Et);if((u=p-v)<0)throw V(Et)}else if((u=d(i)*n)+v>p)throw V(Et);c=u/n}else c=Mt(r,!0),u=c*n,o=new X(u);for(h(t,"_d",{b:o,o:v,l:u,e:c,v:new Q(o)});l<c;)M(t,l++)}),_=y[H]=O(Jt),h(_,"constructor",y)):L(function(t){new y(null),new y(t)},!0)||(y=r(function(t,r,e,i){s(t,y,a);var o;return w(r)?r instanceof X||(o=x(r))==K||o==J?void 0!==i?new g(r,At(e,n),i):void 0!==e?new g(r,At(e,n)):new g(r):_t in r?kt(y,r):Rt.call(y,r):new g(Mt(r,l))}),Z(b!==Function.prototype?P(g).concat(P(b)):P(g),function(t){t in y||h(y,t,g[t])}),y[H]=_,e||(_.constructor=y));var A=_[bt],N=!!A&&("values"==A.name||void 0==A.name),T=Vt.values;h(y,xt,!0),h(_,_t,a),h(_,Ot,!0),h(_,wt,y),(f?new y(1)[mt]==a:mt in _)||G(_,mt,{get:function(){return a}}),S[a]=y,u(u.G+u.W+u.F*(y!=g),S),u(u.S,a,{BYTES_PER_ELEMENT:n,from:Rt,of:Ct}),Y in _||h(_,Y,n),u(u.P,a,Wt),R(a),u(u.P+u.F*Ft,a,{set:Bt}),u(u.P+u.F*!N,a,Vt),u(u.P+u.F*(_.toString!=yt),a,{toString:yt}),u(u.P+u.F*o(function(){new y(1).slice()}),a,{slice:Gt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new y([1,2]).toLocaleString()})||!o(function(){_.toLocaleString.call([1,2])})),a,{toLocaleString:Ut}),k[a]=N?A:T,e||N||h(_,bt,T)}}else t.exports=function(){}},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n,r){var e=r(21),i=r(5).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,r){t.exports=!r(12)&&!r(18)(function(){return 7!=Object.defineProperty(r(57)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){"use strict";var e=r(36),i=r(51),o=r(64),u=r(13),c=r(8),f=r(35),a=r(96),s=r(38),l=r(103),h=r(15)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n,r){var e=r(20),i=r(100),o=r(34),u=r(39)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(57)("iframe"),e=o.length;for(n.style.display="none",r(93).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(63),i=r(34).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(8),i=r(9),o=r(90)(!1),u=r(39)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){t.exports=r(13)},function(t,n,r){var e=r(76)("meta"),i=r(6),o=r(24),u=r(11).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(4)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n){t.exports=function(t,n,r,e){if(!(t instanceof n)||void 0!==e&&e in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,n){t.exports=!1},function(t,n,r){var e=r(2),i=r(173),o=r(133),u=r(145)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(132)("iframe"),e=o.length;for(n.style.display="none",r(135).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(175),i=r(133).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n,r){var e=r(175),i=r(133);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(28);t.exports=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t}},function(t,n,r){"use strict";var e=r(3),i=r(11),o=r(10),u=r(7)("species");t.exports=function(t){var n=e[t];o&&n&&!n[u]&&i.f(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(67),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n,r){var e=r(33);t.exports=function(t){return Object(e(t))}},function(t,n,r){var e=r(7)("unscopables"),i=Array.prototype;void 0==i[e]&&r(27)(i,e,{}),t.exports=function(t){i[e][t]=!0}},function(t,n,r){var e=r(53),i=r(169),o=r(137),u=r(2),c=r(16),f=r(154),a={},s={},n=t.exports=function(t,n,r,l,h){var v,p,d,y,g=h?function(){return t}:f(t),b=e(r,l,n?2:1),m=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(v=c(t.length);v>m;m++)if((y=n?b(u(p=t[m])[0],p[1]):b(t[m]))===a||y===s)return y}else for(d=g.call(t);!(p=d.next()).done;)if((y=i(d,b,p.value,n))===a||y===s)return y};n.BREAK=a,n.RETURN=s},function(t,n){t.exports={}},function(t,n,r){var e=r(11).f,i=r(24),o=r(7)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(1),i=r(46),o=r(4),u=r(150),c="["+u+"]",f="​",a=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),l=function(t,n,r){var i={},c=o(function(){return!!u[t]()||f[t]()!=f}),a=i[t]=c?n(h):u[t];r&&(i[r]=a),e(e.P+e.F*c,"String",i)},h=l.trim=function(t,n){return t=String(i(t)),1&n&&(t=t.replace(a,"")),2&n&&(t=t.replace(s,"")),t};t.exports=l},function(t,n,r){t.exports={default:r(86),__esModule:!0}},function(t,n,r){t.exports={default:r(87),__esModule:!0}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=r(84),o=e(i),u=r(83),c=e(u),f="function"==typeof c.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":typeof t};n.default="function"==typeof c.default&&"symbol"===f(o.default)?function(t){return void 0===t?"undefined":f(t)}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":void 0===t?"undefined":f(t)}},function(t,n,r){r(110),r(108),r(111),r(112),t.exports=r(25).Symbol},function(t,n,r){r(109),r(113),t.exports=r(44).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(9),i=r(106),o=r(105);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){var e=r(88);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(19),i=r(62),o=r(37);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){t.exports=r(5).document&&document.documentElement},function(t,n,r){var e=r(56);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n,r){var e=r(56);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(60),i=r(22),o=r(38),u={};r(13)(u,r(15)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,r){var e=r(19),i=r(9);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){var e=r(23)("meta"),i=r(21),o=r(8),u=r(14).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(18)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n,r){var e=r(14),i=r(20),o=r(19);t.exports=r(12)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(37),i=r(22),o=r(9),u=r(42),c=r(8),f=r(58),a=Object.getOwnPropertyDescriptor;n.f=r(12)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(9),i=r(61).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(8),i=r(77),o=r(39)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,r){var e=r(41),i=r(33);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(41),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n,r){var e=r(41),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){"use strict";var e=r(89),i=r(97),o=r(35),u=r(9);t.exports=r(59)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){},function(t,n,r){"use strict";var e=r(104)(!0);r(59)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";var e=r(5),i=r(8),o=r(12),u=r(51),c=r(64),f=r(99).KEY,a=r(18),s=r(40),l=r(38),h=r(23),v=r(15),p=r(44),d=r(43),y=r(98),g=r(92),b=r(95),m=r(20),x=r(9),w=r(42),S=r(22),_=r(60),O=r(102),E=r(101),P=r(14),j=r(19),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(61).f=O.f=Z,r(37).f=X,r(62).f=tt,o&&!r(36)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(13)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){r(43)("asyncIterator")},function(t,n,r){r(43)("observable")},function(t,n,r){r(107);for(var e=r(5),i=r(13),o=r(35),u=r(15)("toStringTag"),c=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],f=0;f<5;f++){var a=c[f],s=e[a],l=s&&s.prototype;l&&!l[u]&&i(l,u,a),o[a]=o.Array}},function(t,n,r){var e=r(45),i=r(7)("toStringTag"),o="Arguments"==e(function(){return arguments}()),u=function(t,n){try{return t[n]}catch(t){}};t.exports=function(t){var n,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(n=Object(t),i))?r:o?e(n):"Object"==(c=e(n))&&"function"==typeof n.callee?"Arguments":c}},function(t,n,r){var e=r(45);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(30),i=r(16),o=r(75);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){"use strict";var e=r(3),i=r(1),o=r(28),u=r(73),c=r(65),f=r(79),a=r(68),s=r(6),l=r(4),h=r(123),v=r(81),p=r(136);t.exports=function(t,n,r,d,y,g){var b=e[t],m=b,x=y?"set":"add",w=m&&m.prototype,S={},_=function(t){var n=w[t];o(w,t,"delete"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!s(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,r){return n.call(this,0===t?0:t,r),this})};if("function"==typeof m&&(g||w.forEach&&!l(function(){(new m).entries().next()}))){var O=new m,E=O[x](g?{}:-0,1)!=O,P=l(function(){O.has(1)}),j=h(function(t){new m(t)}),F=!g&&l(function(){for(var t=new m,n=5;n--;)t[x](n,n);return!t.has(-0)});j||(m=n(function(n,r){a(n,m,t);var e=p(new b,n,m);return void 0!=r&&f(r,y,e[x],e),e}),m.prototype=w,w.constructor=m),(P||F)&&(_("delete"),_("has"),y&&_("get")),(F||E)&&_(x),g&&w.clear&&delete w.clear}else m=d.getConstructor(n,t,y,x),u(m.prototype,r),c.NEED=!0;return v(m,t),S[t]=m,i(i.G+i.W+i.F*(m!=b),S),g||d.setStrong(m,t,y),m}},function(t,n,r){"use strict";var e=r(27),i=r(28),o=r(4),u=r(46),c=r(7);t.exports=function(t,n,r){var f=c(t),a=r(u,f,""[t]),s=a[0],l=a[1];o(function(){var n={};return n[f]=function(){return 7},7!=""[t](n)})&&(i(String.prototype,t,s),e(RegExp.prototype,f,2==n?function(t,n){return l.call(t,this,n)}:function(t){return l.call(t,this)}))}
},function(t,n,r){"use strict";var e=r(2);t.exports=function(){var t=e(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(t,n){t.exports=function(t,n,r){var e=void 0===r;switch(n.length){case 0:return e?t():t.call(r);case 1:return e?t(n[0]):t.call(r,n[0]);case 2:return e?t(n[0],n[1]):t.call(r,n[0],n[1]);case 3:return e?t(n[0],n[1],n[2]):t.call(r,n[0],n[1],n[2]);case 4:return e?t(n[0],n[1],n[2],n[3]):t.call(r,n[0],n[1],n[2],n[3])}return t.apply(r,n)}},function(t,n,r){var e=r(6),i=r(45),o=r(7)("match");t.exports=function(t){var n;return e(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},function(t,n,r){var e=r(7)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,n){if(!n&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},t(o)}catch(t){}return r}},function(t,n,r){t.exports=r(69)||!r(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete r(3)[t]})},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(3),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n,r){for(var e,i=r(3),o=r(27),u=r(76),c=u("typed_array"),f=u("view"),a=!(!i.ArrayBuffer||!i.DataView),s=a,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(e=i[h[l++]])?(o(e.prototype,c,!0),o(e.prototype,f,!0)):s=!1;t.exports={ABV:a,CONSTR:s,TYPED:c,VIEW:f}},function(t,n){"use strict";var r={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari"),weixin:-1==t.indexOf("MicroMessenger")}}()};t.exports=r},function(t,n,r){"use strict";var e=r(85),i=function(t){return t&&t.__esModule?t:{default:t}}(e),o=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):r[t]||t}function n(t){return e[t]}var r={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},e={};for(var u in r)e[r[u]]=u;return r["&apos;"]="'",e["'"]="&#39;",{encode:function(t){return t?(""+t).replace(/['<> "&]/g,n).replace(/\r?\n/g,"<br/>").replace(/\s/g,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(/<br\s*\/?>/gi,"\n").replace(/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,t).replace(/\u00a0/g," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r+=2)n.push(String.fromCharCode("0x"+t.slice(r,r+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,r=t.length;r>n;n++)t[n]=o.encodeObject(t[n]);else if("object"==(void 0===t?"undefined":(0,i.default)(t)))for(var e in t)t[e]=o.encodeObject(t[e]);else if("string"==typeof t)return o.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=o},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=function(t){for(var n=e(this),r=o(n.length),u=arguments.length,c=i(u>1?arguments[1]:void 0,r),f=u>2?arguments[2]:void 0,a=void 0===f?r:i(f,r);a>c;)n[c++]=t;return n}},function(t,n,r){"use strict";var e=r(11),i=r(66);t.exports=function(t,n,r){n in t?e.f(t,n,i(0,r)):t[n]=r}},function(t,n,r){var e=r(6),i=r(3).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,r){var e=r(7)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(r){try{return n[e]=!1,!"/./"[t](n)}catch(t){}}return!0}},function(t,n,r){t.exports=r(3).document&&document.documentElement},function(t,n,r){var e=r(6),i=r(144).set;t.exports=function(t,n,r){var o,u=n.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&e(o)&&i&&i(t,o),t}},function(t,n,r){var e=r(80),i=r(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(e.Array===t||o[i]===t)}},function(t,n,r){var e=r(45);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(70),i=r(66),o=r(81),u={};r(27)(u,r(7)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n,r){"use strict";var e=r(69),i=r(1),o=r(28),u=r(27),c=r(24),f=r(80),a=r(139),s=r(81),l=r(32),h=r(7)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,n){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,n,r){var e=r(3),i=r(151).set,o=e.MutationObserver||e.WebKitMutationObserver,u=e.process,c=e.Promise,f="process"==r(45)(u);t.exports=function(){var t,n,r,a=function(){var e,i;for(f&&(e=u.domain)&&e.exit();t;){i=t.fn,t=t.next;try{i()}catch(e){throw t?r():n=void 0,e}}n=void 0,e&&e.enter()};if(f)r=function(){u.nextTick(a)};else if(o){var s=!0,l=document.createTextNode("");new o(a).observe(l,{characterData:!0}),r=function(){l.data=s=!s}}else if(c&&c.resolve){var h=c.resolve();r=function(){h.then(a)}}else r=function(){i.call(e,a)};return function(e){var i={fn:e,next:void 0};n&&(n.next=i),t||(t=i,r()),n=i}}},function(t,n,r){var e=r(6),i=r(2),o=function(t,n){if(i(t),!e(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,e){try{e=r(53)(Function.call,r(31).f(Object.prototype,"__proto__").set,2),e(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,r){return o(t,r),n?t.__proto__=r:e(t,r),t}}({},!1):void 0),check:o}},function(t,n,r){var e=r(126)("keys"),i=r(76);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(2),i=r(26),o=r(7)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||void 0==(r=e(u)[o])?n:i(r)}},function(t,n,r){var e=r(67),i=r(46);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(122),i=r(46);t.exports=function(t,n,r){if(e(n))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,n,r){"use strict";var e=r(67),i=r(46);t.exports=function(t){var n=String(i(this)),r="",o=e(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(n+=n))1&o&&(r+=n);return r}},function(t,n){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,n,r){var e,i,o,u=r(53),c=r(121),f=r(135),a=r(132),s=r(3),l=s.process,h=s.setImmediate,v=s.clearImmediate,p=s.MessageChannel,d=0,y={},g="onreadystatechange",b=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},m=function(t){b.call(t.data)};h&&v||(h=function(t){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return y[++d]=function(){c("function"==typeof t?t:Function(t),n)},e(d),d},v=function(t){delete y[t]},"process"==r(45)(l)?e=function(t){l.nextTick(u(b,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=m,e=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(e=function(t){s.postMessage(t+"","*")},s.addEventListener("message",m,!1)):e=g in a("script")?function(t){f.appendChild(a("script"))[g]=function(){f.removeChild(this),b.call(t)}}:function(t){setTimeout(u(b,t,1),0)}),t.exports={set:h,clear:v}},function(t,n,r){"use strict";var e=r(3),i=r(10),o=r(69),u=r(127),c=r(27),f=r(73),a=r(4),s=r(68),l=r(67),h=r(16),v=r(71).f,p=r(11).f,d=r(130),y=r(81),g="ArrayBuffer",b="DataView",m="prototype",x="Wrong length!",w="Wrong index!",S=e[g],_=e[b],O=e.Math,E=e.RangeError,P=e.Infinity,j=S,F=O.abs,M=O.pow,A=O.floor,N=O.log,T=O.LN2,I="buffer",k="byteLength",L="byteOffset",R=i?"_b":I,C=i?"_l":k,D=i?"_o":L,U=function(t,n,r){var e,i,o,u=Array(r),c=8*r-n-1,f=(1<<c)-1,a=f>>1,s=23===n?M(2,-24)-M(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for(t=F(t),t!=t||t===P?(i=t!=t?1:0,e=f):(e=A(N(t)/T),t*(o=M(2,-e))<1&&(e--,o*=2),t+=e+a>=1?s/o:s*M(2,1-a),t*o>=2&&(e++,o/=2),e+a>=f?(i=0,e=f):e+a>=1?(i=(t*o-1)*M(2,n),e+=a):(i=t*M(2,a-1)*M(2,n),e=0));n>=8;u[l++]=255&i,i/=256,n-=8);for(e=e<<n|i,c+=n;c>0;u[l++]=255&e,e/=256,c-=8);return u[--l]|=128*h,u},W=function(t,n,r){var e,i=8*r-n-1,o=(1<<i)-1,u=o>>1,c=i-7,f=r-1,a=t[f--],s=127&a;for(a>>=7;c>0;s=256*s+t[f],f--,c-=8);for(e=s&(1<<-c)-1,s>>=-c,c+=n;c>0;e=256*e+t[f],f--,c-=8);if(0===s)s=1-u;else{if(s===o)return e?NaN:a?-P:P;e+=M(2,n),s-=u}return(a?-1:1)*e*M(2,s-n)},G=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},B=function(t){return[255&t]},V=function(t){return[255&t,t>>8&255]},z=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},q=function(t){return U(t,52,8)},K=function(t){return U(t,23,4)},J=function(t,n,r){p(t[m],n,{get:function(){return this[r]}})},Y=function(t,n,r,e){var i=+r,o=l(i);if(i!=o||o<0||o+n>t[C])throw E(w);var u=t[R]._b,c=o+t[D],f=u.slice(c,c+n);return e?f:f.reverse()},H=function(t,n,r,e,i,o){var u=+r,c=l(u);if(u!=c||c<0||c+n>t[C])throw E(w);for(var f=t[R]._b,a=c+t[D],s=e(+i),h=0;h<n;h++)f[a+h]=s[o?h:n-h-1]},$=function(t,n){s(t,S,g);var r=+n,e=h(r);if(r!=e)throw E(x);return e};if(u.ABV){if(!a(function(){new S})||!a(function(){new S(.5)})){S=function(t){return new j($(this,t))};for(var X,Q=S[m]=j[m],Z=v(j),tt=0;Z.length>tt;)(X=Z[tt++])in S||c(S,X,j[X]);o||(Q.constructor=S)}var nt=new _(new S(2)),rt=_[m].setInt8;nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||f(_[m],{setInt8:function(t,n){rt.call(this,t,n<<24>>24)},setUint8:function(t,n){rt.call(this,t,n<<24>>24)}},!0)}else S=function(t){var n=$(this,t);this._b=d.call(Array(n),0),this[C]=n},_=function(t,n,r){s(this,_,b),s(t,S,b);var e=t[C],i=l(n);if(i<0||i>e)throw E("Wrong offset!");if(r=void 0===r?e-i:h(r),i+r>e)throw E(x);this[R]=t,this[D]=i,this[C]=r},i&&(J(S,k,"_l"),J(_,I,"_b"),J(_,k,"_l"),J(_,L,"_o")),f(_[m],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var n=Y(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t){var n=Y(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function(t){return G(Y(this,4,t,arguments[1]))},getUint32:function(t){return G(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return W(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return W(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,n){H(this,1,t,B,n)},setUint8:function(t,n){H(this,1,t,B,n)},setInt16:function(t,n){H(this,2,t,V,n,arguments[2])},setUint16:function(t,n){H(this,2,t,V,n,arguments[2])},setInt32:function(t,n){H(this,4,t,z,n,arguments[2])},setUint32:function(t,n){H(this,4,t,z,n,arguments[2])},setFloat32:function(t,n){H(this,4,t,K,n,arguments[2])},setFloat64:function(t,n){H(this,8,t,q,n,arguments[2])}});y(S,g),y(_,b),c(_[m],u.VIEW,!0),n[g]=S,n[b]=_},function(t,n,r){var e=r(3),i=r(52),o=r(69),u=r(182),c=r(11).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){var e=r(114),i=r(7)("iterator"),o=r(80);t.exports=r(52).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},function(t,n,r){"use strict";var e=r(78),i=r(170),o=r(80),u=r(30);t.exports=r(140)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){function r(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=r},function(t,n){function r(t,n){if(t.classList)t.classList.remove(n);else{var r=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(r," ")}}t.exports=r},function(t,n){function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function i(t){if(s===setTimeout)return setTimeout(t,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&v&&(d=!1,v.length?p=v.concat(p):y=-1,p.length&&c())}function c(){if(!d){var t=i(u);d=!0;for(var n=p.length;n;){for(v=p,p=[];++y<n;)v&&v[y].run();y=-1,n=p.length}v=null,d=!1,o(t)}}function f(t,n){this.fun=t,this.array=n}function a(){}var s,l,h=t.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(t){s=r}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(t){l=e}}();var v,p=[],d=!1,y=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];p.push(new f(t,n)),1!==p.length||d||i(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n,r){var e=r(45);t.exports=function(t,n){if("number"!=typeof t&&"Number"!=e(t))throw TypeError(n);return+t}},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=[].copyWithin||function(t,n){var r=e(this),u=o(r.length),c=i(t,u),f=i(n,u),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?u:i(a,u))-f,u-c),l=1;for(f<c&&c<f+s&&(l=-1,f+=s-1,c+=s-1);s-- >0;)f in r?r[c]=r[f]:delete r[c],c+=l,f+=l;return r}},function(t,n,r){var e=r(79);t.exports=function(t,n){var r=[];return e(t,!1,r.push,r,n),r}},function(t,n,r){var e=r(26),i=r(17),o=r(115),u=r(16);t.exports=function(t,n,r,c,f){e(n);var a=i(t),s=o(a),l=u(a.length),h=f?l-1:0,v=f?-1:1;if(r<2)for(;;){if(h in s){c=s[h],h+=v;break}if(h+=v,f?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;f?h>=0:l>h;h+=v)h in s&&(c=n(c,s[h],h,a));return c}},function(t,n,r){"use strict";var e=r(26),i=r(6),o=r(121),u=[].slice,c={},f=function(t,n,r){if(!(n in c)){for(var e=[],i=0;i<n;i++)e[i]="a["+i+"]";c[n]=Function("F,a","return new F("+e.join(",")+")")}return c[n](t,r)};t.exports=Function.bind||function(t){var n=e(this),r=u.call(arguments,1),c=function(){var e=r.concat(u.call(arguments));return this instanceof c?f(n,e.length,e):o(n,e,t)};return i(n.prototype)&&(c.prototype=n.prototype),c}},function(t,n,r){"use strict";var e=r(11).f,i=r(70),o=r(73),u=r(53),c=r(68),f=r(46),a=r(79),s=r(140),l=r(170),h=r(74),v=r(10),p=r(65).fastKey,d=v?"_s":"size",y=function(t,n){var r,e=p(n);if("F"!==e)return t._i[e];for(r=t._f;r;r=r.n)if(r.k==n)return r};t.exports={getConstructor:function(t,n,r,s){var l=t(function(t,e){c(t,l,n,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=e&&a(e,r,t[s],t)});return o(l.prototype,{clear:function(){for(var t=this,n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var n=this,r=y(n,t);if(r){var e=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=e),e&&(e.p=i),n._f==r&&(n._f=e),n._l==r&&(n._l=i),n[d]--}return!!r},forEach:function(t){c(this,l,"forEach");for(var n,r=u(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(this,t)}}),v&&e(l.prototype,"size",{get:function(){return f(this[d])}}),l},def:function(t,n,r){var e,i,o=y(t,n);return o?o.v=r:(t._l=o={i:i=p(n,!0),k:n,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=o),e&&(e.n=o),t[d]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,n,r){s(t,n,function(t,n){this._t=t,this._k=n,this._l=void 0},function(){for(var t=this,n=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==n?l(0,r.k):"values"==n?l(0,r.v):l(0,[r.k,r.v]):(t._t=void 0,l(1))},r?"entries":"values",!r,!0),h(n)}}},function(t,n,r){var e=r(114),i=r(161);t.exports=function(t){return function(){if(e(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,n,r){"use strict";var e=r(73),i=r(65).getWeak,o=r(2),u=r(6),c=r(68),f=r(79),a=r(48),s=r(24),l=a(5),h=a(6),v=0,p=function(t){return t._l||(t._l=new d)},d=function(){this.a=[]},y=function(t,n){return l(t.a,function(t){return t[0]===n})};d.prototype={get:function(t){var n=y(this,t);if(n)return n[1]},has:function(t){return!!y(this,t)},set:function(t,n){var r=y(this,t);r?r[1]=n:this.a.push([t,n])},delete:function(t){var n=h(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},t.exports={getConstructor:function(t,n,r,o){var a=t(function(t,e){c(t,a,n,"_i"),t._i=v++,t._l=void 0,void 0!=e&&f(e,r,t[o],t)});return e(a.prototype,{delete:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).delete(t):n&&s(n,this._i)&&delete n[this._i]},has:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).has(t):n&&s(n,this._i)}}),a},def:function(t,n,r){var e=i(o(n),!0);return!0===e?p(t).set(n,r):e[t._i]=r,t},ufstore:p}},function(t,n,r){t.exports=!r(10)&&!r(4)(function(){return 7!=Object.defineProperty(r(132)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(6),i=Math.floor;t.exports=function(t){return!e(t)&&isFinite(t)&&i(t)===t}},function(t,n,r){var e=r(2);t.exports=function(t,n,r,i){try{return i?n(e(r)[0],r[1]):n(r)}catch(n){var o=t.return;throw void 0!==o&&e(o.call(t)),n}}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,n,r){"use strict";var e=r(72),i=r(125),o=r(116),u=r(17),c=r(115),f=Object.assign;t.exports=!f||r(4)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=f({},t)[r]||Object.keys(f({},n)).join("")!=e})?function(t,n){for(var r=u(t),f=arguments.length,a=1,s=i.f,l=o.f;f>a;)for(var h,v=c(arguments[a++]),p=s?e(v).concat(s(v)):e(v),d=p.length,y=0;d>y;)l.call(v,h=p[y++])&&(r[h]=v[h]);return r}:f},function(t,n,r){var e=r(11),i=r(2),o=r(72);t.exports=r(10)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(30),i=r(71).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(24),i=r(30),o=r(117)(!1),u=r(145)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){var e=r(72),i=r(30),o=r(116).f;t.exports=function(t){return function(n){for(var r,u=i(n),c=e(u),f=c.length,a=0,s=[];f>a;)o.call(u,r=c[a++])&&s.push(t?[r,u[r]]:u[r]);return s}}},function(t,n,r){var e=r(71),i=r(125),o=r(2),u=r(3).Reflect;t.exports=u&&u.ownKeys||function(t){var n=e.f(o(t)),r=i.f;return r?n.concat(r(t)):n}},function(t,n,r){var e=r(3).parseFloat,i=r(82).trim;t.exports=1/e(r(150)+"-0")!=-1/0?function(t){var n=i(String(t),3),r=e(n);return 0===r&&"-"==n.charAt(0)?-0:r}:e},function(t,n,r){var e=r(3).parseInt,i=r(82).trim,o=r(150),u=/^[\-+]?0[xX]/;t.exports=8!==e(o+"08")||22!==e(o+"0x16")?function(t,n){var r=i(String(t),3);return e(r,n>>>0||(u.test(r)?16:10))}:e},function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},function(t,n,r){var e=r(16),i=r(149),o=r(46);t.exports=function(t,n,r,u){var c=String(o(t)),f=c.length,a=void 0===r?" ":String(r),s=e(n);if(s<=f||""==a)return c;var l=s-f,h=i.call(a,Math.ceil(l/a.length));return h.length>l&&(h=h.slice(0,l)),u?h+c:c+h}},function(t,n,r){n.f=r(7)},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=e.getEntry(this,t);return n&&n.v},set:function(t,n){return e.def(this,0===t?0:t,n)}},e,!0)},function(t,n,r){r(10)&&"g"!=/./g.flags&&r(11).f(RegExp.prototype,"flags",{configurable:!0,get:r(120)})},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t=0===t?0:t,t)}},e)},function(t,n,r){"use strict";var e,i=r(48)(0),o=r(28),u=r(65),c=r(172),f=r(166),a=r(6),s=u.getWeak,l=Object.isExtensible,h=f.ufstore,v={},p=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(t){if(a(t)){var n=s(t);return!0===n?h(this).get(t):n?n[this._i]:void 0}},set:function(t,n){return f.def(this,t,n)}},y=t.exports=r(118)("WeakMap",p,d,f,!0,!0);7!=(new y).set((Object.freeze||Object)(v),7).get(v)&&(e=f.getConstructor(p),c(e.prototype,d),u.NEED=!0,i(["delete","has","get","set"],function(t){var n=y.prototype,r=n[t];o(n,t,function(n,i){if(a(n)&&!l(n)){this._f||(this._f=new e);var o=this._f[t](n,i);return"set"==t?this:o}return r.call(this,n,i)})}))},,,,function(t,n){"use strict";function r(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function(t){var n=t.getAttribute("target");n&&""!==n||t.setAttribute("target","_blank")})}if(yiliaConfig&&yiliaConfig.toc_hide_index){document.querySelectorAll(".toc-number").forEach(function(t){t.style.display="none"})}var n=document.querySelector("#js-aboutme");n&&0!==n.length&&(n.innerHTML=n.innerText)}t.exports={init:r}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function i(t,n){var r=/\/|index.html/g;return t.replace(r,"")===n.replace(r,"")}function o(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,r=0,e=t.length;r<e;r++){var o=t[r];i(n,o.getAttribute("href"))&&(0,h.default)(o,"active")}}function u(t){for(var n=t.offsetLeft,r=t.offsetParent;null!==r;)n+=r.offsetLeft,r=r.offsetParent;return n}function c(t){for(var n=t.offsetTop,r=t.offsetParent;null!==r;)n+=r.offsetTop,r=r.offsetParent;return n}function f(t,n,r,e,i){var o=u(t),f=c(t)-n;if(f-r<=i){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,d.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(r||f)+"px",a.style.left=o+"px",a.style.zIndex=e||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");f(t,document.body.scrollTop,-63,2,0),f(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}var l=r(156),h=e(l),v=r(157),p=(e(v),r(382)),d=e(p),y=r(128),g=e(y),b=r(190),m=e(b),x=r(129);(function(){g.default.versions.mobile&&window.screen.width<800&&(o(),s())})(),(0,x.addLoadEvent)(function(){m.default.init()}),t.exports={}},,,,function(t,n,r){(function(t){"use strict";function n(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}if(r(381),r(391),r(198),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&n(Array,t,Function.call.bind([][t]))})}).call(n,function(){return this}())},,,function(t,n,r){r(210),t.exports=r(52).RegExp.escape},,,,function(t,n,r){var e=r(6),i=r(138),o=r(7)("species");t.exports=function(t){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)||(n=void 0),e(n)&&null===(n=n[o])&&(n=void 0)),void 0===n?Array:n}},function(t,n,r){var e=r(202);t.exports=function(t,n){return new(e(t))(n)}},function(t,n,r){"use strict";var e=r(2),i=r(50),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return i(e(this),t!=o)}},function(t,n,r){var e=r(72),i=r(125),o=r(116);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){var e=r(72),i=r(30);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){"use strict";var e=r(208),i=r(121),o=r(26);t.exports=function(){for(var t=o(this),n=arguments.length,r=Array(n),u=0,c=e._,f=!1;n>u;)(r[u]=arguments[u++])===c&&(f=!0);return function(){var e,o=this,u=arguments.length,a=0,s=0;if(!f&&!u)return i(t,r,o);if(e=r.slice(),f)for(;n>a;a++)e[a]===c&&(e[a]=arguments[s++]);for(;u>s;)e.push(arguments[s++]);return i(t,e,o)}}},function(t,n,r){t.exports=r(3)},function(t,n){t.exports=function(t,n){var r=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,r)}}},function(t,n,r){var e=r(1),i=r(209)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function(t){return i(t)}})},function(t,n,r){var e=r(1);e(e.P,"Array",{copyWithin:r(160)}),r(78)("copyWithin")},function(t,n,r){"use strict";var e=r(1),i=r(48)(4);e(e.P+e.F*!r(47)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.P,"Array",{fill:r(130)}),r(78)("fill")},function(t,n,r){"use strict";var e=r(1),i=r(48)(2);e(e.P+e.F*!r(47)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(5),o="find",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(0),o=r(47)([].forEach,!0);e(e.P+e.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(53),i=r(1),o=r(17),u=r(169),c=r(137),f=r(16),a=r(131),s=r(154);i(i.S+i.F*!r(123)(function(t){Array.from(t)}),"Array",{from:function(t){var n,r,i,l,h=o(t),v="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,y=void 0!==d,g=0,b=s(h);if(y&&(d=e(d,p>2?arguments[2]:void 0,2)),void 0==b||v==Array&&c(b))for(n=f(h.length),r=new v(n);n>g;g++)a(r,g,y?d(h[g],g):h[g]);else for(l=b.call(h),r=new v;!(i=l.next()).done;g++)a(r,g,y?u(l,d,[i.value,g],!0):i.value);return r.length=g,r}})},function(t,n,r){"use strict";var e=r(1),i=r(117)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(u||!r(47)(o)),"Array",{indexOf:function(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.S,"Array",{isArray:r(138)})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=[].join;e(e.P+e.F*(r(115)!=Object||!r(47)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=r(67),u=r(16),c=[].lastIndexOf,f=!!c&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(f||!r(47)(c)),"Array",{lastIndexOf:function(t){if(f)return c.apply(this,arguments)||0;var n=i(this),r=u(n.length),e=r-1;for(arguments.length>1&&(e=Math.min(e,o(arguments[1]))),e<0&&(e=r+e);e>=0;e--)if(e in n&&n[e]===t)return e||0;return-1}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(1);e(e.P+e.F*!r(47)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(131);e(e.S+e.F*r(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>t;)i(r,t,arguments[t++]);return r.length=n,r}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(135),o=r(45),u=r(75),c=r(16),f=[].slice;e(e.P+e.F*r(4)(function(){i&&f.call(i)}),"Array",{slice:function(t,n){var r=c(this.length),e=o(this);if(n=void 0===n?r:n,"Array"==e)return f.call(this,t,n);for(var i=u(t,r),a=u(n,r),s=c(a-i),l=Array(s),h=0;h<s;h++)l[h]="String"==e?this.charAt(i+h):this[i+h];return l}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(3);e(e.P+e.F*!r(47)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(26),o=r(17),u=r(4),c=[].sort,f=[1,2,3];e(e.P+e.F*(u(function(){f.sort(void 0)})||!u(function(){f.sort(null)})||!r(47)(c)),"Array",{sort:function(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},function(t,n,r){r(74)("Array")},function(t,n,r){var e=r(1);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=Date.prototype.getTime,u=function(t){return t>9?t:"0"+t};e(e.P+e.F*(i(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!i(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){
if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),r=t.getUTCMilliseconds(),e=n<0?"-":n>9999?"+":"";return e+("00000"+Math.abs(n)).slice(e?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50);e(e.P+e.F*r(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var n=i(this),r=o(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}})},function(t,n,r){var e=r(7)("toPrimitive"),i=Date.prototype;e in i||r(27)(i,e,r(204))},function(t,n,r){var e=Date.prototype,i="Invalid Date",o="toString",u=e[o],c=e.getTime;new Date(NaN)+""!=i&&r(28)(e,o,function(){var t=c.call(this);return t===t?u.call(this):i})},function(t,n,r){var e=r(1);e(e.P,"Function",{bind:r(163)})},function(t,n,r){"use strict";var e=r(6),i=r(32),o=r(7)("hasInstance"),u=Function.prototype;o in u||r(11).f(u,o,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,n,r){var e=r(11).f,i=r(66),o=r(24),u=Function.prototype,c="name",f=Object.isExtensible||function(){return!0};c in u||r(10)&&e(u,c,{configurable:!0,get:function(){try{var t=this,n=(""+t).match(/^\s*function ([^ (]*)/)[1];return o(t,c)||!f(t)||e(t,c,i(5,n)),n}catch(t){return""}}})},function(t,n,r){var e=r(1),i=r(171),o=Math.sqrt,u=Math.acosh;e(e.S+e.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,n,r){function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}var i=r(1),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:e})},function(t,n,r){var e=r(1),i=Math.atanh;e(e.S+e.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,n,r){var e=r(1),i=r(142);e(e.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,n,r){var e=r(1),i=Math.exp;e(e.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,n,r){var e=r(1),i=r(141);e(e.S+e.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,n,r){var e=r(1),i=r(142),o=Math.pow,u=o(2,-52),c=o(2,-23),f=o(2,127)*(2-c),a=o(2,-126),s=function(t){return t+1/u-1/u};e(e.S,"Math",{fround:function(t){var n,r,e=Math.abs(t),o=i(t);return e<a?o*s(e/a/c)*a*c:(n=(1+c/u)*e,r=n-(n-e),r>f||r!=r?o*(1/0):o*r)}})},function(t,n,r){var e=r(1),i=Math.abs;e(e.S,"Math",{hypot:function(t,n){for(var r,e,o=0,u=0,c=arguments.length,f=0;u<c;)r=i(arguments[u++]),f<r?(e=f/r,o=o*e*e+1,f=r):r>0?(e=r/f,o+=e*e):o+=r;return f===1/0?1/0:f*Math.sqrt(o)}})},function(t,n,r){var e=r(1),i=Math.imul;e(e.S+e.F*r(4)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,n){var r=65535,e=+t,i=+n,o=r&e,u=r&i;return 0|o*u+((r&e>>>16)*u+o*(r&i>>>16)<<16>>>0)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log1p:r(171)})},function(t,n,r){var e=r(1);e(e.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,n,r){var e=r(1);e(e.S,"Math",{sign:r(142)})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S+e.F*r(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S,"Math",{tanh:function(t){var n=i(t=+t),r=i(-t);return n==1/0?1:r==1/0?-1:(n-r)/(o(t)+o(-t))}})},function(t,n,r){var e=r(1);e(e.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(45),u=r(136),c=r(50),f=r(4),a=r(71).f,s=r(31).f,l=r(11).f,h=r(82).trim,v="Number",p=e[v],d=p,y=p.prototype,g=o(r(70)(y))==v,b="trim"in String.prototype,m=function(t){var n=c(t,!1);if("string"==typeof n&&n.length>2){n=b?n.trim():h(n,3);var r,e,i,o=n.charCodeAt(0);if(43===o||45===o){if(88===(r=n.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(n.charCodeAt(1)){case 66:case 98:e=2,i=49;break;case 79:case 111:e=8,i=55;break;default:return+n}for(var u,f=n.slice(2),a=0,s=f.length;a<s;a++)if((u=f.charCodeAt(a))<48||u>i)return NaN;return parseInt(f,e)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var n=arguments.length<1?0:t,r=this;return r instanceof p&&(g?f(function(){y.valueOf.call(r)}):o(r)!=v)?u(new d(m(n)),r,p):m(n)};for(var x,w=r(10)?a(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)i(d,x=w[S])&&!i(p,x)&&l(p,x,s(d,x));p.prototype=y,y.constructor=p,r(28)(e,v,p)}},function(t,n,r){var e=r(1);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,n,r){var e=r(1),i=r(3).isFinite;e(e.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,n,r){var e=r(1);e(e.S,"Number",{isInteger:r(168)})},function(t,n,r){var e=r(1);e(e.S,"Number",{isNaN:function(t){return t!=t}})},function(t,n,r){var e=r(1),i=r(168),o=Math.abs;e(e.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,n,r){var e=r(1);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,n,r){var e=r(1);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,n,r){var e=r(1),i=r(178);e(e.S+e.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.S+e.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,n,r){"use strict";var e=r(1),i=r(67),o=r(159),u=r(149),c=1..toFixed,f=Math.floor,a=[0,0,0,0,0,0],s="Number.toFixed: incorrect invocation!",l="0",h=function(t,n){for(var r=-1,e=n;++r<6;)e+=t*a[r],a[r]=e%1e7,e=f(e/1e7)},v=function(t){for(var n=6,r=0;--n>=0;)r+=a[n],a[n]=f(r/t),r=r%t*1e7},p=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==a[t]){var r=String(a[t]);n=""===n?r:n+u.call(l,7-r.length)+r}return n},d=function(t,n,r){return 0===n?r:n%2==1?d(t,n-1,r*t):d(t*t,n/2,r)},y=function(t){for(var n=0,r=t;r>=4096;)n+=12,r/=4096;for(;r>=2;)n+=1,r/=2;return n};e(e.P+e.F*(!!c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)(function(){c.call({})})),"Number",{toFixed:function(t){var n,r,e,c,f=o(this,s),a=i(t),g="",b=l;if(a<0||a>20)throw RangeError(s);if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return String(f);if(f<0&&(g="-",f=-f),f>1e-21)if(n=y(f*d(2,69,1))-69,r=n<0?f*d(2,-n,1):f/d(2,n,1),r*=4503599627370496,(n=52-n)>0){for(h(0,r),e=a;e>=7;)h(1e7,0),e-=7;for(h(d(10,e,1),0),e=n-1;e>=23;)v(1<<23),e-=23;v(1<<e),h(1,1),v(2),b=p()}else h(0,r),h(1<<-n,0),b=p()+u.call(l,a);return a>0?(c=b.length,b=g+(c<=a?"0."+u.call(l,a-c)+b:b.slice(0,c-a)+"."+b.slice(c-a))):b=g+b,b}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=r(159),u=1..toPrecision;e(e.P+e.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function(t){var n=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(n):u.call(n,t)}})},function(t,n,r){var e=r(1);e(e.S+e.F,"Object",{assign:r(172)})},function(t,n,r){var e=r(1);e(e.S,"Object",{create:r(70)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperties:r(173)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperty:r(11).f})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("freeze",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(30),i=r(31).f;r(49)("getOwnPropertyDescriptor",function(){return function(t,n){return i(e(t),n)}})},function(t,n,r){r(49)("getOwnPropertyNames",function(){return r(174).f})},function(t,n,r){var e=r(17),i=r(32);r(49)("getPrototypeOf",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6);r(49)("isExtensible",function(t){return function(n){return!!e(n)&&(!t||t(n))}})},function(t,n,r){var e=r(6);r(49)("isFrozen",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(6);r(49)("isSealed",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(1);e(e.S,"Object",{is:r(180)})},function(t,n,r){var e=r(17),i=r(72);r(49)("keys",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("preventExtensions",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("seal",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(1);e(e.S,"Object",{setPrototypeOf:r(144).set})},function(t,n,r){"use strict";var e=r(114),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(28)(Object.prototype,"toString",function(){return"[object "+e(this)+"]"},!0)},function(t,n,r){var e=r(1),i=r(178);e(e.G+e.F*(parseFloat!=i),{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.G+e.F*(parseInt!=i),{parseInt:i})},function(t,n,r){"use strict";var e,i,o,u=r(69),c=r(3),f=r(53),a=r(114),s=r(1),l=r(6),h=r(26),v=r(68),p=r(79),d=r(146),y=r(151).set,g=r(143)(),b="Promise",m=c.TypeError,x=c.process,w=c[b],x=c.process,S="process"==a(x),_=function(){},O=!!function(){try{var t=w.resolve(1),n=(t.constructor={})[r(7)("species")]=function(t){t(_,_)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(_)instanceof n}catch(t){}}(),E=function(t,n){return t===n||t===w&&n===o},P=function(t){var n;return!(!l(t)||"function"!=typeof(n=t.then))&&n},j=function(t){return E(w,t)?new F(t):new i(t)},F=i=function(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw m("Bad Promise constructor");n=t,r=e}),this.resolve=h(n),this.reject=h(r)},M=function(t){try{t()}catch(t){return{error:t}}},A=function(t,n){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var e=t._v,i=1==t._s,o=0;r.length>o;)!function(n){var r,o,u=i?n.ok:n.fail,c=n.resolve,f=n.reject,a=n.domain;try{u?(i||(2==t._h&&I(t),t._h=1),!0===u?r=e:(a&&a.enter(),r=u(e),a&&a.exit()),r===n.promise?f(m("Promise-chain cycle")):(o=P(r))?o.call(r,c,f):c(r)):f(e)}catch(t){f(t)}}(r[o++]);t._c=[],t._n=!1,n&&!t._h&&N(t)})}},N=function(t){y.call(c,function(){var n,r,e,i=t._v;if(T(t)&&(n=M(function(){S?x.emit("unhandledRejection",i,t):(r=c.onunhandledrejection)?r({promise:t,reason:i}):(e=c.console)&&e.error&&e.error("Unhandled promise rejection",i)}),t._h=S||T(t)?2:1),t._a=void 0,n)throw n.error})},T=function(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,e=0;r.length>e;)if(n=r[e++],n.fail||!T(n.promise))return!1;return!0},I=function(t){y.call(c,function(){var n;S?x.emit("rejectionHandled",t):(n=c.onrejectionhandled)&&n({promise:t,reason:t._v})})},k=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),A(n,!0))},L=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw m("Promise can't be resolved itself");(n=P(t))?g(function(){var e={_w:r,_d:!1};try{n.call(t,f(L,e,1),f(k,e,1))}catch(t){k.call(e,t)}}):(r._v=t,r._s=1,A(r,!1))}catch(t){k.call({_w:r,_d:!1},t)}}};O||(w=function(t){v(this,w,b,"_h"),h(t),e.call(this);try{t(f(L,this,1),f(k,this,1))}catch(t){k.call(this,t)}},e=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=r(73)(w.prototype,{then:function(t,n){var r=j(d(this,w));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=S?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),F=function(){var t=new e;this.promise=t,this.resolve=f(L,t,1),this.reject=f(k,t,1)}),s(s.G+s.W+s.F*!O,{Promise:w}),r(81)(w,b),r(74)(b),o=r(52)[b],s(s.S+s.F*!O,b,{reject:function(t){var n=j(this);return(0,n.reject)(t),n.promise}}),s(s.S+s.F*(u||!O),b,{resolve:function(t){if(t instanceof w&&E(t.constructor,this))return t;var n=j(this);return(0,n.resolve)(t),n.promise}}),s(s.S+s.F*!(O&&r(123)(function(t){w.all(t).catch(_)})),b,{all:function(t){var n=this,r=j(n),e=r.resolve,i=r.reject,o=M(function(){var r=[],o=0,u=1;p(t,!1,function(t){var c=o++,f=!1;r.push(void 0),u++,n.resolve(t).then(function(t){f||(f=!0,r[c]=t,--u||e(r))},i)}),--u||e(r)});return o&&i(o.error),r.promise},race:function(t){var n=this,r=j(n),e=r.reject,i=M(function(){p(t,!1,function(t){n.resolve(t).then(r.resolve,e)})});return i&&e(i.error),r.promise}})},function(t,n,r){var e=r(1),i=r(26),o=r(2),u=(r(3).Reflect||{}).apply,c=Function.apply;e(e.S+e.F*!r(4)(function(){u(function(){})}),"Reflect",{apply:function(t,n,r){var e=i(t),f=o(r);return u?u(e,n,f):c.call(e,n,f)}})},function(t,n,r){var e=r(1),i=r(70),o=r(26),u=r(2),c=r(6),f=r(4),a=r(163),s=(r(3).Reflect||{}).construct,l=f(function(){function t(){}return!(s(function(){},[],t)instanceof t)}),h=!f(function(){s(function(){})});e(e.S+e.F*(l||h),"Reflect",{construct:function(t,n){o(t),u(n);var r=arguments.length<3?t:o(arguments[2]);if(h&&!l)return s(t,n,r);if(t==r){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var e=[null];return e.push.apply(e,n),new(a.apply(t,e))}var f=r.prototype,v=i(c(f)?f:Object.prototype),p=Function.apply.call(t,v,n);return c(p)?p:v}})},function(t,n,r){var e=r(11),i=r(1),o=r(2),u=r(50);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,r){o(t),n=u(n,!0),o(r);try{return e.f(t,n,r),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(31).f,o=r(2);e(e.S,"Reflect",{deleteProperty:function(t,n){var r=i(o(t),n);return!(r&&!r.configurable)&&delete t[n]}})},function(t,n,r){"use strict";var e=r(1),i=r(2),o=function(t){this._t=i(t),this._i=0;var n,r=this._k=[];for(n in t)r.push(n)};r(139)(o,"Object",function(){var t,n=this,r=n._k;do{if(n._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[n._i++])in n._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,n,r){var e=r(31),i=r(1),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return e.f(o(t),n)}})},function(t,n,r){var e=r(1),i=r(32),o=r(2);e(e.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,n,r){function e(t,n){var r,c,s=arguments.length<3?t:arguments[2];return a(t)===s?t[n]:(r=i.f(t,n))?u(r,"value")?r.value:void 0!==r.get?r.get.call(s):void 0:f(c=o(t))?e(c,n,s):void 0}var i=r(31),o=r(32),u=r(24),c=r(1),f=r(6),a=r(2);c(c.S,"Reflect",{get:e})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{has:function(t,n){return n in t}})},function(t,n,r){var e=r(1),i=r(2),o=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{ownKeys:r(177)})},function(t,n,r){var e=r(1),i=r(2),o=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(144);i&&e(e.S,"Reflect",{setPrototypeOf:function(t,n){i.check(t,n);try{return i.set(t,n),!0}catch(t){return!1}}})},function(t,n,r){function e(t,n,r){var f,h,v=arguments.length<4?t:arguments[3],p=o.f(s(t),n);if(!p){if(l(h=u(t)))return e(h,n,r,v);p=a(0)}return c(p,"value")?!(!1===p.writable||!l(v)||(f=o.f(v,n)||a(0),f.value=r,i.f(v,n,f),0)):void 0!==p.set&&(p.set.call(v,r),!0)}var i=r(11),o=r(31),u=r(32),c=r(24),f=r(1),a=r(66),s=r(2),l=r(6);f(f.S,"Reflect",{set:e})},function(t,n,r){var e=r(3),i=r(136),o=r(11).f,u=r(71).f,c=r(122),f=r(120),a=e.RegExp,s=a,l=a.prototype,h=/a/g,v=/a/g,p=new a(h)!==h;if(r(10)&&(!p||r(4)(function(){return v[r(7)("match")]=!1,a(h)!=h||a(v)==v||"/a/i"!=a(h,"i")}))){a=function(t,n){var r=this instanceof a,e=c(t),o=void 0===n;return!r&&e&&t.constructor===a&&o?t:i(p?new s(e&&!o?t.source:t,n):s((e=t instanceof a)?t.source:t,e&&o?f.call(t):n),r?this:l,a)};for(var d=u(s),y=0;d.length>y;)!function(t){t in a||o(a,t,{configurable:!0,get:function(){return s[t]},set:function(n){s[t]=n}})}(d[y++]);l.constructor=a,a.prototype=l,r(28)(e,"RegExp",a)}r(74)("RegExp")},function(t,n,r){r(119)("match",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("replace",2,function(t,n,r){return[function(e,i){"use strict";var o=t(this),u=void 0==e?void 0:e[n];return void 0!==u?u.call(e,o,i):r.call(String(o),e,i)},r]})},function(t,n,r){r(119)("search",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("split",2,function(t,n,e){"use strict";var i=r(122),o=e,u=[].push,c="split",f="length",a="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[f]||2!="ab"[c](/(?:ab)*/)[f]||4!="."[c](/(.?)(.?)/)[f]||"."[c](/()()/)[f]>1||""[c](/.?/)[f]){var s=void 0===/()??/.exec("")[1];e=function(t,n){var r=String(this);if(void 0===t&&0===n)return[];if(!i(t))return o.call(r,t,n);var e,c,l,h,v,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),y=0,g=void 0===n?4294967295:n>>>0,b=new RegExp(t.source,d+"g");for(s||(e=new RegExp("^"+b.source+"$(?!\\s)",d));(c=b.exec(r))&&!((l=c.index+c[0][f])>y&&(p.push(r.slice(y,c.index)),!s&&c[f]>1&&c[0].replace(e,function(){for(v=1;v<arguments[f]-2;v++)void 0===arguments[v]&&(c[v]=void 0)}),c[f]>1&&c.index<r[f]&&u.apply(p,c.slice(1)),h=c[0][f],y=l,p[f]>=g));)b[a]===c.index&&b[a]++;return y===r[f]?!h&&b.test("")||p.push(""):p.push(r.slice(y)),p[f]>g?p.slice(0,g):p}}else"0"[c](void 0,0)[f]&&(e=function(t,n){return void 0===t&&0===n?[]:o.call(this,t,n)});return[function(r,i){var o=t(this),u=void 0==r?void 0:r[n];return void 0!==u?u.call(r,o,i):e.call(String(o),r,i)},e]})},function(t,n,r){"use strict";r(184);var e=r(2),i=r(120),o=r(10),u="toString",c=/./[u],f=function(t){r(28)(RegExp.prototype,u,t,!0)};r(4)(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?f(function(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):c.name!=u&&f(function(){return c.call(this)})},function(t,n,r){"use strict";r(29)("anchor",function(t){return function(n){return t(this,"a","name",n)}})},function(t,n,r){"use strict";r(29)("big",function(t){return function(){return t(this,"big","","")}})},function(t,n,r){"use strict";r(29)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,n,r){"use strict";r(29)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!1);e(e.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="endsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{endsWith:function(t){var n=o(this,t,u),r=arguments.length>1?arguments[1]:void 0,e=i(n.length),f=void 0===r?e:Math.min(i(r),e),a=String(t);return c?c.call(n,a,f):n.slice(f-a.length,f)===a}})},function(t,n,r){"use strict";r(29)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,n,r){"use strict";r(29)("fontcolor",function(t){return function(n){return t(this,"font","color",n)}})},function(t,n,r){"use strict";r(29)("fontsize",function(t){return function(n){return t(this,"font","size",n)}})},function(t,n,r){var e=r(1),i=r(75),o=String.fromCharCode,u=String.fromCodePoint;e(e.S+e.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(t){for(var n,r=[],e=arguments.length,u=0;e>u;){if(n=+arguments[u++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");r.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return r.join("")}})},function(t,n,r){"use strict";var e=r(1),i=r(148),o="includes";e(e.P+e.F*r(134)(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){"use strict";r(29)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,n,r){"use strict";var e=r(147)(!0);r(140)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";r(29)("link",function(t){return function(n){return t(this,"a","href",n)}})},function(t,n,r){var e=r(1),i=r(30),o=r(16);e(e.S,"String",{raw:function(t){for(var n=i(t.raw),r=o(n.length),e=arguments.length,u=[],c=0;r>c;)u.push(String(n[c++])),c<e&&u.push(String(arguments[c]));return u.join("")}})},function(t,n,r){var e=r(1);e(e.P,"String",{repeat:r(149)})},function(t,n,r){"use strict";r(29)("small",function(t){return function(){return t(this,"small","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="startsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{startsWith:function(t){var n=o(this,t,u),r=i(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),e=String(t);return c?c.call(n,e,r):n.slice(r,r+e.length)===e}})},function(t,n,r){"use strict";r(29)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,n,r){"use strict";r(29)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,n,r){"use strict";r(29)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,n,r){"use strict";r(82)("trim",function(t){return function(){return t(this,3)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(10),u=r(1),c=r(28),f=r(65).KEY,a=r(4),s=r(126),l=r(81),h=r(76),v=r(7),p=r(182),d=r(153),y=r(206),g=r(205),b=r(138),m=r(2),x=r(30),w=r(50),S=r(66),_=r(70),O=r(174),E=r(31),P=r(11),j=r(72),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(71).f=O.f=Z,r(116).f=X,r(125).f=tt,o&&!r(69)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(27)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){"use strict";var e=r(1),i=r(127),o=r(152),u=r(2),c=r(75),f=r(16),a=r(6),s=r(3).ArrayBuffer,l=r(146),h=o.ArrayBuffer,v=o.DataView,p=i.ABV&&s.isView,d=h.prototype.slice,y=i.VIEW,g="ArrayBuffer";e(e.G+e.W+e.F*(s!==h),{ArrayBuffer:h}),e(e.S+e.F*!i.CONSTR,g,{isView:function(t){return p&&p(t)||a(t)&&y in t}}),e(e.P+e.U+e.F*r(4)(function(){return!new h(2).slice(1,void 0).byteLength}),g,{slice:function(t,n){if(void 0!==d&&void 0===n)return d.call(u(this),t);for(var r=u(this).byteLength,e=c(t,r),i=c(void 0===n?r:n,r),o=new(l(this,h))(f(i-e)),a=new v(this),s=new v(o),p=0;e<i;)s.setUint8(p++,a.getUint8(e++));return o}}),r(74)(g)},function(t,n,r){var e=r(1);e(e.G+e.W+e.F*!r(127).ABV,{DataView:r(152).DataView})},function(t,n,r){r(55)("Float32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Float64",8,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}},!0)},function(t,n,r){"use strict";var e=r(166);r(118)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},function(t,n,r){"use strict";var e=r(1),i=r(117)(!0);e(e.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)("includes")},function(t,n,r){var e=r(1),i=r(143)(),o=r(3).process,u="process"==r(45)(o);e(e.G,{asap:function(t){var n=u&&o.domain;i(n?n.bind(t):t)}})},function(t,n,r){var e=r(1),i=r(45);e(e.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Map",{toJSON:r(165)("Map")})},function(t,n,r){var e=r(1);e(e.S,"Math",{iaddh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o+(e>>>0)+((i&u|(i|u)&~(i+u>>>0))>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{imulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>16,f=i>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>16)+((o*f>>>0)+(a&r)>>16)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{isubh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o-(e>>>0)-((~i&u|~(i^u)&i-u>>>0)>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{umulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>>16,f=i>>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>>16)+((o*f>>>0)+(a&r)>>>16)}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineGetter__:function(t,n){u.f(i(this),t,{get:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineSetter__:function(t,n){u.f(i(this),t,{set:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){var e=r(1),i=r(176)(!0);e(e.S,"Object",{entries:function(t){return i(t)}})},function(t,n,r){var e=r(1),i=r(177),o=r(30),u=r(31),c=r(131);e(e.S,"Object",{getOwnPropertyDescriptors:function(t){for(var n,r=o(t),e=u.f,f=i(r),a={},s=0;f.length>s;)c(a,n=f[s++],e(r,n));return a}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupGetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.get}while(r=u(r))}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupSetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.set}while(r=u(r))}})},function(t,n,r){var e=r(1),i=r(176)(!1);e(e.S,"Object",{values:function(t){return i(t)}})},function(t,n,r){"use strict";var e=r(1),i=r(3),o=r(52),u=r(143)(),c=r(7)("observable"),f=r(26),a=r(2),s=r(68),l=r(73),h=r(27),v=r(79),p=v.RETURN,d=function(t){return null==t?void 0:f(t)},y=function(t){var n=t._c;n&&(t._c=void 0,n())},g=function(t){return void 0===t._o},b=function(t){g(t)||(t._o=void 0,y(t))},m=function(t,n){a(t),this._c=void 0,this._o=t,t=new x(this);try{var r=n(t),e=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){e.unsubscribe()}:f(r),this._c=r)}catch(n){return void t.error(n)}g(this)&&y(this)};m.prototype=l({},{unsubscribe:function(){b(this)}});var x=function(t){this._s=t};x.prototype=l({},{next:function(t){var n=this._s;if(!g(n)){var r=n._o;try{var e=d(r.next);if(e)return e.call(r,t)}catch(t){try{b(n)}finally{throw t}}}},error:function(t){var n=this._s;if(g(n))throw t;var r=n._o;n._o=void 0;try{var e=d(r.error);if(!e)throw t;t=e.call(r,t)}catch(t){try{y(n)}finally{throw t}}return y(n),t},complete:function(t){var n=this._s;if(!g(n)){var r=n._o;n._o=void 0;try{var e=d(r.complete);t=e?e.call(r,t):void 0}catch(t){try{y(n)}finally{throw t}}return y(n),t}}});var w=function(t){s(this,w,"Observable","_f")._f=f(t)};l(w.prototype,{subscribe:function(t){return new m(t,this._f)},forEach:function(t){var n=this;return new(o.Promise||i.Promise)(function(r,e){f(t);var i=n.subscribe({next:function(n){try{return t(n)}catch(t){e(t),i.unsubscribe()}},error:e,complete:r})})}}),l(w,{from:function(t){var n="function"==typeof this?this:w,r=d(a(t)[c]);if(r){var e=a(r.call(t));return e.constructor===n?e:new n(function(t){return e.subscribe(t)})}return new n(function(n){var r=!1;return u(function(){if(!r){try{if(v(t,!1,function(t){if(n.next(t),r)return p})===p)return}catch(t){if(r)throw t;return void n.error(t)}n.complete()}}),function(){r=!0}})},of:function(){for(var t=0,n=arguments.length,r=Array(n);t<n;)r[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var n=!1;return u(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),h(w.prototype,c,function(){return this}),e(e.G,{Observable:w}),r(74)("Observable")},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.set;e.exp({defineMetadata:function(t,n,r,e){u(t,n,i(r),o(e))}})},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.map,c=e.store;e.exp({deleteMetadata:function(t,n){var r=arguments.length<3?void 0:o(arguments[2]),e=u(i(n),r,!1);if(void 0===e||!e.delete(t))return!1;if(e.size)return!0;var f=c.get(n);return f.delete(r),!!f.size||c.delete(n)}})},function(t,n,r){var e=r(185),i=r(161),o=r(54),u=r(2),c=r(32),f=o.keys,a=o.key,s=function(t,n){var r=f(t,n),o=c(t);if(null===o)return r;var u=s(o,n);return u.length?r.length?i(new e(r.concat(u))):u:r};o.exp({getMetadataKeys:function(t){return s(u(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.get,f=e.key,a=function(t,n,r){if(u(t,n,r))return c(t,n,r);var e=o(n);return null!==e?a(t,e,r):void 0};e.exp({getMetadata:function(t,n){return a(t,i(n),arguments.length<3?void 0:f(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.keys,u=e.key;e.exp({getOwnMetadataKeys:function(t){
return o(i(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.get,u=e.key;e.exp({getOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.key,f=function(t,n,r){if(u(t,n,r))return!0;var e=o(n);return null!==e&&f(t,e,r)};e.exp({hasMetadata:function(t,n){return f(t,i(n),arguments.length<3?void 0:c(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.has,u=e.key;e.exp({hasOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(26),u=e.key,c=e.set;e.exp({metadata:function(t,n){return function(r,e){c(t,n,(void 0!==e?i:o)(r),u(e))}}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Set",{toJSON:r(165)("Set")})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!0);e(e.P,"String",{at:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(46),o=r(16),u=r(122),c=r(120),f=RegExp.prototype,a=function(t,n){this._r=t,this._s=n};r(139)(a,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function(t){if(i(this),!u(t))throw TypeError(t+" is not a regexp!");var n=String(this),r="flags"in f?String(t.flags):c.call(t),e=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return e.lastIndex=o(t.lastIndex),new a(e,n)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,n,r){"use strict";r(82)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,n,r){"use strict";r(82)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,n,r){r(153)("asyncIterator")},function(t,n,r){r(153)("observable")},function(t,n,r){var e=r(1);e(e.S,"System",{global:r(3)})},function(t,n,r){for(var e=r(155),i=r(28),o=r(3),u=r(27),c=r(80),f=r(7),a=f("iterator"),s=f("toStringTag"),l=c.Array,h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],v=0;v<5;v++){var p,d=h[v],y=o[d],g=y&&y.prototype;if(g){g[a]||u(g,a,l),g[s]||u(g,s,d),c[d]=l;for(p in e)g[p]||i(g,p,e[p],!0)}}},function(t,n,r){var e=r(1),i=r(151);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,n,r){var e=r(3),i=r(1),o=r(121),u=r(207),c=e.navigator,f=!!c&&/MSIE .\./.test(c.userAgent),a=function(t){return f?function(n,r){return t(o(u,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),r)}:t};i(i.G+i.B+i.F*f,{setTimeout:a(e.setTimeout),setInterval:a(e.setInterval)})},function(t,n,r){r(330),r(269),r(271),r(270),r(273),r(275),r(280),r(274),r(272),r(282),r(281),r(277),r(278),r(276),r(268),r(279),r(283),r(284),r(236),r(238),r(237),r(286),r(285),r(256),r(266),r(267),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(239),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(317),r(322),r(329),r(320),r(312),r(313),r(318),r(323),r(325),r(308),r(309),r(310),r(311),r(314),r(315),r(316),r(319),r(321),r(324),r(326),r(327),r(328),r(231),r(233),r(232),r(235),r(234),r(220),r(218),r(224),r(221),r(227),r(229),r(217),r(223),r(214),r(228),r(212),r(226),r(225),r(219),r(222),r(211),r(213),r(216),r(215),r(230),r(155),r(302),r(307),r(184),r(303),r(304),r(305),r(306),r(287),r(183),r(185),r(186),r(342),r(331),r(332),r(337),r(340),r(341),r(335),r(338),r(336),r(339),r(333),r(334),r(288),r(289),r(290),r(291),r(292),r(295),r(293),r(294),r(296),r(297),r(298),r(299),r(301),r(300),r(343),r(369),r(372),r(371),r(373),r(374),r(370),r(375),r(376),r(354),r(357),r(353),r(351),r(352),r(355),r(356),r(346),r(368),r(377),r(345),r(347),r(349),r(348),r(350),r(359),r(360),r(362),r(361),r(364),r(363),r(365),r(366),r(367),r(344),r(358),r(380),r(379),r(378),t.exports=r(52)},function(t,n){function r(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var r=t.nextSibling;return r?t.parentNode.insertBefore(n,r):t.parentNode.appendChild(n)}t.exports=r},,,,,,,,,function(t,n,r){(function(n,r){!function(n){"use strict";function e(t,n,r,e){var i=n&&n.prototype instanceof o?n:o,u=Object.create(i.prototype),c=new p(e||[]);return u._invoke=s(t,r,c),u}function i(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}function o(){}function u(){}function c(){}function f(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function a(t){function n(r,e,o,u){var c=i(t[r],t,e);if("throw"!==c.type){var f=c.arg,a=f.value;return a&&"object"==typeof a&&m.call(a,"__await")?Promise.resolve(a.__await).then(function(t){n("next",t,o,u)},function(t){n("throw",t,o,u)}):Promise.resolve(a).then(function(t){f.value=t,o(f)},u)}u(c.arg)}function e(t,r){function e(){return new Promise(function(e,i){n(t,r,e,i)})}return o=o?o.then(e,e):e()}"object"==typeof r&&r.domain&&(n=r.domain.bind(n));var o;this._invoke=e}function s(t,n,r){var e=P;return function(o,u){if(e===F)throw new Error("Generator is already running");if(e===M){if("throw"===o)throw u;return y()}for(r.method=o,r.arg=u;;){var c=r.delegate;if(c){var f=l(c,r);if(f){if(f===A)continue;return f}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===P)throw e=M,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=F;var a=i(t,n,r);if("normal"===a.type){if(e=r.done?M:j,a.arg===A)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(e=M,r.method="throw",r.arg=a.arg)}}}function l(t,n){var r=t.iterator[n.method];if(r===g){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=g,l(t,n),"throw"===n.method))return A;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var e=i(r,t.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,A;var o=e.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=g),n.delegate=null,A):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,A)}function h(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function v(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function d(t){if(t){var n=t[w];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function n(){for(;++r<t.length;)if(m.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=g,n.done=!0,n};return e.next=e}}return{next:y}}function y(){return{value:g,done:!0}}var g,b=Object.prototype,m=b.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},w=x.iterator||"@@iterator",S=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",O="object"==typeof t,E=n.regeneratorRuntime;if(E)return void(O&&(t.exports=E));E=n.regeneratorRuntime=O?t.exports:{},E.wrap=e;var P="suspendedStart",j="suspendedYield",F="executing",M="completed",A={},N={};N[w]=function(){return this};var T=Object.getPrototypeOf,I=T&&T(T(d([])));I&&I!==b&&m.call(I,w)&&(N=I);var k=c.prototype=o.prototype=Object.create(N);u.prototype=k.constructor=c,c.constructor=u,c[_]=u.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===u||"GeneratorFunction"===(n.displayName||n.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(k),t},E.awrap=function(t){return{__await:t}},f(a.prototype),a.prototype[S]=function(){return this},E.AsyncIterator=a,E.async=function(t,n,r,i){var o=new a(e(t,n,r,i));return E.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},f(k),k[_]="Generator",k.toString=function(){return"[object Generator]"},E.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},E.values=d,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(v),!t)for(var n in this)"t"===n.charAt(0)&&m.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){function n(n,e){return o.type="throw",o.arg=t,r.next=n,e&&(r.method="next",r.arg=g),!!e}if(this.done)throw t;for(var r=this,e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=m.call(i,"catchLoc"),c=m.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&m.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var i=e;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=n,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),A},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),v(r),A}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;v(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:d(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=g),A}}}("object"==typeof n?n:"object"==typeof window?window:"object"==typeof self?self:this)}).call(n,function(){return this}(),r(158))}])</script><script src="/./main.0cf68a.js"></script><script>!function(){!function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)}("/slider.e37972.js")}()</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友链</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">r</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">statistics</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">computational method</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">julia</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">computationa method</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">leetcode</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">javascript</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">p5js</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">statistic</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">euler</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">multilingual</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">machine learning</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">processing</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">java</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">dot</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://onlookerliu.leanote.com" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>关于数学的博客</a>
            </li>
          
            <li class="search-li">
              <a href="https://www.liaoxuefeng.com" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>廖雪峰的网站</a>
            </li>
          
            <li class="search-li">
              <a href="https://www.ruanyifeng.com" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>阮一峰的网络日志</a>
            </li>
          
            <li class="search-li">
              <a href="https://www.nowcoder.com" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>牛客网</a>
            </li>
          
            <li class="search-li">
              <a href="https://leetcode.com" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>LeetCode</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">Multilingual, fond of all techniques&lt;br&gt;&lt;br&gt;Mathematics and Programming&lt;br&gt;&lt;br&gt;Ashamed of my undoing</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>

<a href="https://github.com/onlookerliu"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/8b6b8ccc6da3aa5722903da7b58eb5ab1081adee/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_orange_ff7600.png"></a>
</body>
</html>
<a href="https://github.com/onlookerliu"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/8b6b8ccc6da3aa5722903da7b58eb5ab1081adee/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_orange_ff7600.png"></a>
